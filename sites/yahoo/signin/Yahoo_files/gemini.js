var Gemini=function(){"use strict";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var b={positions:[],beacons:{},clickBeacons:{},elements:{},timer:null,paused:!1},d=function d(t){return(new Image).src=t},o=function o(t){var e=b.clickBeacons[t];if(e&&(!e||e.length))for(var n=0,i=e.length;n<i;n++)d(e[n])},m=function m(t,e){var n=(new Date).getTime()/1e3|0,i=Math.floor(9007199254740990*Math.random()),o=e&&e.index||0;return t.replace("$(AD_POSN)",encodeURIComponent("pp=m,pi="+o)).replace("{REQUEST_ID}",i).replace("[timestamp]",n).replace("[CACHEBUSTER]",n).replace("[RANDOM_NUMBER]",i)},I=function I(t,e){return t.replace("$(S_VIEW_TYPE)",e)},w=function w(r,a,t,e){var n=t.a,i=t.c,o=t.d,c=t.p,l=t.t,u=b.beacons,f=b.positions,h=c/100;u[r]||(u[r]={});var s=function s(){for(var t=u[r][a].urls,e=t.length,n=Gemini.beaconCallback,i=0;i<e;i++){var o=t.shift();-1<a.indexOf("viewabilityDefStatic")&&(o=m(o)),d(o),"function"==typeof n&&n(u[r][a],r,a,o)}};u[r][a]={urls:e,threshold:h,duration:o,type:l,consecutive:i,audio:n},f[f.length]={uid:r,threshold:h,duration:o,consecutive:i,audio:n,callback:s,history:null}},E=function E(t,e){var n=e.rules,i=n.viewabilityDefStatic,o=n.viewabilityDefStatic3P,r=e.tag,a=r.clickTrackingUrl,c=r.imprTrackingUrl,l=r.imprTrackingUrls,u=e.actionUrls;if(u&&u.PARTIAL_VIEW)for(var f=u.PARTIAL_VIEW,h={p:.01,d:0,t:21},s=0,d=f.length;s<d;s++)w(t,"viewabilityDefStaticPartial:"+s,h,f);if(u&&(u.IMPR_INTERNAL||u.CLICK_INTERNAL)){var m=[];u.IMPR_INTERNAL&&(m=m.concat(u.IMPR_INTERNAL)),u.CLICK_INTERNAL&&(m=m.concat(u.CLICK_INTERNAL));for(s=0,d=m.length;s<d;s++)w(t,"viewabilityDefStatic:"+s,i||{c:1,d:1,p:50},m)}if(i||!i&&e.beacon){var g=[];e.beacon&&e.beacon.length&&(g[g.length]=e.beacon);l&&l.length?g=g.concat(l):c&&(c instanceof Array?g=g.concat(c):g[g.length]=c),w(t,"viewabilityDefStatic",i||{c:1,d:1,p:50},g)}if(u&&u.STATIC_VIEW_3P&&o)for(var v=o.length,p=u.STATIC_VIEW_3P,y=0;y<v;y++)p[y]=I(p[y],o[y].t),w(t,"viewabilityDefStatic3P:"+y,o[y],p);a&&a.length&&(b.clickBeacons[t]=a)},l=function l(){var t=document,e=window,n=t.body,i=t.documentElement;return{height:e.innerHeight||i.clientHeight||n&&n.clientHeight,width:e.innerWidth||i.clientWidth||n&&n.clientWidth}},h=function h(t,e){for(var n=Math.floor(t.width/e),i=Math.floor(t.height/e),o=Math.max(0,t.left),r=t.top,a=[],c=1;c<e;c++)for(var l=o+n*c,u=1;u<e;u++){var f=r+i*u;a[a.length]=[l,f]}return a},f=function f(t,e,n){for(var i=h(e,10),o=0,r=0,a=i.length;r<a;r++){var c=i[r][0],l=i[r][1],u=document.elementFromPoint(c,l);u===t||t.contains(u)||o++}return!(100*n<=100-o/i.length*100)},u=function u(t,e){var n=l(),i=t.getBoundingClientRect(),o=Math.max(0,Math.min(i.bottom,n.height)-Math.max(i.top,0)),r=Math.max(0,Math.min(i.right,n.width)-Math.max(i.left,0)),a=o/(i.height||t.offsetHeight)||0,c=r/(i.width||t.offsetWidth)||0;return window.addEventListener&&f(t,i,e)?0:Math.min(a,c)},r=function r(t,e,n){return window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},s=function s(t){return document.getElementById(t)||document.querySelector("."+t)},e=function e(){for(var t=b.positions.length,n=0;n<t;n++){var i=b.positions[n];if(!b.paused&&i)switch(function(){var t=i.uid,e=b.elements[t]||s(t);if(!e)return"continue";if(b.elements[t]||(b.elements[t]=e,b.clickBeacons[t]&&r(e,"click",function(){return o(t)})),u(e,i.threshold)<i.threshold)i.history=null;else if(i.history||(i.history=(new Date).getTime()),((new Date).getTime()-i.history)/1e3>=i.duration&&(i.callback(i),i.history=(new Date).getTime(),b.positions.splice(n,1),n-=1,!b.positions.length))return clearInterval(b.timer),b.timer=null,"break"}()){case"continue":continue}}},g=function g(){b.timer=setInterval(e,150)},n=function n(){"hidden"in document&&document.addEventListener("visibilitychange",function(){return b.paused=document.hidden})},v=function v(t){for(var e=t.ads,n=t.section.id,i=e.length,o=0;o<i;o++){var r=e[o],a=r.customId||"gemini-"+n+"-"+(r.creativeId||r.demandSourceCreativeId||r.dynamicProductAdId||0)+"-"+r.index;s(a);r.tag="string"==typeof r.tag?JSON.parse(r.tag):r.tag,r.beacon="string"==typeof r.beacon?r.beacon.replace("$(AD_POSN)",encodeURIComponent("pp=m,pi="+r.index)):"",E(a,r)}};return function(t){function e(t){var e=t instanceof Array;if(!(!t||e&&!t.length||t&&"object"!==c(t))){t&&!e&&(t=[t]);for(var n=t.length,i=0;i<n;i++){var o=t[i],r=o.sectionads;if(r)for(var a=0;a<r.length;a++)v(r[a]);else v(o)}return b.timer||g(),this}}return n(),t.Gemini=e}(window)}();
