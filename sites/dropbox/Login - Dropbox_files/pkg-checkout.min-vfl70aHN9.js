define("dropbox/proto/js_init_data/checkout/checkout_page",["require","exports","tslib","protobufjs/minimal"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.checkout_page=void 0;var n,o,i,s=(r=a.__importStar(r)).Reader,l=r.Writer,u=r.util,c=r.roots.default||(r.roots.default={});t.default=c,t.checkout_page=c.checkout_page=((n=c.checkout_page||{}).Offering=(function(e){function e(e){if(this.licenseOfferingIds={},this.addonOfferingIds={},e)for(var t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.planOfferingId="",e.prototype.licenseOfferingIds=u.emptyObject,e.prototype.addonOfferingIds=u.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=l.create()),null!=e.planOfferingId&&Object.hasOwnProperty.call(e,"planOfferingId")&&t.uint32(10).string(e.planOfferingId),null!=e.licenseOfferingIds&&Object.hasOwnProperty.call(e,"licenseOfferingIds"))for(var a=Object.keys(e.licenseOfferingIds),r=0;r<a.length;++r)t.uint32(18).fork().uint32(10).string(a[r]).uint32(16).int32(e.licenseOfferingIds[a[r]]).ldelim();if(null!=e.addonOfferingIds&&Object.hasOwnProperty.call(e,"addonOfferingIds"))for(a=Object.keys(e.addonOfferingIds),r=0;r<a.length;++r)t.uint32(26).fork().uint32(10).string(a[r]).uint32(16).int32(e.addonOfferingIds[a[r]]).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var a,r,n=void 0===t?e.len:e.pos+t,o=new c.checkout_page.Offering;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:o.planOfferingId=e.string();break;case 2:o.licenseOfferingIds===u.emptyObject&&(o.licenseOfferingIds={});var l=e.uint32()+e.pos;for(a="",r=0;e.pos<l;)switch((p=e.uint32())>>>3){case 1:a=e.string();break;case 2:r=e.int32();break;default:e.skipType(7&p)}o.licenseOfferingIds[a]=r;break;case 3:for(o.addonOfferingIds===u.emptyObject&&(o.addonOfferingIds={}),l=e.uint32()+e.pos,a="",r=0;e.pos<l;){var p;switch((p=e.uint32())>>>3){case 1:a=e.string();break;case 2:r=e.int32();break;default:e.skipType(7&p)}}o.addonOfferingIds[a]=r;break;default:e.skipType(7&i)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/checkout_page.Offering"},e})(n.Offering||{}),n.CheckoutRevenueApiPathwayEnum=(o={},(i=Object.create(o))[o[0]="LEGACY_READ_WRITE"]=0,i[o[1]="DUAL_READ_LEGACY_WRITE"]=1,i[o[2]="DUAL_READ_DUAL_WRITE"]=2,i[o[3]="DUAL_READ_REVAPI_WRITE"]=3,i[o[4]="REVAPI_READ_WRITE"]=4,i),n.CheckoutExperimentProps=(function(e){function e(e){if(e)for(var t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.proBizMve="",e.prototype.paymentPayPalV2Flow="",e.prototype.checkoutCreateUserIsolation="",e.prototype.checkoutRevenueApiPathway=0,e.prototype.checkoutPromoConsolidation="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=l.create()),null!=e.proBizMve&&Object.hasOwnProperty.call(e,"proBizMve")&&t.uint32(18).string(e.proBizMve),null!=e.paymentPayPalV2Flow&&Object.hasOwnProperty.call(e,"paymentPayPalV2Flow")&&t.uint32(26).string(e.paymentPayPalV2Flow),null!=e.checkoutCreateUserIsolation&&Object.hasOwnProperty.call(e,"checkoutCreateUserIsolation")&&t.uint32(34).string(e.checkoutCreateUserIsolation),null!=e.checkoutRevenueApiPathway&&Object.hasOwnProperty.call(e,"checkoutRevenueApiPathway")&&t.uint32(40).int32(e.checkoutRevenueApiPathway),null!=e.checkoutPromoConsolidation&&Object.hasOwnProperty.call(e,"checkoutPromoConsolidation")&&t.uint32(50).string(e.checkoutPromoConsolidation),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var a=void 0===t?e.len:e.pos+t,r=new c.checkout_page.CheckoutExperimentProps;e.pos<a;){var n=e.uint32();switch(n>>>3){case 2:r.proBizMve=e.string();break;case 3:r.paymentPayPalV2Flow=e.string();break;case 4:r.checkoutCreateUserIsolation=e.string();break;case 5:r.checkoutRevenueApiPathway=e.int32();break;case 6:r.checkoutPromoConsolidation=e.string();break;default:e.skipType(7&n)}}return r},e.getTypeUrl=function(){return"type.googleapis.com/checkout_page.CheckoutExperimentProps"},e})(n.CheckoutExperimentProps||{}),n)})),define("modules/clean/auth/common/captcha",["require","exports","tslib","classnames","react","modules/clean/react/css","modules/clean/abuse/captcha_helper"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Captcha=t.CaptchaComponent=t.clear_captcha_response=t.handle_captcha_errors=t.get_captcha_responses=void 0,r=a.__importDefault(r),n=a.__importDefault(n),t.get_captcha_responses=function(e){var t=e.getWrappedComponent();return{"g-recaptcha-response":t.recaptcha_response,"funcaptcha-response":t.funcaptcha_response}},t.handle_captcha_errors=function(e,t){return e.getWrappedComponent().handle_captcha_errors(t)},t.clear_captcha_response=function(e){return e.getWrappedComponent().clear_captcha_response()};var s=(function(t){function o(e){return t.call(this,e)||this}return a.__extends(o,t),o.prototype.handle_captcha_errors=function(t){var r=this;return!(!t||!t.funcaptcha_response)&&(new Promise((function(t,a){e(["modules/clean/abuse/funcaptcha_modal"],t,a)})).then(a.__importStar).then((function(e){(0,e.openFuncaptchaModal)(r.props.email||"",r.props.source,(function(e){r.funcaptcha_response=e,r.props.onSubmit()}))})),!0)},o.prototype.clear_captcha_response=function(){this.funcaptcha_response=void 0},o.prototype.componentDidMount=function(){i.LoadRecaptcha(void 0,!0)},o.prototype.render=function(){return n.default.createElement("div",{ref:"container_div",className:r.default({"recaptcha-v2-challenge-container":!0,"recaptcha-v2-challenge-container--invisible":!0})},n.default.createElement("div",{ref:"captcha_div",className:"recaptcha_v2_challenge"}))},o.prototype.submit=function(){this.clear_captcha_response(),this.props.onSubmit()},o})(n.default.Component);t.CaptchaComponent=s,t.Captcha=o.requireCssWithComponent(s,["/static/css/recaptcha-vflIN6j39.css"])})),define("modules/clean/auth/common/utils",["require","exports","modules/constants/page_load","modules/core/uri"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorRecoveryUrl=t.isGoogleGrowthExperimentOn=t.lastNameGoesFirst=t.generateId=void 0,t.generateId=function(e){return e+Math.random().toString().slice(2)};var n=["ja","ko","zh"];t.lastNameGoesFirst=function(){return n.includes(a.USER_LOCALE.slice(0,2))},t.isGoogleGrowthExperimentOn=function(e){return["GOOGLE2","GOOGLE3","MULTISTEP"].includes(e)},t.twoFactorRecoveryUrl=function(e,t){var a=new r.URI({path:"/twofactor_recovery"});return e&&a.updateQuery({remember_me:e.toString()}),t&&!["/",""].includes(t)&&a.updateQuery({cont:t}),a.toString()}})),define("modules/clean/components/password_strength_meter",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/css","modules/clean/react/bubble_dropdown_v2","modules/clean/web_timing_logger","modules/core/cancelable_promise","modules/clean/react/sticky_position"],(function(e,t,a,r,n,o,i,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordStrengthMeter=void 0,r=a.__importDefault(r),n=a.__importDefault(n);var p=(function(t){function i(r){var n=t.call(this,r)||this;return n.setZxcvbn=function(e){var t=e.default;n.setState({zxcvbn:t})},n.getPasswordScore=function(e){return n.state.zxcvbn?n.state.zxcvbn(e).score:0},n.state={},r.zxcvbnPostTti?l.waitForTTI().then((function(){n.zxcvbnPromise=u.makeCancelable(new Promise((function(t,a){e(["zxcvbn"],t,a)})).then(a.__importStar)),n.zxcvbnPromise.then(n.setZxcvbn)})):(n.zxcvbnPromise=u.makeCancelable(new Promise((function(t,a){e(["zxcvbn"],t,a)})).then(a.__importStar)),n.zxcvbnPromise.then(n.setZxcvbn)),n}return a.__extends(i,t),i.prototype.componentWillUnmount=function(){this.zxcvbnPromise&&this.zxcvbnPromise.cancel()},i.prototype.render=function(){var e=this.props.password,t=e.length?Math.max(1,this.getPasswordScore(e)):0,a=["",o.intl.formatMessage({id:"i/ragh",defaultMessage:"Weak"}),o.intl.formatMessage({id:"GwYES8",defaultMessage:"So-so"}),o.intl.formatMessage({id:"Yd7c8F",defaultMessage:"Good"}),o.intl.formatMessage({id:"kbsmZh",defaultMessage:"Great!"})],i=this.props.bubbleDescription;return i||(i=o.intl.formatMessage({id:"6SDr7W",defaultMessage:"Passwords must be 6 characters or more. Good passwords are hard to guess and use uncommon words, numbers, symbols, and uppercase letters."})),r.default.createElement("div",{className:"password-input-meter "+this.props.className,tabIndex:-1,"aria-label":o.intl.formatMessage({id:"7h/xn+",defaultMessage:"Password strength"})},[4,3,2,1].map((function(e){var a=n.default({"password-input-dot":!0,"password-input-dot-selected--weak":t>=e&&t<=2,"password-input-dot-selected":t>=e});return r.default.createElement("div",{key:"password-input-dot-"+e,className:a})})),r.default.createElement(s.BubbleDropdown,{position:this.props.bubblePosition||c.StickyPosition.RIGHT,targetButton:r.default.createElement("button",{className:"password-bubble__button"}),className:this.props.bubbleClassName},r.default.createElement("div",{className:"password-bubble__content"},r.default.createElement("div",{className:"password-bubble__title"},a[t]||""),r.default.createElement("div",{className:"password-bubble__desc"},i))))},i})(r.default.Component);t.PasswordStrengthMeter=i.requireCssWithComponent(p,["/static/css/components/password_strength_meter-vflAqZDga.css"])})),define("modules/clean/react/payments/buy/components/buy_component",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/payments/buy/components/buy_purchase_form","modules/clean/react/payments/buy/components/headline","modules/clean/react/payments/buy/components/buy_navigation","react-intl","modules/clean/react/payments/buy/components/payments/async_sox_compliance_warning","modules/clean/react/rebrand/elements/rebrand_arbor_footer_components_lazy","modules/clean/react/payments/buy/components/promos/promo_banner","modules/clean/react/payments/buy/helpers/product_plan_helpers"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuyComponent=void 0,r=a.__importDefault(r);var h=(function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){i.mark_time_to_interactive()},t.prototype.renderCheckOutForm=function(){var e=this.props,t=e.actions,a=e.checkoutFormProps,r=e.experiments,o=e.formData,i=e.pageState,l=e.pricingState,u=e.productPlanType,c=e.showTrialVersion,p=e.useAUTaxInclusivePricing,d=e.userIsEligibleForProfessionalTrial,m=a.braintreeClientToken,f=a.ccIframeUrl,h=a.continueURI,y=a.countryCode,g=a.countryList,_=a.currencyToFormatMap,v=a.defaultPlan,P=a.hideNavigationSteps,b=a.idealBanks,S=a.locale,C=a.localeNumberFormat,E=a.productOfferings,T=a.serializedPaymentFormSpec,N=a.showMarketingOptInIfNewAccount,w=a.supportedProducts,F=a.taxNamesByCountry,k=a.userInfo;return n.default.createElement(s.BuyPurchaseForm,{defaultPlan:v,supportedProducts:w,actions:t,braintreeClientToken:m,ccIframeUrl:f,continueURI:h,countryCode:y,countryList:g,currencyToFormatMap:_,experiments:r,formData:o,hideNavigationSteps:P,idealBanks:b,locale:S,localeNumberFormat:C,pageState:i,productPlanType:u,productOfferings:E,pricingState:l,taxNamesByCountry:F,userInfo:k,serializedPaymentFormSpec:T,showMarketingOptInIfNewAccount:N,showTrialVersion:c,useAUTaxInclusivePricing:!!p,userIsEligibleForProfessionalTrial:d,submitFormSuccess:i.submitFormSuccess})},t.prototype.render=function(){var e=this.props,t=e.checkoutFormProps,a=t.hideNavigationSteps,i=t.defaultPlan,s=t.supportedProducts,h=e.purchaseHeadline,y=e.SOXComplianceMessage,g=e.pageState.promoSpec,_=e.experiments,v=r.default({DropboxBuyPage__content:!0,grid__container:!0,"grid--x-left":!0}),P=f.getProductPlanType(i),b=f.getSelectedUiProduct(s,P).namePrefixedWithDropbox;return n.default.createElement("main",{className:v},n.default.createElement(c.RawIntlProvider,{value:o.intl},n.default.createElement("div",{className:"DropboxBuyPage__header-placeholder"}),"ON"===_.checkoutPromoConsolidation&&g&&n.default.createElement("div",{className:"DropboxBuyPage__promo-banner"},n.default.createElement(m.PromoBanner,{promoSpec:g,fullPlanName:b})),y&&n.default.createElement(p.AsyncSOXComplianceBanner,{message:y}),n.default.createElement(l.DropboxBuyHeadlineWeb,{headlineText:h}),n.default.createElement(u.BuyNavigation,{hideSteps:a,currentStep:2}),n.default.createElement("section",{className:"DropboxBuyPage__form grid__container"},this.renderCheckOutForm()),n.default.createElement(d.LazyRebrandArborMinimalFooter,{localeSelectorWithoutCss:!0})))},t})((n=a.__importDefault(n)).default.Component);t.BuyComponent=h})),define("modules/clean/react/payments/buy/components/checkout_page",["require","exports","tslib","react","modules/clean/ajax","modules/core/exception","modules/core/notify","modules/core/browser","modules/clean/payments/skus/pricing_data","modules/clean/payments/skus/subscription_change_plan","proto_utils/unpack","modules/clean/web_timing_logger","modules/clean/web_timing_logger","modules/clean/analytics","modules/clean/react/payments/common/adapters/setup_cash","modules/clean/react/payments/buy/state/checkout_store_creator","modules/clean/react/payments/buy/actions/buy_actions_creator","modules/clean/react/payments/buy/reducers/reducers","modules/clean/react/payments/buy/components/buy_component","modules/clean/react/payments/buy/helpers/product_plan_helpers","dropbox/proto/js_init_data/checkout/checkout_page"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h,y,g,_,v,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.CheckoutPage=void 0,r=a.__importDefault(r),n=a.__importStar(n),o=a.__importStar(o),s=a.__importStar(s),p=a.__importStar(p);var b=P.checkout_page.CheckoutRevenueApiPathwayEnum,S=P.checkout_page.CheckoutExperimentProps,C=P.checkout_page.Offering,E=(function(t){function c(r){var n,o=t.call(this,r)||this,i=r.checkoutFormProps,s=r.webTimingLoggerServerContext;f.setupCash(i.localeNumberFormat,i.currencyToFormatMap),s&&p.initialize_module(a.__assign({log_time_to_interactive:!0,log_time_to_view:!0,ttv_at_dom_interactive:!0,tti_at_dom_interactive:!0},s));var l=o.getStoreProps();return o.store=h.configureStore(l,g.proBuyReducer),o.state={checkoutStoreState:o.store.getState()},o.store.subscribe((function(){o.setState({checkoutStoreState:o.store.getState()})})),(null===(n=o.state.checkoutStoreState.pageState.marketingTracker)||void 0===n?void 0:n.initData)&&d.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/marketing_tracker"],t,a)})).then(a.__importStar).then((function(e){var t,a=e.MarketingTracker;(null===(t=o.state.checkoutStoreState.pageState.marketingTracker)||void 0===t?void 0:t.initData)&&a.push(o.state.checkoutStoreState.pageState.marketingTracker.initData)}))})),o}return a.__extends(c,t),c.prototype.getStoreProps=function(){var e,t,a=this.props,r=a.checkoutFormProps,n=a.requestId,o=a.showTrialVersion,i=a.promoSpec,s=a.marketingTracker,l=r.defaultPlan,u=v.getProductPlanType(l),c={productPlanType:u,showTrialVersion:Boolean(o)},p=v.getSelectedUiProduct(r.supportedProducts,u);return{countryCode:r.countryCode,locale:r.locale,userInfo:r.userInfo,trialLength:p.trialInfo?p.trialInfo.trialDuration:0,serializedPaymentFormSpec:r.serializedPaymentFormSpec,serializedSubChangePlans:void 0,baseSubChangePlans:null===(t=null===(e=this.state)||void 0===e?void 0:e.checkoutStoreState)||void 0===t?void 0:t.pricingState.baseSubChangePlans,productPlanType:u,navState:c,showMarketingOptInIfNewAccount:r.showMarketingOptInIfNewAccount,showTrialVersion:c.showTrialVersion,requestId:n,marketingTracker:s,promoSpec:i}},Object.defineProperty(c.prototype,"actions",{get:function(){return y.bindCheckoutActions(this.store)},enumerable:!1,configurable:!0}),c.prototype.componentDidMount=function(){var e=this.props,t=e.checkoutFormProps.defaultPlan;e.experiments.checkoutRevenueApiPathway;b.LEGACY_READ_WRITE;var r="buy_"+t;n.SilentBackgroundRequest({url:"/growth/log_visit_ajax",type:"POST",data:a.__assign({endpoint:r,log_preauth:!0,additional_preauth_types:"preauth_pro_upgrade"},this.props.loggingProps)}),this.fetchInitialPlansData()},c.prototype.fetchInitialPlansData=function(){var e=this,t=Object.keys(this.props.checkoutFormProps.supportedProducts);n.WebRequest({url:"/pro/ajax_fetch_sub_change_plans",type:"POST",data:{product_plans:JSON.stringify(t)},success:function(t){var a=JSON.parse(t);if(0===a.length)i.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20),o.reportException({err:new Error("/pro/ajax_fetch_sub_change_plans returned 0 Subscription Change Plans"),severity:o.SEVERITY.NONCRITICAL});else{var r=a.map((function(e){return u.SubscriptionChangePlan.deserialize(e)}));e.actions.loadSubChangePlans(r)}},error:function(e,t,a){if("CurrencyMismatch"===a)m.ProEventsLogger.log("checkout_page_currency_mismatch"),s.redirect("/account/billing?modal=billing_info&reason=auto_convert");else if(0!==e.status){i.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20);var r="/pro/ajax_fetch_sub_change_plans failed to return Subscription Change Plans (status: "+e.status+")";o.reportException({err:new Error(r),severity:o.SEVERITY.CRITICAL})}}})},c.prototype.render=function(){var e=this.props,t=e.checkoutFormProps,n=e.experiments,o=e.purchaseHeadline,i=e.SOXComplianceMessage,s=e.useAUTaxInclusivePricing,l=e.userIsEligibleForProfessionalTrial,u=this.state.checkoutStoreState,c=u.navState,p=c.productPlanType,d=c.showTrialVersion,m=u.formData,f=u.pageState,h=u.pricingState,y={actions:this.actions,experiments:n,formData:m,pageState:f,productPlanType:p,showTrialVersion:d,SOXComplianceMessage:i,checkoutFormProps:t,purchaseHeadline:o,pricingState:h,useAUTaxInclusivePricing:s,userIsEligibleForProfessionalTrial:l};return r.default.createElement(_.BuyComponent,a.__assign({},y))},c})(r.default.Component);t.CheckoutPage=E,t.RootComponent=function(e){var t,n=a.__assign({},e);return n.experiments=c.unpackProto(e.experiments,S),n.checkoutFormProps.productOfferings=null===(t=e.checkoutFormProps.productOfferings)||void 0===t?void 0:t.map((function(e){return c.unpackProto(e,C)})),r.default.createElement(E,a.__assign({},n))}})),define("modules/clean/react/payments/buy/components/headline",["require","exports","tslib","classnames","react"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropboxBuyHeadlineWeb=void 0,r=a.__importDefault(r),n=a.__importDefault(n),t.DropboxBuyHeadlineWeb=function(e){var t=e.headlineText,a=e.subheadlineText,o=r.default({DropboxBuyPage__headline:!0,grid__container:!0}),i=r.default({DropboxBuyPage__subheadline:!0,grid__container:!0}),s=a?n.default.createElement("h2",{className:i},a):null;return n.default.createElement(n.default.Fragment,null,n.default.createElement("h1",{className:o},t),s)}})),define("modules/clean/react/payments/buy/components/included_features",["require","exports","tslib","classnames","react"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IncludedFeatures=void 0,r=a.__importDefault(r),n=a.__importDefault(n),t.IncludedFeatures=function(e){var t=e.content,a=r.default({"included-features":!0,grid__container:!0});return n.default.createElement("div",{className:a},n.default.createElement("p",{className:"included-features__title grid__item"},t.title),n.default.createElement("ul",{className:"included-features__list grid__container"},t.items.map((function(e,t){return n.default.createElement("li",{className:"included-features__feature grid__item--1-2",key:"included-"+t},e.text)}))))}})),define("modules/clean/react/payments/buy/components/buy_navigation",["require","exports","tslib","classnames","react","react-intl","spectrum-arbor/atoms/arbor_link/index"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuyNavigation=void 0,r=a.__importDefault(r),n=a.__importDefault(n);var s=o.defineMessages({step:{id:"HfKKgw",defaultMessage:"Step {step}"},axLabel:{id:"cYlduc",defaultMessage:"Current step is {current_step} of {total_steps}"}});t.BuyNavigation=function(e){var t=e.currentStep,l=e.hideSteps,u=r.default("DropboxBuyPage__steps","grid__container"),c=r.default("DropboxBuyPage__step",{"DropboxBuyPage__step--currentStep":1===t,"DropboxBuyPage__step--clickable":2===t}),p=r.default("DropboxBuyPage__step",{"DropboxBuyPage__step--currentStep":2===t});return n.default.createElement("div",{className:u},l?null:n.default.createElement(n.default.Fragment,null,n.default.createElement("span",{className:"ax-visually-hidden"},n.default.createElement(o.FormattedMessage,a.__assign({},s.axLabel,{values:{current_step:t,total_steps:2}}))),n.default.createElement("span",{"aria-hidden":"true"},1===t?n.default.createElement("span",{className:c,"data-testid":"step",key:"step-1"},n.default.createElement(o.FormattedMessage,a.__assign({},s.step,{values:{step:1}}))):n.default.createElement(i.ArborLink,{className:c,"data-testid":"step",key:"step-1",href:"/buy"},n.default.createElement(o.FormattedMessage,a.__assign({},s.step,{values:{step:1}}))),n.default.createElement("span",{className:p,"data-testid":"step",key:"step-2"},n.default.createElement(o.FormattedMessage,a.__assign({},s.step,{values:{step:2}}))))))}})),define("modules/clean/react/payments/common/middleware/pro_buy_logger",["require","exports","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proBuyLogger=void 0,t.proBuyLogger=function(e){var t,o,i,s,l,u=["UpdateFirstName","UpdateLastName","UpdateEmail","UpdatePassword","UpdateZipCode","UpdateAccountHolderName","UpdateIBAN"];return function(c){return function(p){try{var d=c(p),m=p.type,f=e.getState(),h=f.pageState,y=f.pricingState,g=f.formData,_=f.navState,v=void 0;if(-1!==u.indexOf(m)&&o===m)return d;"UpdateTransitionsStart"===m?t=(new Date).getTime():"UpdateTransitionsSuccess"!==m&&"UpdateTransitionsError"!==m||(v=(((new Date).getTime()-t)/1e3).toFixed(1));var P={type:m,submitButtonState:h.submitting||y.loadingPrices?"disabled":"enabled"};if(void 0!==v&&(P.roundtrip=v),"UpdateSchedule"===m){var b="Unknown";g.scheduleId.rawValue===r.ScheduleId.MONTHLY?b="SelectMonthly":g.scheduleId.rawValue===r.ScheduleId.YEARLY&&(b="SelectYearly"),P.event=b}else if("UpdatePaymentMethod"===m){var S="Unknown";g.paymentMethod.rawValue===n.PaymentMethod.CreditCard?S="SelectCredit":g.paymentMethod.rawValue===n.PaymentMethod.PayPal?S="SelectPaypal":g.paymentMethod.rawValue===n.PaymentMethod.DirectDeposit?S="SelectDebit":g.paymentMethod.rawValue===n.PaymentMethod.Ideal&&(S="SelectIdeal"),P.event=S}else if("UpdateNonce"===m){var C=!1,E=g.nonce,T=E.isCCNValid,N=E.isCCodeValid,w=E.isCCExpValid;if(null!==i&&null!==l&&null!==s&&i===T&&l===N&&s===w&&(C=!0),i=T,l=N,s=w,C)return d;P.UpdateCC=T?"Valid":"Invalid",P.UpdateCVV=N?"Valid":"Invalid",P.UpdateExp=w?"Valid":"Invalid",o=m}return g.productPlanType.rawValue&&(P.productPlanType=g.productPlanType.rawValue,P.showTrialVersion=_&&_.showTrialVersion?"true":"false"),"UpdateHistory"===m&&h.promoSpec&&(P.promoId=h.promoSpec.id),a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT,P),-1!==u.indexOf(m)&&(o=m),d}catch(e){throw a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT_CRASH,{action:p.type,error:e.stack||e.toString()}),e}}}}})),define("modules/clean/react/payments/buy/actions/buy_actions_creator",["require","exports","tslib","redux","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/checkout/components/payment_method_form/apple_pay"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHARED_FORM_ACTIONS=t.bindCheckoutActions=void 0,r=a.__importStar(r),n=a.__importStar(n),o=a.__importStar(o),i=a.__importStar(i),t.bindCheckoutActions=function(e){return r.bindActionCreators(a.__assign(a.__assign({},t.SHARED_FORM_ACTIONS),{loadSubChangePlans:n.loadSubChangePlans,updateHistory:n.updateHistory,updateSelectedPlan:n.updateSelectedPlan}),e.dispatch)},t.SHARED_FORM_ACTIONS={showFormFieldErrors:i.showFormFieldErrors,submitCaptcha:i.submitCaptcha,submitProBuyForm:o.submitProBuyFormToServer,updateNonce:i.updateNonce,updatePayPalNonce:i.updatePayPalNonce,blurCCField:i.blurCCField,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateApplePayToken:i.updateApplePayToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,toggleExistingAccount:n.toggleSignInModal,updateCurrentPage:n.updateCurrentPage,updateFirstName:i.updateFirstName,updateLastName:i.updateLastName,updateEmail:i.updateEmail,updatePassword:i.updatePassword,updateSchedule:o.updateSchedule,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:o.updateCountryCode,updateZipCode:o.updateZipCode,blurZipCode:i.blurZipCode,updateVat:o.updateVat,blurVat:i.blurVat,updateCpf:i.updateCpf,blurCpf:i.blurCpf,updateCpfName:i.updateCpfName,updateAccountHolderName:i.updateAccountHolderName,blurAccountHolderName:i.blurAccountHolderName,updateIBAN:i.updateIBAN,blurIBAN:i.blurIBAN,updateMandateSigned:i.updateMandateSigned,updateMarketingOptIn:i.updateMarketingOptIn,updateIdealBank:o.updateIdealBank,updateTermsAndService:i.updateTermsAndService,paymentBannerError:i.paymentBannerError,applePayAction:s.applePayAction}})),define("modules/clean/react/payments/buy/actions/buy_form_actions",["require","exports","tslib","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/core/exception","modules/clean/react/payments/buy/actions/pricing_actions","modules/core/notify","modules/clean/web_register_logging_data","modules/clean/payments/skus/pricing_data","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/helpers/product_plan_helpers","modules/clean/react/payments/buy/types/types"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h){"use strict";function y(e,t,a,r,o,i,s){void 0===o&&(o=!1),void 0===i&&(i=!0),void 0===s&&(s="OFF");var l=e.countryCode.formattedValue,u=["scheduleId","paymentMethod","countryCode"];return o||u.push("termsAndService"),a||(u.push("firstName","lastName","email","password"),r&&u.push("marketingOptIn")),t.allow_zip_code_for_country(l)&&u.push("zipCode"),t.should_show_vat_for_country(l)&&""!==e.vat.formattedValue&&u.push("vat"),t.should_require_cpf(l,e.paymentMethod.formattedValue)&&u.push("cpf"),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(u.push("nonce"),u.push("adyenEncryptedCard"),u.push("encryptedCardForNetworkToken"),u.push("browserInfo"),u.push("threeDsData"),i&&u.push("bin")):e.paymentMethod.formattedValue===n.PaymentMethod.PayPal?"ON"===s&&u.push("payPalNonce"):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?u.push("accountHolderName","iban","mandateSigned"):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal?u.push("idealBankId","idealBankName"):e.paymentMethod.formattedValue===n.PaymentMethod.ApplePay&&u.push("applePayToken"),u}var g;function _(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var n,i,s,l,c,p,d,m,h;return a.__generator(this,(function(a){return n=r.pageState,i=n.existingAccountShowing,s=n.requestId,l=n.submitSeq,c=e&&e.getScheduleId()===o.ScheduleId.MONTHLY?"monthly":"yearly",t.account_info_type=i?"existing":"new",t.billing_schedule=c,t.currency=e&&e.getCurrency(),t.expected_price=e&&e.getExpectedPriceToken(),t.plan_id=e&&e.transition.state.plan.id,t.tos_version="3",t.packrat=e&&e.hasPackrat(),t.request_id=s,t.submit_seq=l,r.navState?(p=r.navState,d=p.showTrialVersion,m=p.productPlanType,h=f.getCheckoutPageProductPlan(m),t.expected_price_amount=e&&e.getTotalPrice().amount,t.product=v(h),t.signup_type=d?"trial":"purchase",t.signup_tag=P(h,d),[2,u.setWebRegisterLoggingData(t)]):[2,u.setWebRegisterLoggingData(t)]}))}))}function v(e){switch(e){case h.CheckoutPageProductPlan.PROFESSIONAL:return"pro";default:return e}}function P(e,t){switch(e){case h.CheckoutPageProductPlan.PLUS:return t?g.PLUS_TRY:g.PLUS_BUY;case h.CheckoutPageProductPlan.PROFESSIONAL:return t?g.PRO_TRY:g.PRO_BUY;default:return}}function b(e){return function(t){t(p.updateCountryCode(e)),t(s.updatePrice())}}function S(e){return function(t){t(p.updateZipCode(e)),t(s.updatePrice())}}function C(e){return function(t){t(p.updateVat(e)),t(s.updatePrice())}}function E(e){return function(t){t((function(e){return{type:d.FormActionEnum.UpdateSchedule,value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function T(e){return function(t){t(p.updateIdealBank(e))}}function N(e){return{type:d.FormActionEnum.UpdateProductPlanType,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.actionCreators=t.updateProductPlanType=t.updateIdealBank=t.updateSchedule=t.updateVat=t.updateZipCode=t.updateCountryCode=t.getAdditionalDataSignupTagField=t.getAdditionalDataProductTagField=t.fillAdditionalData=t.SignupTags=t.submitProBuyFormToServer=t.getFieldNamesToValidate=void 0,i=a.__importStar(i),s=a.__importStar(s),p=a.__importStar(p),t.getFieldNamesToValidate=y,t.submitProBuyFormToServer=function(e){var t=e.additionalData,a=void 0===t?{}:t,n=e.allowSubmitWithoutTOS,o=e.captchaComponentRef,s=e.handle3DsMessage,u=e.enableBinRouting,p=e.prepareForSubmission,d=e.trigger,f=e.url,h=e.paymentPayPalV2Flow,g=void 0===h?"OFF":h;return function(e,t){var h,v=t(),P=v.formData,b=v.pageState.paymentFormSpec,S=v.pageState.existingAccountShowing,C=v.pageState.showMarketingOptInIfNewAccount,E=v.pricingState.subChangePlans;if(E){var T=P.scheduleId.formattedValue,N=P.evh.rawValue,w=E.filter((function(e){return!!e.finalSubState.plan&&(e.finalSubState.plan.billingSchedule.id===T&&!!e.finalSubState.addons.skus.length===N)})).pop();if(w){if(w.finalSubState.planSku.productType!==P.productPlanType.rawValue)return l.Notify.error(c.PricingDataException.notifyErrorMessagePersonal,20),void i.reportException({err:new Error("Intended product type to purchase does not match subscription change plan"),severity:i.SEVERITY.CRITICAL});h=w.tvm,a.sub_change_plan=JSON.stringify(w)}}var F=y(P,b,S,C,n,u,g);_(h,a,v).then((function(t){e(m.submitForm(f,F,p,t,o,s,d)),""!==v.formData.vat.formattedValue&&r.ProEventsLogger.log("vat_provided_on_initial_purchase",{})}))}},(function(e){e.PRO_BUY="pro_buy_register",e.PRO_TRY="pro_try_register",e.PLUS_BUY="plus_buy_register",e.PLUS_TRY="plus_try_register"})(g=t.SignupTags||(t.SignupTags={})),t.fillAdditionalData=_,t.getAdditionalDataProductTagField=v,t.getAdditionalDataSignupTagField=P,t.updateCountryCode=b,t.updateZipCode=S,t.updateVat=C,t.updateSchedule=E,t.updateIdealBank=T,t.updateProductPlanType=N,t.actionCreators={updateCountryCode:b,updateZipCode:S,updateVat:C,updateSchedule:E,updateIdealBank:T,updateProductPlanType:N}})),define("modules/clean/react/payments/buy/actions/page_actions",["require","exports","tslib","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/dbmodal"],(function(e,t,a,r,n,o){"use strict";var i;function s(e,t){return{type:i.UpdateCurrentPage,productPlanType:e,showTrialVersion:Boolean(t)}}function l(e,t){return{type:i.UpdateTrialEndDate,trialDuration:e,locale:t}}function u(e){return function(t){t({type:i.LoadSubChangePlans,baseSubChangePlans:e}),t(r.updatePrice())}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadSubChangePlans=t.updateSelectedPlan=t.updateHistory=t.updateTrialEndDate=t.updateCurrentPage=t.toggleSignInModal=t.PageActionEnum=void 0,r=a.__importStar(r),o=a.__importStar(o),(function(e){e.LoadSubChangePlans="LoadSubChangePlans",e.ToggleSignInModal="ToggleSignInModal",e.UpdateCurrentPage="UpdateCurrentPage",e.LoadCheckoutFormProps="LoadCheckoutFormProps",e.UpdateHistory="UpdateHistory",e.PaymentBannerError="PaymentBannerError",e.UpdateTrialEndDate="UpdateTrialEndDate"})(i=t.PageActionEnum||(t.PageActionEnum={})),t.toggleSignInModal=function(e){return function(t,a){a().pageState.userInfo.existingAccount?t({type:i.ToggleSignInModal,show:e}):new o.DBModal({element_id:"sign-in-modal",focus:"input[name='login_email']"}).show()}},t.updateCurrentPage=s,t.updateTrialEndDate=l,t.updateHistory=function(){return{type:i.UpdateHistory}},t.updateSelectedPlan=function(e,t,a,r){return function(o,i){o(s(e,r)),o(n.updateProductPlanType(e)),o(l(t,a));var c=i().pricingState;c.baseSubChangePlans&&o(u(c.baseSubChangePlans))}},t.loadSubChangePlans=u})),define("modules/clean/react/payments/buy/actions/pricing_actions",["require","exports","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/react/growth_pages/promo/types"],(function(e,t,a,r,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.actionCreators=t.updateCurrentTransitionPrices=t.updateDisplayPrices=t.updateTransitionsError=t.updateTransitionsSuccess=t.updateTransitionsStart=t.updatePrice=t.PricingActionEnum=void 0,(function(e){e.UpdateCurrentTransitionPrices="UpdateCurrentTransitionPrices",e.UpdateDisplayPrices="UpdateDisplayPrices",e.UpdateTransitionsStart="UpdateTransitionsStart",e.UpdateTransitionsSuccess="UpdateTransitionsSuccess",e.UpdateTransitionsError="UpdateTransitionsError"})(o=t.PricingActionEnum||(t.PricingActionEnum={}));var i=new r.SubscriptionService;function s(){return function(e,t){var r=t(),o=r.formData,s=r.pricingState,m=r.pageState,f={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};if(e(l()),s.subChangePlans){var h=s.subChangePlans.map((function(e){return a.SubscriptionDiff.fromSubscriptionStatus(e)})),y=m.promoSpec&&m.promoSpec.cashCode&&m.promoSpec.id!==n.PromoSpecType.TRIAL?{cashCode:m.promoSpec.cashCode}:void 0;i.priceSet(h,f,y,!0).then((function(t){e(u(t)),e(p(t)),e(d(t))})).catch((function(t){e(c(t))}))}}}function l(){return{type:o.UpdateTransitionsStart}}function u(e){return{type:o.UpdateTransitionsSuccess,subChangePlans:e}}function c(e){return{type:o.UpdateTransitionsError,error:e}}function p(e){return{type:o.UpdateDisplayPrices,subChangePlans:e}}function d(e){return{type:o.UpdateCurrentTransitionPrices,subChangePlans:e}}t.updatePrice=s,t.updateTransitionsStart=l,t.updateTransitionsSuccess=u,t.updateTransitionsError=c,t.updateDisplayPrices=p,t.updateCurrentTransitionPrices=d,t.actionCreators={updatePrice:s,updateTransitionsStart:l,updateTransitionsSuccess:u,updateTransitionsError:c,updateDisplayPrices:p,updateCurrentTransitionPrices:d}})),define("modules/clean/react/payments/buy/state/checkout_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/payments/payment_form/payment_form_spec","modules/clean/redux/unsupported","modules/clean/redux/devtools","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/constants","modules/clean/react/payments/common/middleware/pro_buy_logger","modules/clean/react/payments/common/form_value_factory","modules/core/browser","modules/core/notify","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/logging/hive/schemas/web-payments_ux_analytics"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h,y,g,_,v){"use strict";function P(e){return function(e){return function(t){if("SubmitFormError"!==t.type)return e(t);var a=e(t);return t.data&&t.data.error_message&&y.Notify.error(t.data.error_message),t.data.redirect&&h.redirect(t.data.redirect),a}}}function b(e){var t=S(e),a=C(e,t);return{pageState:t,pricingState:E(e,a),formData:a,navState:(function(e){var t=e.navState;return t||{productPlanType:0,showTrialVersion:!1}})(e)}}function S(e){var t=e.locale,a=e.userInfo,r=e.serializedPaymentFormSpec,n=e.showMarketingOptInIfNewAccount,i=e.requestId,s=e.promoSpec,l=e.marketingTracker;return{locale:t,userInfo:a,existingAccountShowing:a.existingAccount,paymentFormSpec:new o.PaymentFormSpec(r),submitFormSuccess:!1,showMarketingOptInIfNewAccount:n,requestId:i,submitSeq:0,submitting:!1,promoSpec:s,showBuyClickError:!1,marketingTracker:l,paypalEmail:""}}function C(e,t){var a=e.countryCode,r=e.userInfo,n=e.vat,o=e.trialLength,i=e.showTrialVersion,s=e.locale,l=r.fname||"",u=r.lname||"",c="";r.existingAccount||(c=r.email||"");var p,m=r.password||"",h=d.ScheduleId.YEARLY,y=e.productPlanType||d.ProductPlanType.STANDARD;p=i?t.paymentFormSpec.default_payment_method():t.paymentFormSpec.default_payment_method_for_country(a);var g=n||"";return{city:f.FormValueFactory.createCity(""),phone:f.FormValueFactory.createPhone(""),name:f.FormValueFactory.createName(""),address:f.FormValueFactory.createAddress(""),nonce:f.FormValueFactory.createNonce(""),payPalNonce:f.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:f.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:f.FormValueFactory.createEncryptedCardForNetworkToken("",""),applePayToken:f.FormValueFactory.createApplePayToken(""),bin:f.FormValueFactory.createBIN(""),browserInfo:f.FormValueFactory.createBrowserInfo(""),threeDsData:f.FormValueFactory.createThreeDsData(""),firstName:f.FormValueFactory.createInput(l),lastName:f.FormValueFactory.createInput(u),email:f.FormValueFactory.createEmail(c),password:f.FormValueFactory.createPassword(m),productPlanType:f.FormValueFactory.createProductPlanType(y),scheduleId:f.FormValueFactory.createSchedule(h),paymentMethod:f.FormValueFactory.createPaymentMethod(p,a,t.paymentFormSpec),countryCode:f.FormValueFactory.createCountryCode(a),zipCode:f.FormValueFactory.createZipCode("",a,t.paymentFormSpec),vat:f.FormValueFactory.createVat(g,a),cpf:f.FormValueFactory.createCpf("",void 0,!0),cpfName:f.FormValueFactory.createCpfNamePrefill("","",r.displayName,void 0,!0),accountHolderName:f.FormValueFactory.createInput(""),iban:f.FormValueFactory.createIBAN(""),mandateSigned:f.FormValueFactory.createCheckbox(!1),idealBankId:f.FormValueFactory.createIdealBankId(""),idealBankName:f.FormValueFactory.createIdealBankName(""),marketingOptIn:f.FormValueFactory.createCheckbox(!1,null,!0),termsAndService:f.FormValueFactory.createCheckbox(!1),evh:f.FormValueFactory.createCheckbox(!1),trialEndDate:f.FormValueFactory.createTrialEndDate(o,s)}}function E(e,t){var a,r=e.baseSubChangePlans,n=e.serializedSubChangePlans;return r?a=r.filter((function(t){return t.subState.planSku&&e.navState&&t.subState.planSku.productType===e.navState.productPlanType})):n&&(a=n.map((function(e){return p.SubscriptionChangePlan.deserialize(e)}))),{loadingPrices:void 0===a,requestToken:-1,subChangePlans:a,baseSubChangePlans:r,displayPrices:c.getDisplayPrices(a,t,e.promoSpec),currentTransitionPrices:c.getCurrentTransitionPrices(a,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.createPricingState=t.createFormState=t.createPageState=t.createState=t.configureStore=t.submitFormErrorMiddleware=void 0,n=a.__importDefault(n),o=a.__importStar(o),t.submitFormErrorMiddleware=P,t.configureStore=function(e,t){var a=b(e),o=r.applyMiddleware(n.default,m.proBuyLogger,new g.PaymentsUXLogger(e.requestId,v.PaymentsUxPlatform.Legacy).reduxMiddleware,_.marketingEventMiddleware,P);return i.createStore(t,a,r.compose(o))},t.createState=b,t.createPageState=S,t.createFormState=C,t.createPricingState=E})),define("modules/clean/react/payments/buy/reducers/form_value_reducers",["require","exports","tslib","lodash","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/actions/buy_form_actions"],(function(e,t,a,r,n,o,i,s,l,u,c){"use strict";function p(e,t){var a=r.assignIn({},e.formData,t),n=c.getFieldNamesToValidate(a,e.pageState.paymentFormSpec,e.pageState.existingAccountShowing,e.pageState.showMarketingOptInIfNewAccount),o=e.pageState.showBuyClickError&&!u.isValidSubmitState(a,n),i=r.assignIn({},e.pageState,{showBuyClickError:o});return r.assignIn({},e,{formData:a,pageState:i})}function d(e,t){return"UpdateFirstName"!==t.type?e:p(e,{firstName:i.FormValueFactory.createInput(t.value,e.formData.firstName)})}function m(e,t){return"UpdateLastName"!==t.type?e:p(e,{lastName:i.FormValueFactory.createInput(t.value,e.formData.lastName)})}function f(e,t){if("EmailTakenError"!==t.type)return e;var a=e.formData.email;return a.errorState=n.EmailErrorState.TakenError,a.showError=!0,p(e,{email:a})}function h(e,t){return"UpdateEmail"!==t.type?e:p(e,{email:i.FormValueFactory.createEmail(t.value,e.formData.email)})}function y(e,t){return"UpdatePassword"!==t.type?e:p(e,{password:i.FormValueFactory.createPassword(t.value,e.formData.password)})}function g(e,t){var a=e.formData.firstName.rawValue,r=e.formData.lastName.rawValue,n=e.pageState.userInfo.displayName;switch(t.type){case"UpdateCpfName":return p(e,{cpfName:i.FormValueFactory.createCpfName(t.value,e.formData.cpfName,!0)});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(t.value,r,n,void 0,!0)});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(a,t.value,n,void 0,!0)});default:return e}}function _(e,t){if(t.type!==l.PageActionEnum.PaymentBannerError)return e;var a,n=r.assignIn({},e.pageState,{paymentBannerError:t.msg});e=r.assignIn({},e,{pageState:n});var o=document.getElementById("payment-info");if(!o)return e;var i=o.getBoundingClientRect().top;return void 0===a?a=i:i<a&&(a=i),void 0!==a&&scrollBy({top:a-150,behavior:"smooth"}),e}function v(e,t){return"UpdateProductPlanType"!==t.type?e:p(e,{productPlanType:i.FormValueFactory.createProductPlanType(t.value)})}function P(e,t){return"UpdateSchedule"!==t.type?e:p(e,{scheduleId:i.FormValueFactory.createSchedule(t.value)})}function b(e,t){if(t.type!==u.FormActionEnum.UpdatePaymentMethod&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var a=e.formData,r=e.pageState,n=t.type===u.FormActionEnum.UpdatePaymentMethod?t.value:a.paymentMethod.rawValue,o=a.countryCode.formattedValue;return p(e,{paymentMethod:i.FormValueFactory.createPaymentMethod(n,o,r.paymentFormSpec,a.paymentMethod)})}function S(e,t){return t.type!==u.FormActionEnum.UpdateCountryCode?e:p(e,{countryCode:i.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})}function C(e,t){if(t.type!==u.FormActionEnum.UpdateZipCode&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var a=t.type===u.FormActionEnum.UpdateZipCode?t.value:e.formData.zipCode.rawValue,r=e.formData.countryCode.formattedValue;return p(e,{zipCode:i.FormValueFactory.createZipCode(a,r,e.pageState.paymentFormSpec,e.formData.zipCode)})}function E(e,t){if(t.type!==u.FormActionEnum.UpdateVat&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var a=t.type===u.FormActionEnum.UpdateVat?t.value.toUpperCase():e.formData.vat.rawValue,r=e.formData.countryCode.formattedValue;return p(e,{vat:i.FormValueFactory.createVat(a,r,e.formData.vat)})}function T(e,t){if(t.type!==u.FormActionEnum.UpdateCpf)return e;return p(e,{cpf:i.FormValueFactory.createCpf(t.value,e.formData.cpf,!0)})}function N(e,t){if(t.type!==u.FormActionEnum.UpdateNonce)return e;return p(e,{nonce:i.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce,!0)})}function w(e,t){return t.type!==u.FormActionEnum.UpdateBIN?e:p(e,{bin:i.FormValueFactory.createBIN(t.value,e.formData.bin)})}function F(e,t){return t.type!==u.FormActionEnum.UpdateAccountHolderName?e:p(e,{accountHolderName:i.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})}function k(e,t){return t.type!==u.FormActionEnum.UpdateIBAN?e:p(e,{iban:i.FormValueFactory.createIBAN(t.value,e.formData.iban)})}function I(e,t){return t.type!==u.FormActionEnum.UpdateMandateSigned?e:p(e,{mandateSigned:i.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})}function M(e,t){return t.type!==u.FormActionEnum.UpdateMarketingOptIn?e:p(e,{marketingOptIn:i.FormValueFactory.createCheckbox(t.value,e.formData.marketingOptIn,!0)})}function x(e,t){return t.type!==u.FormActionEnum.UpdateTermsAndService?e:p(e,{termsAndService:i.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})}function D(e,t){return t.type!==l.PageActionEnum.UpdateTrialEndDate?e:p(e,{trialEndDate:i.FormValueFactory.createTrialEndDate(t.trialDuration,t.locale)})}function V(e,t){if(t.type!==u.FormActionEnum.UpdateIdealBank)return e;var a=t.value,r=a.bankId,n=a.bankName;return p(e,{idealBankId:i.FormValueFactory.createIdealBankId(r,e.formData.idealBankId),idealBankName:i.FormValueFactory.createIdealBankName(n,e.formData.idealBankName)})}Object.defineProperty(t,"__esModule",{value:!0}),t.submitFormError=t.submitFormSuccess=t.applePayClosedByFailure=t.submitFormStart=t.showFormFieldErrors=t.updateIdealBank=t.updateTrialEndDate=t.updateTOS=t.updateMarketingOptIn=t.updateMandateSigned=t.updateIBAN=t.updateAccountHolderName=t.updateBIN=t.updateNonce=t.updateCpf=t.updateVat=t.updateZipCode=t.updateCountryCode=t.updatePaymentMethod=t.updateSchedule=t.updateProductPlanType=t.paymentBannerError=t.updateCpfName=t.updatePassword=t.updateEmail=t.emailAlreadyTakenError=t.updateLastName=t.updateFirstName=t.FormInputReducers=t.OrderSummaryReducers=t.PaymentReducers=t.PlanReducers=t.AccountReducers=void 0,r=a.__importStar(r),n=a.__importStar(n),t.AccountReducers=[d,m,h,y,g,f],t.PlanReducers=[v,P],t.PaymentReducers=[S,b,C,E,T,g,N,s.updatePayPalNonce,s.updateAdyenEncryptedCard,s.updateEncryptedCardForNetworkToken,s.updateApplePayToken,w,s.updateBrowserInfo,s.updateThreeDsData,F,k,I,V,_],t.OrderSummaryReducers=[x,M,D],t.FormInputReducers=[A,O,L,R,U],t.updateFirstName=d,t.updateLastName=m,t.emailAlreadyTakenError=f,t.updateEmail=h,t.updatePassword=y,t.updateCpfName=g,t.paymentBannerError=_,t.updateProductPlanType=v,t.updateSchedule=P,t.updatePaymentMethod=b,t.updateCountryCode=S,t.updateZipCode=C,t.updateVat=E,t.updateCpf=T,t.updateNonce=N,t.updateBIN=w,t.updateAccountHolderName=F,t.updateIBAN=k,t.updateMandateSigned=I,t.updateMarketingOptIn=M,t.updateTOS=x,t.updateTrialEndDate=D,t.updateIdealBank=V;var B={firstName:"fname",lastName:"lname",email:"account-email",password:"password",name:"name",nonce:"iframe-holder",countryCode:"country_code",address:"address",zipCode:"zip",city:"city",accountHolderName:"owner_name",iban:"iban",mandateSigned:"mandate_signed",idealBankId:"ideal_bank",vat:"vat",cpf:"cpf"};function A(e,t){if(t.type!==u.FormActionEnum.ShowFormFieldErrors)return e;var n=a.__assign({},e.formData);e=r.assignIn({},e,{formData:n});for(var i,s=[],l=0,c=t.fieldNames;l<c.length;l++){var p=c[l],d=n[p];d&&!o.FormValueHelper.isValid(d)&&(n[p]=r.assignIn({},n[p],{showError:!0}),s.push(p))}var m=e.pageState.showBuyClickError;if("SubmitForm"===t.origin){m=!0;for(var f=0,h=s;f<h.length;f++){var y=h[f];if(B[y]){var g=document.getElementById(B[y]);if(g){var _=g.getBoundingClientRect().top;void 0===i?i=_:_<i&&(i=_)}}}void 0!==i&&scrollBy({top:i-150,behavior:"smooth"})}var v=r.assignIn({},e.pageState,{showBuyClickError:m});return e=r.assignIn({},e,{pageState:v})}function O(e,t){if(t.type!==u.FormActionEnum.SubmitFormStart)return e;var a=r.assignIn({},e.pageState,{submitting:!0,submitSeq:e.pageState.submitSeq+1});return r.assignIn({},e,{pageState:a})}function U(e,t){if(t.type!==u.FormActionEnum.ApplePayClosedByFailure)return e;var a=r.assignIn({},e.pageState,{submitSeq:e.pageState.submitSeq+1});return r.assignIn({},e,{pageState:a})}function L(e,t){return t.type!==u.FormActionEnum.SubmitFormSuccess?e:a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{submitFormSuccess:!0,submitting:!1})})}function R(e,t){if(t.type!==u.FormActionEnum.SubmitFormError)return e;var a=r.assignIn({},e.pageState,{submitting:!1});return r.assignIn({},e,{pageState:a})}t.showFormFieldErrors=A,t.submitFormStart=O,t.applePayClosedByFailure=U,t.submitFormSuccess=L,t.submitFormError=R})),define("modules/clean/react/payments/buy/reducers/page_reducers",["require","exports","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.existingAccountShowing=void 0;t.existingAccountShowing=function(e,t){switch(void 0===e&&(e=!1),t.type){case a.PageActionEnum.ToggleSignInModal:return(function(e,t){return void 0!==t.show?t.show:!e})(e,t);default:return e}}})),define("modules/clean/react/payments/buy/reducers/pricing_reducers",["require","exports","tslib","lodash","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/react/payments/buy/actions/pricing_actions"],(function(e,t,a,r,n,o){"use strict";function i(e,t){if(t.type!==o.PricingActionEnum.UpdateTransitionsStart)return e;var a=r.assignIn({},e.pricingState,{loadingPrices:!0});return r.assignIn({},e,{pricingState:a})}function s(e,t){if(t.type!==o.PricingActionEnum.UpdateTransitionsSuccess)return e;var a=r.assignIn({},e.pricingState,{loadingPrices:!1,subChangePlans:t.subChangePlans});return r.assignIn({},e,{pricingState:a})}function l(e,t){if(t.type!==o.PricingActionEnum.UpdateDisplayPrices)return e;var a=e.pageState.promoSpec,i=t.subChangePlans,s=n.getDisplayPrices(i,e.formData,a),l=r.assignIn({},e.pricingState,{displayPrices:s});return r.assignIn({},e,{pricingState:l})}function u(e,t){if(t.type!==o.PricingActionEnum.UpdateCurrentTransitionPrices)return e;var a=t.subChangePlans||e.pricingState.subChangePlans,i=n.getCurrentTransitionPrices(a,e.formData),s=r.assignIn({},e.pricingState,{currentTransitionPrices:i});return r.assignIn({},e,{pricingState:s})}Object.defineProperty(t,"__esModule",{value:!0}),t.updateCurrentTransitionPrices=t.updateDisplayPrices=t.updateTransitionsSuccess=t.updateTransitionsStart=t.PricingManagementReducers=t.TransitionManagementReducers=void 0,r=a.__importStar(r),t.TransitionManagementReducers=[i,s],t.PricingManagementReducers=[l,u],t.updateTransitionsStart=i,t.updateTransitionsSuccess=s,t.updateDisplayPrices=l,t.updateCurrentTransitionPrices=u})),define("modules/clean/react/payments/buy/reducers/nav_reducer",["require","exports","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navReducer=void 0,t.navReducer=function(e,t){return t.type!==a.PageActionEnum.UpdateCurrentPage?e:{productPlanType:t.productPlanType,showTrialVersion:t.showTrialVersion}}})),define("modules/clean/react/payments/buy/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/buy/reducers/form_value_reducers","modules/clean/react/payments/buy/reducers/pricing_reducers","modules/clean/react/payments/buy/reducers/page_reducers","modules/clean/react/payments/buy/reducers/nav_reducer","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,a,r,n,o,i,s,l){"use strict";function u(e){return function(t,a){return Object.assign({},t,e(t,a))}}function c(e,t){if(t.type!==l.PageActionEnum.LoadSubChangePlans)return e;var r=a.__assign({},e.pricingState);return r.baseSubChangePlans=t.baseSubChangePlans,r.subChangePlans=t.baseSubChangePlans.filter((function(t){var a;return(null===(a=t.subState.planSku)||void 0===a?void 0:a.productType)===e.navState.productPlanType})),a.__assign(a.__assign({},e),{pricingState:a.__assign({},r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.proBuyReducer=t.loadSubChangePlans=void 0,n=a.__importStar(n),o=a.__importStar(o),t.loadSubChangePlans=c,t.proBuyReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,r){return t(e(a,r),r)}}))}.apply(void 0,a.__spreadArrays([r.combineReducers({formData:function(e,t){return void 0===e&&(e={}),e},pageState:u(r.combineReducers({existingAccountShowing:i.existingAccountShowing})),pricingState:function(e,t){return void 0===e&&(e={}),e},navState:u(s.navReducer)}),c],n.AccountReducers,n.PlanReducers,n.PaymentReducers,n.OrderSummaryReducers,n.FormInputReducers,o.TransitionManagementReducers,o.PricingManagementReducers))})),define("modules/clean/react/payments/buy/types/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormVariant=t.CheckoutPageProductPlan=void 0,(function(e){e.PLUS="plus",e.PROFESSIONAL="professional",e.FAMILY="family",e.TRANSFER="transfer",e.BACKUP="backup",e.HELLOSIGN_DBX_PRO="hellosign_dbx_pro",e.PASSWORDS="passwords"})(t.CheckoutPageProductPlan||(t.CheckoutPageProductPlan={})),(function(e){e.ROW="row",e.COLUMN="column"})(t.FormVariant||(t.FormVariant={}))})),define("modules/clean/react/growth_pages/promo/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromoSpecType=void 0,(function(e){e[e.NOT_APPLICABLE=0]="NOT_APPLICABLE",e[e.EXTRA_TIME_MONTHS=1]="EXTRA_TIME_MONTHS",e[e.EXPERIMENTAL_PLAN=2]="EXPERIMENTAL_PLAN",e[e.PERCENT_DISCOUNT_PRETAX=3]="PERCENT_DISCOUNT_PRETAX",e[e.TRIAL=4]="TRIAL"})(t.PromoSpecType||(t.PromoSpecType={}))})),define("modules/clean/react/payments/buy/components/buy_purchase_form",["require","exports","tslib","react","react-intl","classnames","ts-key-enum","modules/core/i18n","modules/clean/raf_throttle","modules/clean/auth/common/captcha","modules/clean/web_timing_logger","modules/clean/analytics","modules/clean/react/payments/buy/components/account/new_account_input","modules/clean/react/payments/buy/components/plan/schedule_selection","modules/clean/react/payments/buy/components/payments/buy_payment_info_section","modules/clean/react/payments/buy/components/payments/order_summary/order_summary","modules/clean/react/payments/buy/components/payments/worldpay_entity_info","modules/clean/react/payments/buy/components/plan/plan_selection","modules/clean/react/payments/buy/types/types","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/core/exception","modules/clean/react/payments/buy/components/included_features","modules/clean/react/payments/buy/helpers/product_plan_helpers","modules/clean/react/payments/buy/components/account/new_account_input_utils"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h,y,g,_,v,P,b,S,C,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuyPurchaseForm=void 0,r=a.__importDefault(r),o=a.__importDefault(o),c=a.__importStar(c),b=a.__importStar(b);var T=(function(e){function t(t){var a=e.call(this,t)||this;a.paymentSectionRef=r.default.createRef(),a.orderSummaryRef=r.default.createRef(),a.paymentFormRef=r.default.createRef(),a.variant=_.FormVariant.ROW,a.setCaptchaComponent=function(e){a.captchaComponent=e},a.submitForm=function(e){var t,r=((t={})[v.PaymentMethod.CreditCard]="/pro/ajax_buy",t[v.PaymentMethod.PayPal]="/pro/ajax_paypal_buy",t[v.PaymentMethod.DirectDeposit]="/payments/ajax_sepa_buy",t[v.PaymentMethod.Ideal]="/payments/ajax_ideal_buy",t[v.PaymentMethod.ApplePay]="/pro/ajax_buy",t);a.onSubmitProBuyForm({trigger:e,url:r[a.props.formData.paymentMethod.formattedValue]})},a.handleSubmitTryForm=function(e){e.preventDefault(),a.onSubmitFormWithCaptchaScore()},a.submitTryForm=function(e){var t,r=a.state.selectedProduct;p.ProEventsLogger.log("clicked_start_free_trial_cta_"+r.name.toLowerCase());var n=((t={})[v.PaymentMethod.CreditCard]="/pro/ajax_try",t[v.PaymentMethod.PayPal]="/pro/ajax_paypal_try",t[v.PaymentMethod.TokenConnect]="/pro/ajax_try",t);a.onSubmitProBuyForm({trigger:e,url:n[a.props.formData.paymentMethod.formattedValue]})},a.onSubmitProBuyForm=function(e){var t,r=e.trigger,n=e.url,o=a.props,i=o.actions,s=o.continueURI,l=o.experiments,u=o.pageState.promoSpec,c=a.state.selectedProduct,p={cont:s,is_pro_buy_form:!0,send_conversion_data:!0};a.saveState(),u&&(p.is_pro_buy_form=!1,p.promo_ids=u.id,u.cashCode&&(p.code=u.cashCode)),"professional"===c.productPlan&&void 0!==(null===(t=c.trialInfo)||void 0===t?void 0:t.trialDuration)&&(p.offered_trial_duration=c.trialInfo.trialDuration),i.submitProBuyForm({additionalData:p,allowSubmitWithoutTOS:!1,captchaComponentRef:a.captchaComponent,handle3DsMessage:a.paymentInfoSection.getCreditCardFrame().handle3DsMessage,enableBinRouting:!0,prepareForSubmission:a.prepareForSubmission.bind(a),trigger:r,url:n,paymentPayPalV2Flow:l.paymentPayPalV2Flow})},a.onSubmitFormWithCaptchaScore=function(){a.captchaComponent&&a.captchaComponent.getWrappedComponent().submit()},a.resubmitForm=function(e){void 0===e&&(e=P.SubmitFormTriggerType.ButtonClick),a.props.showTrialVersion?a.submitTryForm(e):a.submitForm(e)},a.handleResize=function(){var e,t,r,n=null===(e=a.orderSummaryRef)||void 0===e?void 0:e.current,o=null===(t=a.paymentFormRef)||void 0===t?void 0:t.current,i=null===(r=a.paymentSectionRef)||void 0===r?void 0:r.current;if(n&&o&&i){var s=n.getBoundingClientRect().height,l=o.getBoundingClientRect().top,u=s+(i.getBoundingClientRect().top+window.pageYOffset)-(l+window.pageYOffset);o.style.setProperty("--sticky-form-height",Math.round(u)+"px"),n.style.setProperty("--window-width",document.documentElement.clientWidth+"px")}},a.onLoginClick=function(){p.GrowthEventsLogger.log("buy_checkout_sign_in_modal",{action:"click",location:"in_product"}),a.props.actions.toggleExistingAccount()},a.toggleExistingAccount=function(){a.props.actions.toggleExistingAccount(!1)},a.handlePress=function(e){e.key===i.Key.Enter&&e.target instanceof Element&&("INPUT"===e.target.tagName||"SELECT"===e.target.tagName)&&(e.preventDefault(),a.onSubmitFormWithCaptchaScore())},a.resizeThrottle=new l.RafThrottle(a.handleResize);var n=C.getSelectedUiProduct(a.props.supportedProducts,a.props.productPlanType);if(a.state={hasLoadedSubChangePlans:!1,selectedProduct:n},a.props.showTrialVersion){var o=a.props.pageState.paymentFormSpec;a.props.actions.updatePaymentMethod(o.default_payment_method())}return a.variant=a.props.variant?a.props.variant:_.FormVariant.ROW,a}return a.__extends(t,e),t.prototype.prepareForSubmission=function(){return this.paymentInfoSection.prepareForSubmission()},t.prototype.getValue=function(e,t){var a=this.props.pageState.paymentFormSpec.get_token_connect_data(e);if(null!=a)return a;if(void 0!==sessionStorage){var r=sessionStorage.getItem(e);if(null!=r)return r}return t},t.prototype.loadState=function(){try{if(void 0===sessionStorage&&void 0===this.props.pageState.paymentFormSpec.spec.token_connect_prefill_data)return;this.props.actions.updateFirstName(this.getValue("firstName",this.props.formData.firstName.rawValue)),this.props.actions.updateLastName(this.getValue("lastName",this.props.formData.lastName.rawValue)),this.props.actions.updateEmail(this.getValue("email",this.props.formData.email.rawValue)),this.props.actions.updateZipCode(this.getValue("zipCode",this.props.formData.zipCode.rawValue));var e=this.getValue("countryCode",this.props.formData.countryCode.rawValue);this.props.actions.updateCountryCode(e);var t=Number(this.getValue("paymentMethod",""+this.props.formData.paymentMethod.rawValue));this.props.pageState.paymentFormSpec.available_payment_methods_for_country(e).includes(t)&&this.props.actions.updatePaymentMethod(t)}catch(e){b.reportException({err:new Error("Error loading payment state"+e.message),severity:b.SEVERITY.NONCRITICAL})}},t.prototype.saveState=function(){try{if(void 0===sessionStorage)return;sessionStorage.setItem("firstName",this.props.formData.firstName.rawValue),sessionStorage.setItem("lastName",this.props.formData.lastName.rawValue),sessionStorage.setItem("email",this.props.formData.email.rawValue),sessionStorage.setItem("zipCode",this.props.formData.zipCode.rawValue),sessionStorage.setItem("countryCode",this.props.formData.countryCode.rawValue),sessionStorage.setItem("paymentMethod",""+this.props.formData.paymentMethod.rawValue)}catch(e){b.reportException({err:new Error("Error saving payment state"+e.message),severity:b.SEVERITY.NONCRITICAL})}},t.prototype.componentDidMount=function(){c.mark_time_to_interactive(),this.handleResize(),window.addEventListener("resize",this.resizeThrottle.request),"orientation"in window&&window.addEventListener("orientationchange",this.resizeThrottle.request),this.loadState()},t.prototype.componentDidUpdate=function(e,t){var a=this.props,r=a.pricingState,n=a.productPlanType,o=a.supportedProducts;!this.state.hasLoadedSubChangePlans&&r.currentTransitionPrices.totalPrice&&(this.handleResize(),this.setState({hasLoadedSubChangePlans:!0})),e.productPlanType!==n&&this.setState({selectedProduct:C.getSelectedUiProduct(o,n)})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeThrottle.request),"orientation"in window&&window.removeEventListener("orientationchange",this.resizeThrottle.request)},t.prototype.renderPaymentForm=function(){var e=this,t=this.props,a=t.actions,o=t.ccIframeUrl,i=t.countryList,l=t.experiments,u=t.idealBanks,c=t.locale,p=t.formData,h=t.pageState,y=t.pricingState,v=t.showTrialVersion,P=t.useAUTaxInclusivePricing,b=t.userIsEligibleForProfessionalTrial,S=t.braintreeClientToken,C=t.defaultPlan,T=t.supportedProducts,N=h.userInfo,I=h.promoSpec,M=h.paymentFormSpec,x=h.paymentBannerError,D=this.state.selectedProduct,V=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"uR6YMd",defaultMessage:"{index}. Choose your space"}):s.intl.formatMessage({id:"ix4+1x",defaultMessage:"Choose your space"})},B=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"xs62vu",defaultMessage:"{index}. Choose your billing cycle"}):s.intl.formatMessage({id:"r4whCV",defaultMessage:"Choose your billing cycle"})},A=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"DcuOhc",defaultMessage:"{index}. Create your account"}):s.intl.formatMessage({id:"QEa1gY",defaultMessage:"Create your account"})},O=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"2/IxPb",defaultMessage:"{index}. Enter payment details"}):s.intl.formatMessage({id:"yxgpXI",defaultMessage:"Enter payment details"})},U=void 0,L=C===_.CheckoutPageProductPlan.PLUS,R=D.productPlan===_.CheckoutPageProductPlan.PLUS&&v;!L||R||I||(U=function(e,t){return r.default.createElement(w,{index:e,key:"choose-space-section-"+e,modifier:"plan-selection",title:V(t)},r.default.createElement(g.PlanSelection,{actions:a,locale:c,productPlanType:p.productPlanType.rawValue,showPlanNameUnderRadio:!1,defaultPlan:C,supportedProducts:T,userIsEligibleForProfessionalTrial:b}))});var q=y.subChangePlans?void 0:{monthlyPrice:D.priceMonthly.price,annualPriceAsMonthly:D.priceAnnual.priceAsMonthly,yearlyPrice:D.priceAnnual.price,yearlyWithoutSavings:D.priceAnnual.withoutSavings,yearlySavings:D.priceAnnual.savings},H=r.default.createElement(m.ScheduleSelection,{actions:a,displayPrices:y.displayPrices,formData:p,initialPricingStrings:q,locale:c,useAUTaxInclusivePricing:P,showTrialVersion:v,paymentSchedule:D.paymentSchedule,showYearlyPricePerMonth:Boolean(D.showYearlyPricePerMonth)}),z=void 0;if(!h.userInfo.existingAccount){var j=r.default.createElement(k,{onClick:this.onLoginClick,linkKey:"existing_account",linkText:n.defineMessage({id:"jofRGL",defaultMessage:"or <existing_account>use existing Dropbox account</existing_account>"})});z=function(t,n){return r.default.createElement(F,{index:t,key:"create-account-section-"+t,link:j,title:A(n)},r.default.createElement(d.NewAccountInput,{actions:a,autocomplete:!0,formData:p,firstNameError:E.firstNameErrorMessage(p.firstName),lastNameError:E.lastNameErrorMessage(p.lastName),emailError:E.emailErrorMessage(p.email,e.toggleExistingAccount),passwordError:E.passwordErrorMessage(p.password)}))}}var Y=r.default.createElement(f.PaymentInfoSection,{paymentSpec:M,iframeUrl:o,idealBanks:u,countryList:i,formData:p,vatEnabled:Boolean(D.vatEnabled),actions:a,ref:function(t){e.paymentInfoSection=t},showTrialVersion:v,userInfo:N,submitForm:this.resubmitForm,paymentPayPalV2Flow:l.paymentPayPalV2Flow,braintreeClientToken:S,paymentBannerError:x,planNamePrefixedWithDropbox:D.namePrefixedWithDropbox,price:this.props.pricingState.currentTransitionPrices}),W=[U,function(e,t){return r.default.createElement(w,{index:e,key:"billing-schedule-section-"+e,modifier:"schedule-selection",title:B(t)},H)},z,function(t,a){return r.default.createElement(w,{forwardRef:e.paymentSectionRef,index:t,key:"payment-section-"+t,modifier:"billing",title:O(a)},Y)}],Z=[],K=1;return W.forEach((function(e){e&&(Z.push(e(K,!0)),K+=1)})),r.default.createElement("form",{className:"payment-form grid__container",method:"post",onKeyPress:this.handlePress},Z)},t.prototype.renderWorldpayEntityText=function(){return-1===t.excludeWorldpayEntityTextForCountry.indexOf(this.props.formData.countryCode.formattedValue)?r.default.createElement(y.WorldPayEntityInfo,null):null},t.prototype.render=function(){var e=this.props,t=e.actions,a=e.formData,n=e.pageState,i=e.pricingState,s=e.showMarketingOptInIfNewAccount,l=e.showTrialVersion,c=e.taxNamesByCountry,p=e.experiments,d=n.promoSpec,m=this.state.selectedProduct,f=m.included,y=l?this.handleSubmitTryForm:this.onSubmitFormWithCaptchaScore,g=this.variant===_.FormVariant.COLUMN;return r.default.createElement("div",{className:o.default("PurchaseForm","grid__container")},r.default.createElement("div",{className:o.default("grid__item","PurchaseForm__payment-col",{"grid__item--medium--11-24":!g,"PurchaseForm__payment-col--desktopSticky":!g}),ref:this.paymentFormRef},this.renderPaymentForm()),!g&&r.default.createElement("div",{className:"grid__item--medium--1-12"}),r.default.createElement("div",{className:o.default("grid__item","PurchaseForm__summary-col",{"grid__item--medium--11-24":!g,"PurchaseForm__summary-col--desktopSticky":!g,"PurchaseForm__summary-col--full":g}),ref:this.orderSummaryRef},r.default.createElement("div",{className:"grid__item"},r.default.createElement("div",{className:"grid__item"},r.default.createElement(h.OrderSummary,{actions:t,additionalTermsOfService:m.additionalTermsOfService,buyLink:m.pageUrl.buyLink,formVariant:this.variant,formData:a,currentTransitionPrices:i.currentTransitionPrices,isLoadingPrices:i.loadingPrices,onClick:y,pageState:n,planColor:m.planColor,planName:m.name,planNamePrefixedWithDropbox:m.namePrefixedWithDropbox,taxNamesByCountry:c,showMarketingOptInIfNewAccount:s,showTrialVersion:l,showPromoLegalCopy:"ON"===p.checkoutPromoConsolidation&&Boolean(d)})),f&&r.default.createElement(S.IncludedFeatures,{content:f}))),r.default.createElement("div",{className:"grid__item"},this.renderWorldpayEntityText()),r.default.createElement(u.Captcha,{ref:this.setCaptchaComponent,source:"BUY_PURCHASE_FORM",onSubmit:this.resubmitForm,email:this.props.pageState.userInfo.email||this.props.formData.email.formattedValue}))},t.excludeWorldpayEntityTextForCountry=["US","CA","MX"],t})(r.default.Component);t.BuyPurchaseForm=T;var N=function(){return r.default.createElement("hr",{"aria-hidden":"true",className:"payment-form__divider grid__item payment-form__divider"})},w=function(e){var t=e.children,n=e.forwardRef,o=e.index,i=e.modifier,l=e.title,u=a.__assign({className:"payment-form__section--"+i+" grid__item"},n?{ref:n}:{});return r.default.createElement("section",a.__assign({},u),r.default.createElement(N,null),r.default.createElement("div",{className:"payment-form__header grid__item"},"string"==typeof l?l:s.intl.formatMessage(l,{index:o})),t)},F=function(e){var t=e.index,a=e.link,n=e.title,o=e.children;return r.default.createElement("section",{className:"payment-form__section grid__item"},r.default.createElement(N,null),r.default.createElement("div",{className:"payment-form__header grid__container grid--x-bookend"},r.default.createElement("div",{className:"payment-form__header--account"},"string"==typeof n?n:s.intl.formatMessage(n,{index:t})),a),o)},k=function(e){var t,n=e.linkText,o=e.linkKey,i=e.onClick,l=e.otherFormatters,u=void 0===l?{}:l;return r.default.createElement("div",{className:"payment-form__login"},s.intl.formatMessage(n,a.__assign(((t={})[o]=function(e){return r.default.createElement("button",{"aria-label":"",key:"account-toggle",className:"account-toggle button--as-link",onClick:i,type:"button"},e)},t),u)))}})),define("modules/clean/react/payments/buy/components/account/new_account_input",["require","exports","tslib","react","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/components/password_strength_meter","modules/clean/react/payments/buy/components/account/new_account_input_utils","modules/clean/auth/common/utils","classnames"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewAccountInput=void 0,r=a.__importDefault(r),l=a.__importDefault(l);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFirstNameChanged=function(e){t.props.actions.updateFirstName(e.value)},t.onFirstNameBlur=function(e){t.props.actions.showFormFieldErrors(["firstName"],"FirstNameBlur")},t.onLastNameChanged=function(e){t.props.actions.updateLastName(e.value)},t.onLastNameBlur=function(e){t.props.actions.showFormFieldErrors(["lastName"],"LastNameBlur")},t.onEmailChanged=function(e){t.props.actions.updateEmail(e.value)},t.onEmailBlur=function(e){t.props.actions.showFormFieldErrors(["email"],"EmailBlur")},t.onPasswordChanged=function(e){t.props.actions.updatePassword(e.value)},t.onPasswordBlur=function(e){t.props.actions.showFormFieldErrors(["password"],"PasswordBlur")},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.autocomplete,a=e.emailError,u=e.firstNameError,c=e.formData,p=e.lastNameError,d=e.passwordError,m=s.lastNameGoesFirst(),f=r.default.createElement(n.LabeledTextInput,{name:"fname",autocomplete:t?"given-name":"off",labelText:i.accountLabels.firstName,containerClassName:l.default("grid__item--fluid",{"grid__item--margin-right--1-24":!m}),value:c.firstName.rawValue,onBlur:this.onFirstNameBlur,onChange:this.onFirstNameChanged,errorText:u}),h=r.default.createElement(n.LabeledTextInput,{name:"lname",autocomplete:t?"family-name":"off",labelText:i.accountLabels.lastName,containerClassName:l.default("grid__item--fluid",{"grid__item--margin-right--1-24":m}),value:c.lastName.rawValue,onBlur:this.onLastNameBlur,onChange:this.onLastNameChanged,errorText:p});return r.default.createElement("div",{className:"grid__item account-info grid__item--large--11-12"},r.default.createElement("div",{className:"account-info__name grid__container grid--x-bookend grid--y-top"},m?r.default.createElement(r.default.Fragment,null,h,f):r.default.createElement(r.default.Fragment,null,f,h)),r.default.createElement("div",{className:"account-info__cred grid__container grid--x-bookend grid--y-top"},r.default.createElement(n.LabeledTextInput,{name:"account-email",autocomplete:t?"email":"off",type:"email",labelText:i.accountLabels.email,containerClassName:"grid__item--fluid grid__item--margin-right--1-24",value:c.email.rawValue,onBlur:this.onEmailBlur,onChange:this.onEmailChanged,errorText:a}),r.default.createElement("div",{className:"account-info__password grid__item--fluid"},r.default.createElement(o.PasswordStrengthMeter,{password:c.password.rawValue}),r.default.createElement(n.LabeledTextInput,{name:"password",type:"password",autocomplete:"new-password",labelText:i.accountLabels.password,containerClassName:"grid__item",value:c.password.rawValue,onChange:this.onPasswordChanged,onBlur:this.onPasswordBlur,errorText:d}))))},t})(r.default.Component);t.NewAccountInput=u})),define("modules/clean/react/payments/buy/components/account/new_account_input_utils",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_values"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emailErrorMessage=t.passwordErrorMessage=t.lastNameErrorMessage=t.firstNameErrorMessage=t.accountLabels=void 0,r=a.__importDefault(r),i=a.__importStar(i),t.accountLabels={firstName:n.intl.formatMessage({id:"MF/EZ0",defaultMessage:"First name"}),lastName:n.intl.formatMessage({id:"o/EyS0",defaultMessage:"Last name"}),email:n.intl.formatMessage({id:"ycH5zr",defaultMessage:"Email"}),password:n.intl.formatMessage({id:"Dj00Xc",defaultMessage:"Password"})},t.firstNameErrorMessage=function(e){return e.showError&&!o.FormValueHelper.isValid(e)?n.intl.formatMessage({id:"first name",defaultMessage:"Please enter a valid first name."}):""},t.lastNameErrorMessage=function(e){return e.showError&&!o.FormValueHelper.isValid(e)?n.intl.formatMessage({id:"last name",defaultMessage:"Please enter a valid last name."}):""},t.passwordErrorMessage=function(e){return e.showError?n.intl.formatMessage({id:"y53jZ7",defaultMessage:"Passwords must be 6 characters or more."}):""},t.emailErrorMessage=function(e,t){if(!e.showError)return"";switch(e.errorState){case i.EmailErrorState.Empty:return n.intl.formatMessage({id:"uRA/73",defaultMessage:"Please enter an email address."});case i.EmailErrorState.NoAt:return n.intl.formatMessage({id:"JfCj3L",defaultMessage:"An email address must contain a single @"});case i.EmailErrorState.BadUsername:var a=e.formattedValue.split("@")[0];return n.intl.formatMessage({id:"YkS8kL",defaultMessage:"The username portion of the email address is invalid (the portion before the @: {username})."},{username:a});case i.EmailErrorState.BadDomain:var o=e.formattedValue.split("@")[1];return""===o?n.intl.formatMessage({id:"9wdsbq",defaultMessage:"The domain portion of the email address is invalid (the portion after the @)."}):n.intl.formatMessage({id:"HwUfO2",defaultMessage:"The domain portion of the email address is invalid (the portion after the @: {domain})."},{domain:o});case i.EmailErrorState.TakenWarning:return r.default.createElement("span",null,n.intl.formatMessage({id:"KP0Yzf",defaultMessage:"This e-mail is already taken."}));case i.EmailErrorState.TakenError:return r.default.createElement("span",null,n.intl.formatMessage({id:"KANDIa",defaultMessage:"This e-mail is already taken. <a_signin>Sign in</a_signin> or <a_forgot>reset your password</a_forgot>."},{a_signin:function(e){return r.default.createElement("a",{key:"a-signin",className:"login-register-switch-link",onClick:t},e)},a_forgot:function(e){return r.default.createElement("a",{key:"a-forgot",href:"/forgot"},e)}}));default:return""}}})),define("modules/clean/react/payments/buy/components/plan/schedule_selection",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScheduleSelection=void 0,r=a.__importDefault(r),n=a.__importDefault(n);var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScheduleChange=function(e,a,r){var n=e.currentTarget;r=r||n.value;var o=parseInt(r,10);o!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(o)},t.onPlanLabelClick=function(e){e!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(e)},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.actions,a=e.paymentSchedule;a&&"monthly"===a&&t.updateSchedule(i.ScheduleId.MONTHLY)},t.prototype.getPricingStrings=function(){var e,t,a,r,n,i,s,l=this.props.initialPricingStrings;if(l)e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:l.yearlyPrice}),r=o.intl.formatMessage({id:"KTUKSV",defaultMessage:"{price} per year. Save {savings}"},{price:l.yearlyPrice,savings:l.yearlySavings}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:l.monthlyPrice}),n=o.intl.formatMessage({id:"NCPpB8",defaultMessage:"{price} per month"},{price:l.monthlyPrice}),a=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:l.yearlyWithoutSavings}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:l.annualPriceAsMonthly}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:l.annualPriceAsMonthly});else{var u=this.props.displayPrices,c=u.yearlyPrice,p=u.monthlyPrice,d=u.yearlySavings,m=u.taxInclusiveYearlyPrice,f=u.taxInclusiveMonthlyPrice,h=u.taxInclusiveYearlySavings;this.props.useAUTaxInclusivePricing?(e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:m?m.formatCurrency():""}),r=o.intl.formatMessage({id:"fTrTN2",defaultMessage:"{price} per year. Save {savings}. Prices include GST"},{price:m?m.formatCurrency():"",savings:h?h.formatCurrency():""}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:f?f.formatCurrency():""}),n=o.intl.formatMessage({id:"/Ww02p",defaultMessage:"{price} per month. Includes GST"},{price:f?f.formatCurrency():""}),a=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:f?f.multiply(12).formatCurrency():""}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:m?m.divide(12).formatCurrency():""}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:m?m.divide(12).formatCurrency():""})):(e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:c?c.formatCurrency():""}),r=o.intl.formatMessage({id:"KTUKSV",defaultMessage:"{price} per year. Save {savings}"},{price:c?c.formatCurrency():"",savings:d?d.formatCurrency():""}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:p?p.formatCurrency():""}),n=o.intl.formatMessage({id:"NCPpB8",defaultMessage:"{price} per month"},{price:p?p.formatCurrency():""}),a=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:p?p.multiply(12).formatCurrency():""}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:c?c.divide(12).formatCurrency():""}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:c?c.divide(12).formatCurrency():""}))}return{yearlyPrice:e,yearlyPriceAx:r,monthlyPrice:t,monthlyPriceAx:n,yearlyPriceNoSavings:a,yearlyGstIncluded:o.intl.formatMessage({id:"iBp3QN",defaultMessage:"(prices include GST)"}),monthlyGstIncluded:o.intl.formatMessage({id:"XfS7WN",defaultMessage:"(includes GST)"}),yearlyPricePerMonth:i,yearlyPricePerMonthAx:s}},t.prototype.renderYearlyPlanBlock=function(){var e=this,t=this.props,a=t.locale,l=t.showYearlyPricePerMonth,u=this.props.formData.scheduleId.formattedValue,c=this.getPricingStrings(),p=c.yearlyPrice,d=c.yearlyPriceAx,m=c.yearlyPriceNoSavings,f=c.yearlyGstIncluded,h=c.yearlyPricePerMonth,y=c.yearlyPricePerMonthAx,g=c.monthlyGstIncluded,_=n.default({"plan-info__savings":!0,"plan-info__savings--strike":"en"===a}),v="en"===a?m:o.intl.formatMessage({id:"rOFcNI",defaultMessage:"(includes 2 free months)"}),P=r.default.createElement("span",{id:"plan-info__label--yearly",className:"plan-info__label plan-info__label--yearly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.YEARLY)},"aria-hidden":"true"},o.intl.formatMessage({id:"VeKS9s",defaultMessage:"Billed Yearly"})),b=l?h:p;return r.default.createElement("div",{className:"plan-info__choice plan-info__yearly"},r.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--yearly",ariaLabelId:"plan-info__label--yearly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.YEARLY.toString(),checked:u===i.ScheduleId.YEARLY,labelSpan:P,onClickOrChange:this.onScheduleChange}),r.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},b),r.default.createElement("span",{className:"ax-visually-hidden"},l?y:d),!l&&r.default.createElement("div",{"aria-hidden":"true",className:_},v),this.props.useAUTaxInclusivePricing&&r.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},l?g:f))},t.prototype.renderMonthlyPlanBlock=function(){var e=this,t=this.props.formData.scheduleId.formattedValue,a=this.getPricingStrings(),n=a.monthlyPrice,l=a.monthlyPriceAx,u=a.monthlyGstIncluded,c=r.default.createElement("span",{id:"plan-info__label--monthly",className:"plan-info__label plan-info__label--monthly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.MONTHLY)},"aria-hidden":"true"},o.intl.formatMessage({id:"Fb6V6v",defaultMessage:"Billed Monthly"}));return r.default.createElement("div",{className:"plan-info__choice plan-info__monthly"},r.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--monthly",ariaLabelId:"plan-info__label--monthly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.MONTHLY.toString(),checked:t===i.ScheduleId.MONTHLY,labelSpan:c,onClickOrChange:this.onScheduleChange}),r.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},n),r.default.createElement("span",{className:"ax-visually-hidden"},l),this.props.useAUTaxInclusivePricing&&r.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},u))},t.prototype.render=function(){var e=this.props.paymentSchedule;return e&&"yearly"===e?r.default.createElement("div",{className:"grid__container plan-info"},this.renderYearlyPlanBlock()):e&&"monthly"===e?r.default.createElement("div",{className:"grid__container plan-info"},this.renderMonthlyPlanBlock()):r.default.createElement("div",{className:"grid__container plan-info"},this.renderYearlyPlanBlock(),r.default.createElement("div",{className:"plan-info__spacer"}),this.renderMonthlyPlanBlock())},t})(r.default.Component);t.ScheduleSelection=l}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,r){void 0===r&&(r=a),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,r){void 0===r&&(r=a),e[r]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t};define("modules/clean/react/payments/buy/components/payments/async_sox_compliance_warning",["require","exports","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSOXComplianceBanner=void 0,t.AsyncSOXComplianceBanner=a.Loadable({loader:function(){return r.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/payments/buy/components/payments/sox_compliance_warning"],t,a)})).then(__importStar).then((function(e){return e.SOXComplianceBanner}))}))}})})),define("modules/clean/react/payments/buy/components/payments/buy_payment_info_section",["require","exports","tslib","react","classnames","modules/clean/react/tooltip","modules/clean/react/image","modules/clean/static_urls","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/validation","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/buy/components/payments/ideal_form","modules/clean/react/payments/buy/components/payments/payment_method_selector","modules/clean/react/payments/buy/components/payments/cpf_tooltip","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/react/payments/checkout/components/payment_method_form/address_form","modules/core/exception","dig-components/icons/src","dig-components/icons"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h,y,g,_,v,P,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentInfoSection=void 0,r=a.__importDefault(r),n=a.__importDefault(n),v=a.__importStar(v);var S=(function(t){function S(){var r=null!==t&&t.apply(this,arguments)||this;return r.createPaypalBtn=function(){var t=r.props.braintreeClientToken?r.props.braintreeClientToken:"",n=r.props.actions.updatePayPalNonce;Promise.all([new Promise((function(t,a){e(["braintree-web"],t,a)})).then(a.__importStar),new Promise((function(t,a){e(["paypal-api-checkout"],t,a)})).then(a.__importStar)]).then((function(e){var a=e[0],r=e[1].default,o=a.client,i=a.paypalCheckout;o.create({authorization:t},(function(e,t){if(e)v.reportException({err:new Error("Error creating Braintree client: "+e),severity:v.SEVERITY.CRITICAL});else{var a=r;i.create({client:t},(function(e,t){e?v.reportException({err:new Error("Error creating PayPal Checkout: "+e),severity:v.SEVERITY.CRITICAL}):a.Button.render({env:"production",style:{color:"gold",height:35,label:"paypal",shape:"rect",size:"responsive",tagline:!1},funding:{allowed:[a.FUNDING.CARD],disallowed:[a.FUNDING.CREDIT]},payment:function(){return t.createPayment({flow:"vault",enableShippingAddress:!1})},onAuthorize:function(e,a){return t.tokenizePayment(e,(function(e,t){n(t.nonce,t.details.email)}))},onCancel:function(e){},onError:function(e){v.reportException({err:new Error("PayPal Checkout error: "+e),severity:v.SEVERITY.CRITICAL})}},"#paypal-button").then((function(){}))}))}}))}))},r.clearPayPalNonce=function(e){e.preventDefault(),r.props.actions.updatePayPalNonce("","")},r.onVatBlur=function(e){r.props.actions.showFormFieldErrors(["vat"],"VatBlur"),r.props.actions.blurVat(e.value)},r.onVatChange=function(e){r.props.actions.updateVat(e.value)},r.onCpfBlur=function(e){r.props.actions.showFormFieldErrors(["cpf"],"CpfBlur"),r.props.actions.blurCpf(e.value)},r.onCpfChange=function(e){r.props.actions.updateCpf(e.value)},r}return a.__extends(S,t),S.prototype.componentDidMount=function(){this.props.actions.updateHistory&&this.props.actions.updateHistory(),"ON"===this.props.paymentPayPalV2Flow&&this.props.braintreeClientToken&&this.createPaypalBtn(),this.props.price&&this.props.planNamePrefixedWithDropbox||this.props.paymentSpec.hide_apple_pay()},S.prototype.prepareForSubmission=function(){var e=this.props.formData.paymentMethod;if(e.formattedValue===l.PaymentMethod.CreditCard)return this.creditCardFrame.tokenize();if(e.formattedValue===l.PaymentMethod.ApplePay&&this.props.planNamePrefixedWithDropbox&&this.props.price){var t={planName:this.props.planNamePrefixedWithDropbox,price:this.props.price};return this.props.actions.applePayAction(t)}return Promise.resolve(!0)},S.prototype.getCreditCardFrame=function(){return this.creditCardFrame},S.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!d.FormValueHelper.isValid(e)&&e.showError?c.intl.formatMessage({id:"iRjYtd",defaultMessage:"Please enter a valid VAT number (ex: {examples})."},{examples:u.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},S.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!d.FormValueHelper.isValid(e)&&e.showError?c.intl.formatMessage({id:"MQDRWx",defaultMessage:"Please enter a valid CPF number."}):""},S.prototype.renderLocationFields=function(){return r.default.createElement("div",{className:"grid__item"},r.default.createElement(_.AddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList}),this.renderVatFields(),this.renderCpfInput())},S.prototype.renderVatFields=function(){var e=this.props,t=e.formData,a=e.paymentSpec,o=e.vatEnabled,i=null;if(a.should_show_vat_for_country(t.countryCode.formattedValue)&&o){var s=t.vat.errorState&&t.vat.showError,l=u.getVatPrefix(t.countryCode.formattedValue),m=n.default({"payment-info__vat-input":!0,"payment-info__vat-input--valid":""!==t.vat.formattedValue&&d.FormValueHelper.isValid(t.vat)});i=r.default.createElement(p.LabeledTextInput,{className:"payment-info__vat",inputClassName:m,containerClassName:"grid__item vat-container",name:"vat",labelText:c.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),placeholder:l,hasError:Boolean(s),value:t.vat.rawValue,onBlur:this.onVatBlur,onChange:this.onVatChange,errorText:this.vatErrorString()})}return i},S.prototype.renderCpfInput=function(){var e=null;if(this.props.paymentSpec.should_require_cpf(this.props.formData.countryCode.formattedValue,this.props.formData.paymentMethod.formattedValue)){var t=this.props.formData.cpf.errorState&&this.props.formData.cpf.showError,a=n.default({"payment-info__cpf-input":!0,"payment-info__cpf-input--valid":""!==this.props.formData.cpf.formattedValue&&d.FormValueHelper.isValid(this.props.formData.cpf)}),l=r.default.createElement("span",null,c.intl.formatMessage({id:"Z1BdZ2",defaultMessage:"CPF/CNPJ"}),r.default.createElement(o.Tooltip,{position:o.TooltipPosition.RIGHT,tooltip_contents:r.default.createElement(h.CPFTooltip,null),is_focusable:!0},r.default.createElement(i.Image,{className:"cpf-tooltip-icon",src:s.static_url("/static/images/payments/buy/rebrand-info-vflRPzJtZ.png"),srcHiRes:s.static_url("/static/images/payments/buy/rebrand-info@2x-vflc1SGxi.png"),alt:c.intl.formatMessage({id:"+SX5vq",defaultMessage:"More information"}),width:15,height:15}))),u=c.intl.formatMessage({id:"+9XYcz",defaultMessage:"e.g. 100.001.101-00"});e=r.default.createElement("div",{className:"grid__item"},r.default.createElement(p.LabeledTextInput,{className:"",inputClassName:a,containerClassName:"grid__item payment-info__cpf",name:"cpf",labelText:l,hasError:Boolean(t),value:this.props.formData.cpf.rawValue,onBlur:this.onCpfBlur,onChange:this.onCpfChange,placeholder:u,errorText:this.cpfErrorString()}))}return e},S.prototype.renderPaymentMethodSelector=function(){var e=this.props,t=e.paymentSpec,a=e.formData,n=e.showTrialVersion;return r.default.createElement(f.PaymentMethodSelector,{paymentSpec:t,paymentMethod:a.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:a.countryCode.rawValue,zipCode:a.zipCode.rawValue,showTrialVersion:n,fullWidth:!1})},S.prototype.paymentTokenConnectDetailsText=function(){return c.intl.formatMessage({id:"dIi5ZR",defaultMessage:"Your payment method has been pre-configured through your bank."})},S.prototype.renderPaymentTokenConnectDetailsText=function(){var e=null;return null!=this.props.paymentSpec.spec.token_connect_prefill_data&&(e=r.default.createElement("p",null,r.default.createElement("small",null,this.paymentTokenConnectDetailsText()))),e},S.prototype.render=function(){var e=this,t=this.props,a=t.actions,n=t.formData,o=t.idealBanks,i=this.renderLocationFields(),s=i;n.paymentMethod.formattedValue===l.PaymentMethod.DirectDeposit?s=r.default.createElement(g.DirectDebitForm,{locationFields:i,formData:n,actions:a}):n.paymentMethod.formattedValue===l.PaymentMethod.Ideal&&(s=r.default.createElement(m.IdealForm,{locationFields:i,formData:n,actions:a,idealBanks:o}));var u,p;return"ON"===this.props.paymentPayPalV2Flow&&(u=r.default.createElement("span",{className:"paypal-button-container",hidden:n.paymentMethod.formattedValue!==l.PaymentMethod.PayPal},r.default.createElement("span",{className:"paypal-button-start",hidden:""!==n.payPalNonce.formattedValue},r.default.createElement("label",{className:"input__label"},c.intl.formatMessage({id:"Xkz5XK",defaultMessage:"Sign into PayPal to continue with this payment method:"})),r.default.createElement("div",{id:"paypal-button"})),r.default.createElement("span",{className:"paypal-button-end",hidden:""===n.payPalNonce.formattedValue},r.default.createElement("span",{id:"paypal-button-account-email"},n.payPalNonce.email),r.default.createElement("br",null),r.default.createElement("a",{href:"#",onClick:this.clearPayPalNonce},c.intl.formatMessage({id:"TFnOYM",defaultMessage:"Change PayPal account"}))),r.default.createElement("span",{hidden:!1===n.payPalNonce.showError},r.default.createElement("label",{className:"input__label--error"},c.intl.formatMessage({id:"3z459e",defaultMessage:"Please select your PayPal account."}))))),this.props.paymentBannerError&&(p=r.default.createElement("div",{className:"payment-error-div payment-info grid__container inline-errors"},r.default.createElement("div",{className:"grid__item--fluid",style:{maxWidth:"30px",marginRight:"5px",marginLeft:"5px"}},r.default.createElement(b.UIIcon,{src:P.WarningLine,size:"large"})),r.default.createElement("div",{className:"grid__item--fluid grid__item--margin-right--1-24 payment-error-text"},this.props.paymentBannerError))),r.default.createElement("div",{id:"payment-info",className:"payment-info grid__container inline-errors"},this.renderPaymentTokenConnectDetailsText(),p,this.renderPaymentMethodSelector(),r.default.createElement("div",{className:"grid__item grid__item--large--11-12"},r.default.createElement(y.CreditCardFrame,{iframeUrl:this.props.iframeUrl,hidden:n.paymentMethod.formattedValue!==l.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){e.creditCardFrame=t},nonce:n.nonce,bin:n.bin,submitForm:this.props.submitForm,getHeightFromIframe:!0}),u,s))},S})(r.default.Component);t.PaymentInfoSection=S})),define("modules/clean/react/payments/buy/components/payments/cpf_tooltip",["require","exports","tslib","react","modules/core/i18n"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CPFTooltip=void 0;var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=n.intl.formatMessage({id:"1ONP6O",defaultMessage:"The Cadastro de Pessoas Físicas (CPF) is the the Brazilian individual taxpayer registry identification number. It has 11 digits and can be found on your CPF card. It consists of numbers, dots and a dash, as in the following example: 100.001.101-00."}),t=n.intl.formatMessage({id:"VsWgR6",defaultMessage:"The Cadastro Nacional da Pessoa Jurídica, or most commonly known as CNPJ, is a number that identifies legal entities and other legal arrangements at the Federal Revenue Service of Brazil. It has functions similar to those of the CPF, the only difference being that it is unique to the use of legal entities. It is a 14-digit number with a certain format, like in the following example: 00.000.000/0001-00"});return r.default.createElement("div",{className:"cpf-tooltip-contents"},r.default.createElement("p",{className:"cpf-tooltip-contents__header"},n.intl.formatMessage({id:"b1XaAp",defaultMessage:"What is CPF?"})),r.default.createElement("p",null,e),r.default.createElement("p",{className:"cpf-tooltip-contents__header"},n.intl.formatMessage({id:"grlpui",defaultMessage:"What is CNPJ?"})),r.default.createElement("p",null,t))},t})((r=a.__importDefault(r)).default.Component);t.CPFTooltip=o})),define("modules/clean/react/payments/buy/components/payments/marketing_opt_in",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarketingOptIn=void 0;var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggleMarketingOptIn=function(e){var a=t.props.formData.marketingOptIn.rawValue;t.props.actions.updateMarketingOptIn(!a)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.formData,a=e.isCreatingNewAccount,i=e.showMarketingOptInIfNewAccount,s=n.intl.formatMessage({id:"vRE9NS",defaultMessage:"I’d like to receive direct marketing email updates from Dropbox"}),l=r.default.createElement("span",{className:"type--copy-small"},s);return i&&a?r.default.createElement(o.LabeledCheckboxInput,{checked:t.marketingOptIn.rawValue,containerClassName:"grid__item marketing_opt_in",className:"billing-marketing-opt-in",labelText:l,name:"marketing_opt_in",onClick:this.toggleMarketingOptIn}):null},t})((r=a.__importDefault(r)).default.Component);t.MarketingOptIn=i})),define("modules/clean/react/payments/buy/components/promos/promo_banner",["require","exports","tslib","react","dig-components/banner","modules/clean/react/growth_pages/promo/types","modules/core/i18n","modules/clean/react/css","modules/clean/ts_utils"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromoBanner=void 0,r=a.__importDefault(r);var u=function(e,t,a){return i.intl.formatMessage({id:"jyiB1b",defaultMessage:"{count, plural, one{<strong>Try {dropbox_plan} for free for {count} day</strong> when you sign up by {expiration_date}*.} other{<strong>Try {dropbox_plan} for free for {count} days</strong> when you sign up by {expiration_date}*.}}"},{count:e.trialLength||0,dropbox_plan:t,expiration_date:a,strong:function(e){return r.default.createElement("strong",{key:"important-message-snippet"},e)}})},c=function(e,t,a){return i.intl.formatMessage({id:"iXgIdV",defaultMessage:"Get <strong>{free_months} months free</strong> with your first year of {dropbox_plan}*. This offer expires on {expiration_date}."},{dropbox_plan:t,free_months:e.freeMonths,expiration_date:a,strong:function(e){return r.default.createElement("strong",{key:"important-message-snippet"},e)}})},p=function(e,t,a){var n=e.monthsToUse,o={dropbox_plan:t,discount:e.discountPercentage/100,numMonths:n,expiration_date:a,strong:function(e){return r.default.createElement("strong",{key:"important-message-snippet"},e)}};return e.disallowMonthly?i.intl.formatMessage({id:"eWHzIE",defaultMessage:"<strong>Get {discount, number, ::percent .##} off</strong> {numMonths, plural, one{# month} other{# months}} of {dropbox_plan} when billed yearly*. This offer expires on {expiration_date}."},o):i.intl.formatMessage({id:"V3Sp4n",defaultMessage:"<strong>Get {discount, number, ::percent .##} off</strong> {numMonths, plural, one{# month} other{# months}} of {dropbox_plan}*. This offer expires on {expiration_date}."},o)},d=function(e,t,a){var n=e.monthsToUse,o={dropbox_plan:t,discount:e.discountPercentage/100,numYears:n?n/12:0,expiration_date:a,strong:function(e){return r.default.createElement("strong",{key:"important-message-snippet"},e)}};return e.disallowMonthly?i.intl.formatMessage({id:"kzTnND",defaultMessage:"<strong>Get {discount, number, ::percent .##} off</strong> {numYears, plural, one{# year} other{# years}} of {dropbox_plan} when billed yearly*. This offer expires on {expiration_date}."},o):i.intl.formatMessage({id:"TAK0SD",defaultMessage:"<strong>Get {discount, number, ::percent .##} off</strong> {numYears, plural, one{# year} other{# years}} of {dropbox_plan}*. This offer expires on {expiration_date}."},o)};t.PromoBanner=s.requireCssWithComponent((function(e){var t=(function(e,t){var a=e.expirationDate.replace(/-/g,"/"),r=i.intl.formatDate(new Date(a),{year:"numeric",month:"long",day:"numeric"}),n=u,s=c,m=p,f=d;switch(e.id){case o.PromoSpecType.EXTRA_TIME_MONTHS:return s(e,t,r);case o.PromoSpecType.PERCENT_DISCOUNT_PRETAX:return e.monthsToUse&&e.monthsToUse%12==0?f(e,t,r):m(e,t,r);case o.PromoSpecType.TRIAL:return n(e,t,r);case o.PromoSpecType.EXPERIMENTAL_PLAN:case o.PromoSpecType.NOT_APPLICABLE:return null;default:l.enforceExhaustive(e.id)}})(e.promoSpec,e.fullPlanName);return t?r.default.createElement("div",{className:"promo-banner","data-testid":"promo-banner"},r.default.createElement(n.Banner,{type:"attention"},r.default.createElement(n.Banner.Message,null,t))):null}),["/static/css/dig-components/index.web-vflGkDgJo.css"])})),define("modules/clean/react/payments/buy/components/payments/order_summary/order_summary",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/payments/buy/components/payments/marketing_opt_in","modules/clean/react/payments/buy/components/payments/tos","modules/clean/react/rebrand/elements/rebrand_buttons","modules/core/browser","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils","modules/clean/react/payments/buy/types/types","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrderSummarySubmitButton=t.TrialGoToBuyLink=t.OrderSummaryErrors=t.OrderSummaryFreeMonths=t.OrderSummaryTotalPrice=t.OrderSummaryWithheldTaxes=t.OrderSummaryTaxes=t.CardTop=t.OrderSummary=void 0,r=a.__importStar(r),n=a.__importDefault(n),u=a.__importStar(u),t.OrderSummary=function(e){var a=e.actions,l=e.additionalTermsOfService,p=e.currentTransitionPrices,d=e.formData,h=e.formVariant,y=e.isLoadingPrices,g=e.onClick,_=e.pageState,v=e.planColor,P=e.planNamePrefixedWithDropbox,b=e.showMarketingOptInIfNewAccount,S=e.showTrialVersion,C=e.taxNamesByCountry,E=e.buyLink,T=e.showPromoLegalCopy,N=r.useCallback((function(){c.ProEventsLogger.log("clicked_buy_directly_cta",{}),u.redirect(E)}),[E]),w=S?o.intl.formatMessage({id:"ymP1f5",defaultMessage:"Start your free trial"}):o.intl.formatMessage({id:"4oMxy9",defaultMessage:"Buy now"}),F=h===m.FormVariant.COLUMN,k=p.totalPrice,I=p.currency;return r.default.createElement("div",{className:"order-summary grid__container"},!F&&r.default.createElement(t.CardTop,{planColor:v}),r.default.createElement("div",{className:n.default("grid__item",{"order-summary__card":!F,"order-summary__card-no-border":F})},r.default.createElement("div",{className:"order-summary__plan-name grid__item"},P),r.default.createElement("div",{className:"order-summary__line-items grid__item"},r.default.createElement(t.OrderSummaryTaxes,{showTrialVersion:S,taxNamesByCountry:C,currentTransitionPrices:p}),r.default.createElement(t.OrderSummaryWithheldTaxes,{taxNamesByCountry:C,currentTransitionPrices:p}),k&&r.default.createElement(t.OrderSummaryTotalPrice,{totalPrice:k,showTrialVersion:S}),r.default.createElement(t.OrderSummaryFreeMonths,{promoSpec:_.promoSpec,scheduleId:d.scheduleId.formattedValue})),k&&I&&r.default.createElement(s.TermsOfService,{actions:a,currency:I,formData:d,totalPrice:k.formatCurrency(),showTrialVersion:S,showPromoLegalCopy:T,additionalTermsOfService:l}),r.default.createElement(i.MarketingOptIn,{formData:d,actions:a,showMarketingOptInIfNewAccount:b,isCreatingNewAccount:!_.existingAccountShowing}),r.default.createElement(t.OrderSummarySubmitButton,{isProcessing:y||_.submitting,buttonText:w,onClick:g,isApplePay:d.paymentMethod.rawValue===f.PaymentMethod.ApplePay}),S&&r.default.createElement(t.TrialGoToBuyLink,{isLoading:y,isSubmitting:_.submitting,planNamePrefixedWithDropbox:P,onClickRedirectToBuy:N}),_.showBuyClickError&&r.default.createElement(t.OrderSummaryErrors,null)))},t.CardTop=function(e){var t=e.planColor;return r.default.createElement("div",{className:n.default("card-top","grid__item",d.getCardTopColorClassName(t))})},t.OrderSummaryTaxes=function(e){var t=e.showTrialVersion,a=e.currentTransitionPrices,i=e.taxNamesByCountry,s=a.taxPercentage,l=a.taxAmount,u=a.taxCountryCode;if(!(l&&l.amount&&s&&s>0))return null;var c=d.getTaxNameForCountry(u,i);return r.default.createElement("div",{key:c,className:"order-summary__tax grid__item"},o.intl.formatMessage({id:"uyZR7V",defaultMessage:"{tax_name} ({tax_percent}):{space}<span>{tax_amount}</span>"},{space:" ",span:function(e){return r.default.createElement("span",{className:n.default("order-summary__tax_amount",{"order-summary__strike":t})},e)},tax_name:c,tax_percent:o.intl.formatNumber(s/100,{style:"percent",maximumFractionDigits:2}),tax_amount:l.toString()}))},t.OrderSummaryWithheldTaxes=function(e){var t=e.taxNamesByCountry,a=e.currentTransitionPrices,n=a.withheldTaxAmount,i=a.withheldTaxPercentage,s=a.taxCountryCode;return n&&n.amount&&i&&i>0?r.default.createElement("div",{className:"order-summary__withheld_tax grid__item"},o.intl.formatMessage({id:"E8kLRO",defaultMessage:"Withheld {tax_name} ({tax_percent, number, ::percent .##}): {tax_amount}"},{tax_name:d.getTaxNameForCountry(s,t),tax_percent:i/100,tax_amount:n.toString()})):null},t.OrderSummaryTotalPrice=function(e){var t=e.totalPrice,n=e.showTrialVersion,i=t.toString(),s=o.intl.formatMessage({id:"QgQyq4",defaultMessage:"Billed Now: {total_price}"},{total_price:i}),l={strike:function(e){return r.default.createElement("span",{className:"order-summary__strike order-summary__padding-left"},e)},free:function(e){return r.default.createElement("span",{className:"order-summary__free-price order-summary__padding-left"},e)}},u=o.intl.formatMessage({id:"/tcn5z",defaultMessage:"Charged Now: <strike>{total_price}</strike> <free>FREE</free>"},a.__assign(a.__assign({},l),{total_price:i}));return r.default.createElement("div",{className:"order-summary__price grid__item"},n?u:s)},t.OrderSummaryFreeMonths=function(e){var t=e.promoSpec,a=e.scheduleId;return t&&Boolean(t.freeMonths)&&a===p.ScheduleId.YEARLY?r.default.createElement("div",{className:"promo-highlight"},o.intl.formatMessage({id:"UVyMNH",defaultMessage:"<span>+ {free_months} months free</span> with your first year"},{free_months:t.freeMonths,span:function(e){return r.default.createElement("span",null,e)}})):null},t.OrderSummaryErrors=function(){return r.default.createElement("p",{className:"form-error form-error--enabled","aria-live":"assertive"},o.intl.formatMessage({id:"Ftg4vm",defaultMessage:"Please correct the form errors and try again"}))},t.TrialGoToBuyLink=function(e){var t=e.isLoading,a=e.isSubmitting,i=e.planNamePrefixedWithDropbox,s=e.onClickRedirectToBuy,l=t||a;return r.default.createElement("button",{className:n.default("button-as-link","order-summary__button","order-summary__buy-button","grid__item",{"order-summary__buy-button-disabled":l}),onClick:s,"data-uxa-log":"order-summary-go-to-buy"},o.intl.formatMessage({id:"bg2sx0",defaultMessage:"Or buy {plan} now"},{plan:i}))},t.OrderSummarySubmitButton=function(e){var t=e.isProcessing,a=e.buttonText,o=e.onClick,i=e.isApplePay,s=n.default("button--submit","order-summary__button","grid__item",{"button--loading":t}),u=a;if(t)u=r.default.createElement("div",{className:"loader"},r.default.createElement("span",{className:"loader__dot"}),r.default.createElement("span",{className:"loader__dot"}),r.default.createElement("span",{className:"loader__dot"}));else if(i)return r.default.createElement("button",{className:"apple-pay-button-with-text apple-pay-button-black-with-text",onClick:o,"data-uxa-log":"order-summary-submit-button","aria-label":"Buy now",type:"submit"},r.default.createElement("span",{className:"text"},u),r.default.createElement("span",{className:"logo"}));return r.default.createElement(l.RebrandButton,{ariaLabel:a,importance:"primary",size:"medium",type:"submit",className:s,onClick:o,disabled:t,"data-uxa-log":"order-summary-submit-button"},u)}})),define("modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils",["require","exports","tslib","modules/core/i18n","modules/core/exception"],(function(e,t,a,r,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.getCardTopColorClassName=t.PlanColor=t.CardTopClassName=t.getTaxNameForCountry=void 0,n=a.__importStar(n),t.getTaxNameForCountry=function(e,t){return t&&e&&t[e]?t[e]:r.intl.formatMessage({id:"dytYFt",defaultMessage:"Tax"})},(function(e){e.BLUE="card-top--blue",e.BLACK="card-top--black"})(o=t.CardTopClassName||(t.CardTopClassName={})),(function(e){e.BLUE="blue",e.BLACK="black"})(i=t.PlanColor||(t.PlanColor={}));var s=new Map([[i.BLACK,o.BLACK],[i.BLUE,o.BLUE]]);t.getCardTopColorClassName=function(e){return s.has(e)?s.get(e):(n.reportException({err:new Error("Unsupported checkout page plan color "+e),severity:n.SEVERITY.CRITICAL}),o.BLACK)}})),define("modules/clean/react/payments/buy/components/payments/worldpay_entity_info",["require","exports","tslib","react"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorldPayEntityInfo=void 0;var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement("div",{className:"grid__container payment-entity-info__text"},r.default.createElement("p",null,"Dropbox International Unlimited Company",r.default.createElement("br",null),"One Park Place / Hatch Street Upper / Dublin 2 / Ireland"))},t})((r=a.__importDefault(r)).default.Component);t.WorldPayEntityInfo=n})),define("modules/clean/react/payments/buy/components/plan/plan_selection",["require","exports","tslib","react","modules/clean/react/payments/buy/types/types","modules/clean/react/payments/buy/components/plan/plan_block"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlanSelection=void 0;var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePlanChange=function(e,a,r){var n=t.props,o=n.locale,i=n.productPlanType,s=n.actions.updateSelectedPlan;i!==e&&s(e,a,o,r)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultPlan,a=e.supportedProducts,i=e.productPlanType,s=e.showPlanNameUnderRadio,l=e.userIsEligibleForProfessionalTrial;return t===n.CheckoutPageProductPlan.PLUS?r.default.createElement("div",{className:"grid__container plan-info"},r.default.createElement(o.PlusPlanBlock,{showTrialVersion:!1,showPlanNameUnderRadio:s,supportedProducts:a,handlePlanChange:this.handlePlanChange,selectedProductPlanType:i}),r.default.createElement("div",{className:"plan-info__spacer"}),r.default.createElement(o.ProfessionalPlanBlock,{showTrialVersion:l,showPlanNameUnderRadio:s,supportedProducts:a,handlePlanChange:this.handlePlanChange,selectedProductPlanType:i})):null},t})((r=a.__importDefault(r)).default.Component);t.PlanSelection=i})),define("modules/clean/react/payments/buy/components/plan/plan_block",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs","modules/constants/trademark","modules/clean/react/payments/buy/types/types"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlusPlanBlock=t.ProfessionalPlanBlock=t.getTrialDurationString=t.PlanBlock=void 0,r=a.__importDefault(r);t.PlanBlock=function(e){var a=e.planName,n=e.productPlanType,o=e.selectedProductPlanType,s=e.ariaLabelId,l=e.inputId,u=e.quotaString,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.trialDuration,m=e.advertisedTrialDuration,f=e.planInfoChoiceClass,h=e.planInfoLabelClass,y=e.planInfoSubtitleClass,g=e.handlePlanChange,_=r.default.createElement("span",{id:s,className:"plan-info__label plan-info__label--bold "+h,onClick:function(){g(n,d||0,c)},"aria-hidden":"true"},u),v=p&&a;return r.default.createElement("div",{className:"plan-info__choice "+f},r.default.createElement(i.LabeledRadioInput,{name:"plan_id",inputId:l,ariaLabelId:s+(v?" plan-info-subtitle-plan-name":"")+(c?" plan-info-subtitle-trial":""),className:"plan-info__radio",labelClassName:"plan-info__container",value:n.toString(),checked:n===o,labelSpan:_,onClickOrChange:function(e,t,a){var r=e.currentTarget;a=a||r.value;var n=parseInt(a,10);g(n,d||0,c)}}),v&&r.default.createElement("div",{id:"plan-info-subtitle-plan-name",className:"plan-info__subtitle "+y},a),c&&r.default.createElement("div",{id:"plan-info-subtitle-trial",className:"plan-info__subtitle plan-info__subtitle--green"},t.getTrialDurationString(m||d)))},t.getTrialDurationString=function(e){return void 0!==e?n.intl.formatMessage({id:"H8xyuK",defaultMessage:"Try free for {pro_trial_days} days"},{pro_trial_days:e}):""},t.ProfessionalPlanBlock=function(e){var a,n,i=e.supportedProducts,u=e.selectedProductPlanType,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.handlePlanChange,m=null===(n=null===(a=i[l.CheckoutPageProductPlan.PROFESSIONAL])||void 0===a?void 0:a.trialInfo)||void 0===n?void 0:n.trialDuration;return r.default.createElement(t.PlanBlock,{planName:"Dropbox "+s.TRADEMARK_PROFESSIONAL,productPlanType:o.ProductPlanType.PROFESSIONAL,selectedProductPlanType:u,ariaLabelId:"plan-info__label--pro",inputId:"plan-info__radio--pro",quotaString:i[l.CheckoutPageProductPlan.PROFESSIONAL].quota,showTrialVersion:c,showPlanNameUnderRadio:p,trialDuration:m,advertisedTrialDuration:31===m?30:void 0,planInfoChoiceClass:"plan-info__pro",planInfoLabelClass:"plan-info__label--pro",planInfoSubtitleClass:"plan-info__subtitle--pro",handlePlanChange:d})},t.PlusPlanBlock=function(e){var a,n,i=e.supportedProducts,u=e.selectedProductPlanType,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.handlePlanChange,m=null===(n=null===(a=i[l.CheckoutPageProductPlan.PLUS])||void 0===a?void 0:a.trialInfo)||void 0===n?void 0:n.trialDuration;return r.default.createElement(t.PlanBlock,{planName:"Dropbox "+s.TRADEMARK_PLUS,productPlanType:o.ProductPlanType.PLUS,selectedProductPlanType:u,ariaLabelId:"plan-info__label--plus",inputId:"plan-info__radio--plus",quotaString:i[l.CheckoutPageProductPlan.PLUS].quota,showTrialVersion:c,showPlanNameUnderRadio:p,trialDuration:m,planInfoChoiceClass:"plan-info__plus",planInfoLabelClass:"plan-info__label--plus",planInfoSubtitleClass:"plan-info__subtitle--plus",handlePlanChange:d})}})),define("modules/clean/react/payments/buy/helpers/pricing_value_helper",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,a){"use strict";function r(e,t,a,r){return e.filter((function(e){var n=e.finalSubState.plan,o=e.finalSubState.billingSchedule,i=!!e.finalSubState.addons.skus.length;return n&&n.productType===t&&o&&o.id===a&&i===r})).pop()}Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTransitionPrices=t.getDisplayPrices=void 0,t.getDisplayPrices=function(e,t,n){var o,i,s,l,u,c;if(e){var p=r(e,t.productPlanType.formattedValue,a.ScheduleId.MONTHLY,!1),d=r(e,t.productPlanType.formattedValue,a.ScheduleId.YEARLY,!1),m=void 0,f=void 0;if(n?(d&&(o=(m=d.tvm).getTotalPrice(),l=m.getBilledPrice()),p&&(i=(f=p.tvm).getTotalPrice(),u=f.getBilledPrice())):(d&&(o=d.nextBillingSummary.base,l=d.nextBillingSummary.total),p&&(i=p.nextBillingSummary.base,u=p.nextBillingSummary.total)),o&&i){var h=i.multiply(12).subtract(o);s=h.amount>0?h:void 0}if(l&&u){var y=u.multiply(12).subtract(l);c=y.amount>0?y:void 0}}return{yearlyPrice:o,monthlyPrice:i,yearlySavings:s,taxInclusiveYearlyPrice:l,taxInclusiveMonthlyPrice:u,taxInclusiveYearlySavings:c}},t.getCurrentTransitionPrices=function(e,t){var a,n,o,i,s,l,u,c;if(e&&(a=r(e,t.productPlanType.formattedValue,t.scheduleId.formattedValue,!!t.evh.rawValue)),a&&a.tvm){var p=a.tvm;n=p.getTotalPrice(),o=p.getTaxCountryCode(),i=p.getTaxPercentage(),s=p.getTaxPrice(),l=p.getCurrency(),u=p.getTotalTaxWithheld(),c=p.getWithheldTaxPercentage()}return{totalPrice:n,taxCountryCode:o,taxPercentage:i,taxAmount:s,currency:l,withheldTaxAmount:u,withheldTaxPercentage:c}}})),define("modules/clean/react/payments/buy/components/payments/ideal_form",["require","exports","tslib","react","modules/clean/react/payments/buy/components/inputs/inputs","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdealForm=void 0;var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIdealBankChange=function(e){var a=e.value,r=t.props.idealBanks[a];t.props.actions.updateIdealBank({bankId:a,bankName:r})},t.onIdealBankBlur=function(e){t.props.actions.showFormFieldErrors(["idealBankId"],"IdealBankBlur")},t.idealErrorString=function(){var e=t.props.formData.idealBankId;return!i.FormValueHelper.isValid(e)&&e.showError?o.intl.formatMessage({id:"Lly4lc",defaultMessage:"Please select your bank."}):""},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.formData,a=e.idealBanks,i=o.intl.formatMessage({id:"4MQHjO",defaultMessage:"Note: We’ll use your bank information provided by iDEAL for all future billing cycles. If your bank is not listed, then please select a different payment method."}),s=t.idealBankId.errorState&&t.idealBankId.showError,l=this.idealErrorString();return r.default.createElement("div",{className:"ideal-container"},r.default.createElement("div",{className:"ideal-fields"},r.default.createElement(n.LabeledSelectInput,{name:"ideal_bank",labelText:o.intl.formatMessage({id:"nomYjM",defaultMessage:"Bank"}),value:t.idealBankId.rawValue,onChange:this.onIdealBankChange,onBlur:this.onIdealBankBlur,hasError:Boolean(s),errorText:l},r.default.createElement("option",{value:"",key:"default","aria-selected":""===t.idealBankId.rawValue},o.intl.formatMessage({id:"EYb0mR",defaultMessage:"Select your bank..."})),Object.keys(a).map((function(e){return r.default.createElement("option",{value:e,key:e,"aria-selected":t.idealBankId.rawValue===e},a[e])})))),this.props.locationFields,r.default.createElement("div",{className:"ideal-note"},i))},t})((r=a.__importDefault(r)).default.Component);t.IdealForm=s})),define("modules/clean/react/payments/buy/components/payments/payment_method_input",["require","exports","tslib","react","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodInput=void 0,r=a.__importDefault(r),n=a.__importDefault(n);var s=(function(e){function t(t){var a=e.call(this,t)||this;return a.focus=function(){null!==a.labeledRadioInput.current&&a.labeledRadioInput.current.focus()},a.onChange=function(){a.props.onSelected(a.props.paymentMethod)},a.getPaymentMethodId=function(e){switch(e){case o.PaymentMethod.CreditCard:return"creditcard";case o.PaymentMethod.PayPal:return"paypal";case o.PaymentMethod.Ideal:return"ideal";case o.PaymentMethod.DirectDeposit:return"debit";case o.PaymentMethod.TokenConnect:return"token_connect";case o.PaymentMethod.ApplePay:return"applepay";default:return e}},a.labeledRadioInput=r.default.createRef(),a}return a.__extends(t,e),t.prototype.render=function(){var e=this.getPaymentMethodId(this.props.paymentMethod);return r.default.createElement("div",{className:n.default({"payment-info__option":!0,"full-width":this.props.fullWidth,"no-margin-bottom":this.props.noMarginBottom,"grid__item--expand":this.props.fullWidth,"grid__item--shrink":!this.props.fullWidth,"grid--y-middle":!0,"cc-payment-radio-selenium":this.props.paymentMethod===o.PaymentMethod.CreditCard})},r.default.createElement(i.LabeledRadioInput,{ref:this.labeledRadioInput,name:this.props.name,className:"payment-info__payment",inputId:"payment-method-radio#"+e,ariaLabelId:"payment-method-label#"+e,value:this.props.paymentMethod.toString(),checked:this.props.selected,onClickOrChange:this.onChange,labelSpan:r.default.createElement(l,{id:e,textTitle:this.props.textTitle,title:this.props.title,icons:this.props.icons,onClick:this.onChange,cc_last4:this.props.cc_last4})}))},t})(r.default.Component);t.PaymentMethodInput=s;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.renderCCLast4=function(){var e=null;return null!=this.props.cc_last4&&(e=r.default.createElement("span",null,r.default.createElement("b",null,this.props.cc_last4))),e},t.prototype.render=function(){var e,t=this;return r.default.createElement("span",{className:"payment-info__method-label",onClick:this.props.onClick},r.default.createElement("span",{id:"payment-method-label#"+this.props.id,"aria-hidden":"true",className:n.default((e={"ax-visually-hidden":this.props.icons},e[this.props.id]=!this.props.icons,e)),title:this.props.textTitle},this.props.title),this.props.icons&&this.props.icons.map((function(e){return r.default.createElement("span",{key:"payment-method-icon#"+e,className:e,title:t.props.icons&&t.props.icons.length>1?e:t.props.title})})),this.renderCCLast4())},t})(r.default.Component)})),define("modules/clean/react/payments/buy/components/payments/payment_method_selector",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/payments/payment_method_input"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodSelector=void 0;var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return a.__extends(t,e),t.prototype.getLabelForMethodId=function(e){if(e===o.PaymentMethod.TokenConnect){var t=this.props.paymentSpec.supported_credit_cards_for_country(""),a=void 0;return this.props.paymentSpec.spec.token_connect_prefill_data&&"cc_last4"in this.props.paymentSpec.spec.token_connect_prefill_data&&(a="****-"+this.props.paymentSpec.spec.token_connect_prefill_data.cc_last4),r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.TokenConnect,selected:this.props.paymentMethod===o.PaymentMethod.TokenConnect,onSelected:this.onPaymentMethodSelected,icons:t,fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"7u/Z5D",defaultMessage:"Credit card"},{payment_methods:"mastercard"}),cc_last4:a})}if(e===o.PaymentMethod.CreditCard){t=this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode);return r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.CreditCard,selected:this.props.paymentMethod===o.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:t,fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"2NPQhg",defaultMessage:"Credit card. We accept {payment_methods}."},{payment_methods:t.join(", ").replace("_","-")})})}return e===o.PaymentMethod.PayPal?r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.PayPal,selected:this.props.paymentMethod===o.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"RxvBVG",defaultMessage:"Paypal"})}):e===o.PaymentMethod.DirectDeposit?r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===o.PaymentMethod.DirectDeposit,onSelected:this.onPaymentMethodSelected,title:n.intl.formatMessage({id:"H1vHwe",defaultMessage:"Direct Debit"}),fullWidth:this.props.fullWidth}):e===o.PaymentMethod.Ideal?r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.Ideal,selected:this.props.paymentMethod===o.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"DgNBM/",defaultMessage:"iDEAL"})}):e===o.PaymentMethod.ApplePay?r.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.ApplePay,selected:this.props.paymentMethod===o.PaymentMethod.ApplePay,onSelected:this.onPaymentMethodSelected,icons:["applepay"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"ZoO+/M",defaultMessage:"ApplePay"})}):null},t.prototype.render=function(){var e=this,t=this.props,a=t.countryCode,o=t.paymentSpec,i=(t.showTrialVersion?o.only_default_payment_methods():o.available_payment_methods_for_country(a)).map((function(t){return e.getLabelForMethodId(t)}));return r.default.createElement("div",{className:"payment-info__selector grid__container"},r.default.createElement("span",{className:"ax-visually-hidden"},n.intl.formatMessage({id:"WrPpf6",defaultMessage:"Select a payment method"})),i)},t})((r=a.__importDefault(r)).default.Component);t.PaymentMethodSelector=s})),define("modules/clean/react/payments/buy/components/payments/tos",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/payments/skus/constants","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermsOfService=void 0;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTermsAndServiceChange=function(e){t.props.actions.updateTermsAndService(Boolean(!e.checked))},t.onTermsAndServiceBlur=function(e){t.props.actions.showFormFieldErrors(["termsAndService"],"TermsAndServiceBlur")},t.onTOSLabelClick=function(e){var a=t.props.formData.termsAndService.formattedValue;t.props.actions.updateTermsAndService(Boolean(!a))},t}return a.__extends(t,e),t.prototype.termsAndServiceErrorString=function(){var e=this.props.formData.termsAndService;return!s.FormValueHelper.isValid(e)&&e.showError?n.intl.formatMessage({id:"a2NBnL",defaultMessage:"Please agree to the terms of service."}):""},t.prototype.renderLegalTermsBuy=function(){var e=this.props,t=e.currency,a=e.formData,o={total_price:e.totalPrice,schedule:a.scheduleId.rawValue===i.ScheduleId.MONTHLY?n.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"}):n.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"}),currency:t,link_cancel:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/158",target:"_blank",rel:"noopener noreferrer"},e)},link_refund:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},link_required:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/help/9069",target:"_blank",rel:"noopener noreferrer"},e)}};return n.intl.formatMessage({id:"iwdwdQ",defaultMessage:"You’ll be charged {total_price} {schedule} until you <link_cancel>cancel</link_cancel> your subscription. Previous charges <link_refund>won’t be refunded</link_refund> when you cancel <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in {currency}."},o)},t.prototype.renderLegalTermsTrial=function(){var e=this.props,t=e.currency,a=e.formData,o=e.totalPrice;return n.intl.formatMessage({id:"iPVwvJ",defaultMessage:"Your free trial ends on {trial_end_date}. If you don’t <link_cancel>cancel</link_cancel> your free trial by that date, we’ll charge you {total_price} {schedule} (taxes included) until you cancel your plan. Charges <link_refund>won’t be refunded</link_refund> when you cancel, <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in {currency}."},{trial_end_date:a.trialEndDate.rawValue,total_price:o,schedule:a.scheduleId.rawValue===i.ScheduleId.MONTHLY?n.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"}):n.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"}),link_cancel:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/space/cancel-plus",target:"_blank",rel:"noopener noreferrer"},e)},link_refund:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/help/billing/plus-refund",target:"_blank",rel:"noopener noreferrer"},e)},link_required:function(e){return r.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},currency:t})},t.prototype.render=function(){var e=this.props,t=e.formData,i=e.showPromoLegalCopy,s=e.showTrialVersion,l=e.additionalTermsOfService,u=s?this.renderLegalTermsTrial():this.renderLegalTermsBuy(),c={link:function(e){return r.default.createElement("a",{className:"terms-info__tos--terms-link","aria-label":"terms",key:"link_dbx",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},br:r.default.createElement("br",{key:"link_br"}),strong:function(e){return r.default.createElement("strong",{key:"link_strong"},e)}},p=n.intl.formatMessage({id:"Q4Jjko",defaultMessage:"I agree to the <link>Dropbox Terms</link>{br}and the <strong>Automatic Renewal Terms</strong> above"},c);l&&(p=n.intl.formatMessage({id:"6/NfP1",defaultMessage:"I agree to the <link>Dropbox Terms</link>, <alink>{tosTitle}</alink>,{br}and the <strong>Automatic Renewal Terms</strong> above"},a.__assign({alink:function(e){return r.default.createElement("a",{className:"terms-info__tos--terms-link","aria-label":"terms",key:"link_additional",href:l.tosLink,target:"_blank",rel:"noopener noreferrer"},e)},tosTitle:l.tosTitle},c)));var d=r.default.createElement("span",{className:"type--copy-small",onClick:this.onTOSLabelClick},p),m=r.default.createElement(o.LabeledCheckboxInput,{checked:t.termsAndService.rawValue,containerClassName:"grid__item terms-info__tos",className:"billing-terms-and-service",errorText:this.termsAndServiceErrorString(),labelText:d,name:"tos_agree",onClick:this.onTermsAndServiceChange,onBlur:this.onTermsAndServiceBlur});return r.default.createElement("div",{className:"terms-info"},r.default.createElement("p",{className:"terms-info__legal"},u),i&&r.default.createElement("p",{className:"terms-info__promo-legal-copy"},n.intl.formatMessage({id:"TlRCFw",defaultMessage:"* You can only use the offer if you received it from Dropbox. Dropbox reserves the right to cancel, suspend, and/or modify the offer for any reason, including for fraud, technical limitations and failures, or causes that impact the integrity of the offer."})),m)},t})((r=a.__importDefault(r)).default.Component);t.TermsOfService=l})),define("modules/clean/react/payments/buy/helpers/product_plan_helpers",["require","exports","tslib","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/types/types","modules/core/exception"],(function(e,t,a,r,n,o){"use strict";var i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.getProductPlanType=t.getSelectedUiProduct=t.getCheckoutPageProductPlan=t.isProductPlanTypeSupportedByCheckoutPage=t.supportedPlanTypeToCheckoutPagePlan=void 0,o=a.__importStar(o),t.supportedPlanTypeToCheckoutPagePlan=((i={})[r.ProductPlanType.PLUS]=n.CheckoutPageProductPlan.PLUS,i[r.ProductPlanType.PROFESSIONAL]=n.CheckoutPageProductPlan.PROFESSIONAL,i[r.ProductPlanType.TRANSFER]=n.CheckoutPageProductPlan.TRANSFER,i[r.ProductPlanType.FAMILY_PAYER]=n.CheckoutPageProductPlan.FAMILY,i[r.ProductPlanType.SYNC_EVERYTHING]=n.CheckoutPageProductPlan.BACKUP,i[r.ProductPlanType.HS_DBX_PRO_BUNDLE]=n.CheckoutPageProductPlan.HELLOSIGN_DBX_PRO,i[r.ProductPlanType.PASSWORDS]=n.CheckoutPageProductPlan.PASSWORDS,i);var l=((s={})[n.CheckoutPageProductPlan.PLUS]=r.ProductPlanType.PLUS,s[n.CheckoutPageProductPlan.PROFESSIONAL]=r.ProductPlanType.PROFESSIONAL,s[n.CheckoutPageProductPlan.TRANSFER]=r.ProductPlanType.TRANSFER,s[n.CheckoutPageProductPlan.FAMILY]=r.ProductPlanType.FAMILY_PAYER,s[n.CheckoutPageProductPlan.BACKUP]=r.ProductPlanType.SYNC_EVERYTHING,s[n.CheckoutPageProductPlan.HELLOSIGN_DBX_PRO]=r.ProductPlanType.HS_DBX_PRO_BUNDLE,s[n.CheckoutPageProductPlan.PASSWORDS]=r.ProductPlanType.PASSWORDS,s);function u(e){var a=t.supportedPlanTypeToCheckoutPagePlan[e];return a||o.reportException({err:new Error("Unsupported product plan type "+e),severity:o.SEVERITY.CRITICAL}),a}t.isProductPlanTypeSupportedByCheckoutPage=function(e){return void 0!==u(e)},t.getCheckoutPageProductPlan=u,t.getSelectedUiProduct=function(e,t){var a=u(t),r=e[a];return r||o.reportException({err:new Error("supportedProducts does not include selected checkout page product plan "+a),severity:o.SEVERITY.CRITICAL}),r},t.getProductPlanType=function(e){var t=l[e];return t||o.reportException({err:new Error("Unsupported checkout page product plan type "+e),severity:o.SEVERITY.CRITICAL}),t}})),define("modules/clean/react/payments/common/middleware/captcha_visibility_checker",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaptchaVisibilityChecker=void 0;var a=(function(){function e(e){var t=this;this.POLLING_FREQUENCY_MS=500,this.checkCaptchaVisibility=function(){t.isCheckingCaptchaVisibility&&(t.isCaptchaVisible=t.getCaptchaVisibility(),t.isCaptchaVisible?(t.isCheckingCaptchaVisibility=!1,t.onCaptchaVisibility(!0)):setTimeout(t.checkCaptchaVisibility,t.POLLING_FREQUENCY_MS))},this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1,this.onCaptchaVisibility=e,this.wasLastCaptchaSubmitVisible=!1}return e.prototype.triggerCaptcha=function(){this.isCheckingCaptchaVisibility=!0,this.checkCaptchaVisibility()},e.prototype.submitCaptcha=function(){this.isCaptchaVisible||this.onCaptchaVisibility(!1),this.wasLastCaptchaSubmitVisible=this.isCaptchaVisible,this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1},e.prototype.getCaptchaVisibility=function(){var e=document.querySelector('iframe[src^="https://www.google.com/recaptcha/api2/bframe"]');return null!==e&&null!==e.parentElement&&null!==e.parentElement.parentElement&&"visible"===e.parentElement.parentElement.style.visibility},e})();t.CaptchaVisibilityChecker=a})),define("modules/clean/react/payments/common/middleware/payments_ux_logger",["require","exports","tslib","modules/clean/payments/three_ds_helper","modules/clean/payments/payment_form/payment_form_spec","modules/clean/logging/telemetry","modules/core/exception","modules/clean/logging/hive/schemas/web-payments_ux_analytics","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/middleware/captcha_visibility_checker","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,a,r,n,o,i,s,l,u,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentsUXLogger=void 0,o=a.__importStar(o),i=a.__importStar(i);var d=new Set(["BlurAccountHolderName","BlurCpf","BlurIBAN","BlurVat","BlurZipCode","UpdateCountryCode","UpdateIdealBank","UpdateMandateSigned","UpdatePaymentMethod"]),m=(function(){function e(e,t){var a=this;void 0===t&&(t=s.PaymentsUxPlatform.Legacy),this.reduxMiddleware=function(e){return function(t){return function(r){var n=e.getState(),o=t(r);try{var s=e.getState();a.handleAction(r,s,n)}catch(e){i.reportException({err:e,severity:i.SEVERITY.CRITICAL,tags:["payments_ux_logger","payment"]})}return o}}},this.onCaptchaVisibility=function(e){var t={challenge_type:e?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:a.originSubmitSeq.toString()};a.actionSeq++,a.logChallengeStart(t)},this.requestSeq=-1,this.actionSeq=-1,this.originSubmitSeq=0,this.requestId=e,this.logger=new o.HiveLogger,this.captchaVisibilityChecker=new c.CaptchaVisibilityChecker(this.onCaptchaVisibility),this.platform=t}return e.prototype.handleAction=function(e,t,a){var o;if(this.isPageView(e)){var i=((o={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.formData.paymentMethod.rawValue],o);this.requestSeq++,this.actionSeq=0,this.logPageView(i)}else if(this.isFormFieldChange(e)){null!==(i=this.getFormFieldChangeDetails(e.type,t.formData,a.formData))&&(this.actionSeq++,this.logFormFieldChange(i))}else if(this.isCCFormFieldChange(e)){null!==(i=this.getCCFormFieldChangeDetails(e.creditCardIframeFields))&&(this.actionSeq++,this.logFormFieldChange(i))}else if(this.isShowFormFieldErrors(e)){if(this.isErrorFromSubmitForm(e)){i=this.getFormValidationErrorDetails(t.formData);this.actionSeq++,this.logFormValidationError(i)}}else if(this.isSubmitFormSuccess(e)){i=this.getFormSubmitEventDetails(u.SubmitFormTriggerType.ButtonClick,t.formData,a.pageState.submitSeq);this.actionSeq++,this.logFormSubmitSuccess(i)}else if(this.isSubmitFormStart(e)){i=this.getFormSubmitEventDetails(e.trigger,t.formData,a.pageState.submitSeq);this.actionSeq++,this.logFormSubmit(i)}else if(this.isTriggerCaptcha(e))this.captchaVisibilityChecker.triggerCaptcha();else if(this.isSubmitCaptcha(e)){this.captchaVisibilityChecker.submitCaptcha();i={challenge_type:this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(i)}else if(this.isTriggerThreeDsChallenge(e)){i={challenge_type:s.ChallengeType.ThreeDsChallenge,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(i)}else if(this.isTriggerThreeDsFingerprint(e)){i={challenge_type:s.ChallengeType.ThreeDsFingerprint,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(i)}else if(this.isUpdateThreeDsData(e)){if(""!==e.value){var l=JSON.parse(e.value),c=void 0;if(l.resultType===r.ThreeDsResultType.IdentifyShopper)c=s.ChallengeType.ThreeDsFingerprint;else{if(l.resultType!==r.ThreeDsResultType.ChallengeShopper)return;c=s.ChallengeType.ThreeDsChallenge}i={challenge_type:c,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(i)}}else this.isApplePayError(e)?this.log(s.PaymentsUXEvent.ApplePayError,this.applePayData(a)):this.isApplePayClosedBySuccess(e)?this.log(s.PaymentsUXEvent.ApplePayClosedBySuccess,this.applePayData(a)):this.isApplePayClosedByFailure(e)?this.log(s.PaymentsUXEvent.ApplePayClosedByFailure,this.applePayData(a)):this.isApplePayPopupShown(e)?this.log(s.PaymentsUXEvent.ApplePayPopupShown,this.applePayData(a)):this.isApplePayStartup(e)&&this.log(s.PaymentsUXEvent.ApplePayStartup,this.applePayData(a))},e.prototype.applePayData=function(e){return{submit_seq:e.pageState.submitSeq.toString(),origin_submit_seq:this.originSubmitSeq.toString(),trigger:s.FormSubmitTrigger.ButtonClick}},e.prototype.logPageView=function(e){this.log(s.PaymentsUXEvent.PageView,e)},e.prototype.logFormFieldChange=function(e){this.log(s.PaymentsUXEvent.FormFieldChange,e)},e.prototype.logFormValidationError=function(e){this.log(s.PaymentsUXEvent.FormValidationError,e)},e.prototype.logFormSubmitSuccess=function(e){this.log(s.PaymentsUXEvent.FormSubmitSuccess,e)},e.prototype.logFormSubmit=function(e){this.log(s.PaymentsUXEvent.FormSubmit,e)},e.prototype.logChallengeStart=function(e){this.log(s.PaymentsUXEvent.ChallengeStart,e)},e.prototype.logChallengeSubmit=function(e){this.log(s.PaymentsUXEvent.ChallengeSubmit,e)},e.prototype.log=function(e,t){this.logger.log(new s.PaymentsUXAnalyticsRow({event_name:e,event_details:t,request_id:this.requestId,request_seq:this.requestSeq,action_seq:this.actionSeq,platform:this.platform}))},e.prototype.isPageView=function(e){return e.type===p.PageActionEnum.UpdateHistory},e.prototype.isFormFieldChange=function(e){return d.has(e.type)},e.prototype.isShowFormFieldErrors=function(e){return"ShowFormFieldErrors"===e.type},e.prototype.isErrorFromSubmitForm=function(e){return"SubmitForm"===e.origin},e.prototype.isSubmitFormStart=function(e){return"SubmitFormStart"===e.type},e.prototype.isSubmitFormSuccess=function(e){return"SubmitFormSuccess"===e.type},e.prototype.isTriggerCaptcha=function(e){return"TriggerCaptcha"===e.type},e.prototype.isSubmitCaptcha=function(e){return"SubmitCaptcha"===e.type},e.prototype.isTriggerThreeDsChallenge=function(e){return"TriggerThreeDsChallenge"===e.type},e.prototype.isTriggerThreeDsFingerprint=function(e){return"TriggerThreeDsFingerprint"===e.type},e.prototype.isUpdateThreeDsData=function(e){return"UpdateThreeDsData"===e.type},e.prototype.isCCFormFieldChange=function(e){return"BlurCCField"===e.type},e.prototype.isApplePayStartup=function(e){return"ApplePayStartup"===e.type},e.prototype.isApplePayPopupShown=function(e){return"ApplePayPopupShown"===e.type},e.prototype.isApplePayError=function(e){return"ApplePayError"===e.type},e.prototype.isApplePayClosedBySuccess=function(e){return"ApplePayClosedBySuccess"===e.type},e.prototype.isApplePayClosedByFailure=function(e){return"ApplePayPopupCloseByFailure"===e.type},e.prototype.getFormFieldChangeDetails=function(e,t,a){switch(e){case"BlurAccountHolderName":return{field:s.FormFields.SepaAccountHolderName,value:t.accountHolderName.rawValue,error_state:l.InputErrorState[t.accountHolderName.errorState],show_error:t.accountHolderName.showError.toString()};case"BlurCpf":return{field:s.FormFields.Cpf,value:t.cpf.rawValue,error_state:l.InputErrorState[t.cpf.errorState],show_error:t.cpf.showError.toString()};case"BlurIBAN":return{field:s.FormFields.Iban,value:t.iban.rawValue,error_state:l.InputErrorState[t.iban.errorState],show_error:t.iban.showError.toString()};case"BlurVat":return{field:s.FormFields.Vat,value:t.vat.rawValue,error_state:l.InputErrorState[t.vat.errorState],show_error:t.vat.showError.toString()};case"BlurZipCode":return{field:s.FormFields.ZipCode,value:t.zipCode.rawValue,error_state:l.InputErrorState[t.zipCode.errorState],show_error:t.zipCode.showError.toString()};case"UpdateCountryCode":return a.countryCode.rawValue!==t.countryCode.rawValue?{field:s.FormFields.CountryCode,value:t.countryCode.rawValue,error_state:l.InputErrorState[t.countryCode.errorState],show_error:t.countryCode.showError.toString()}:null;case"UpdateIdealBank":return a.idealBankId.rawValue!==t.idealBankId.rawValue?{field:s.FormFields.IdealBankId,value:t.idealBankId.rawValue,error_state:l.InputErrorState[t.idealBankId.errorState],show_error:t.idealBankId.showError.toString()}:null;case"UpdateMandateSigned":return a.mandateSigned.rawValue!==t.mandateSigned.rawValue?{field:s.FormFields.SepaMandateSigned,value:t.mandateSigned.rawValue.toString(),error_state:l.InputErrorState[t.mandateSigned.errorState],show_error:t.mandateSigned.showError.toString()}:null;case"UpdatePaymentMethod":return a.paymentMethod.rawValue!==t.paymentMethod.rawValue?{field:s.FormFields.PaymentMethod,value:n.PaymentMethod[t.paymentMethod.rawValue],error_state:l.InputErrorState[t.paymentMethod.errorState],show_error:t.paymentMethod.showError.toString()}:null;default:return null}},e.prototype.getCCFormFieldChangeDetails=function(e){return e.ccn?{field:s.FormFields.CreditCardNumber,error_state:l.InputErrorState[e.ccn.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccn.showError.toString()}:e.ccode?{field:s.FormFields.CreditCardCode,error_state:l.InputErrorState[e.ccode.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccode.showError.toString()}:e.ccexp?{field:s.FormFields.CreditCardExpDate,error_state:l.InputErrorState[e.ccexp.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccexp.showError.toString()}:null},e.prototype.getFormValidationErrorDetails=function(e){var t={};return e.countryCode.showError&&(t[s.FormFields.CountryCode]=l.InputErrorState[e.countryCode.errorState]),e.paymentMethod.showError&&(t[s.FormFields.PaymentMethod]=l.InputErrorState[e.paymentMethod.errorState]),e.zipCode.showError&&(t[s.FormFields.ZipCode]=l.InputErrorState[e.zipCode.errorState]),e.vat.showError&&(t[s.FormFields.Vat]=l.InputErrorState[e.vat.errorState]),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(e.nonce.showError&&(e.nonce.isCCNValid||(t[s.FormFields.CreditCardNumber]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCodeValid||(t[s.FormFields.CreditCardCode]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCExpValid||(t[s.FormFields.CreditCardExpDate]=l.InputErrorState[l.InputErrorState.Invalid])),e.cpf.showError&&(t[s.FormFields.Cpf]=l.InputErrorState[e.cpf.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?(e.mandateSigned.showError&&(t[s.FormFields.SepaMandateSigned]=l.InputErrorState[e.mandateSigned.errorState]),e.accountHolderName.showError&&(t[s.FormFields.SepaAccountHolderName]=l.InputErrorState[e.accountHolderName.errorState]),e.iban.showError&&(t[s.FormFields.Iban]=l.InputErrorState[e.iban.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal&&e.idealBankId.showError&&(t[s.FormFields.IdealBankId]=l.InputErrorState[e.idealBankId.errorState]),t},e.prototype.getFormSubmitEventDetails=function(e,t,a){var r;switch(e){case u.SubmitFormTriggerType.ButtonClick:r=s.FormSubmitTrigger.ButtonClick,this.originSubmitSeq=a;break;case u.SubmitFormTriggerType.RecaptchaV2:r=this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.FormSubmitTrigger.ShownCaptcha:s.FormSubmitTrigger.SuppressedCaptcha;break;case u.SubmitFormTriggerType.ThreeDsFingerprint:r=s.FormSubmitTrigger.ThreeDsFingerprint;break;case u.SubmitFormTriggerType.ThreeDsChallenge:r=s.FormSubmitTrigger.ThreeDsChallenge;break;default:r=s.FormSubmitTrigger.Unknown}var o={origin_submit_seq:this.originSubmitSeq.toString(),submit_seq:a.toString(),trigger:r};return r===s.FormSubmitTrigger.ButtonClick&&(o[s.FormFields.CountryCode]=t.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.paymentMethod.rawValue],t.paymentMethod.rawValue===n.PaymentMethod.CreditCard&&(o.bin=t.bin.rawValue)),o},e})();t.PaymentsUXLogger=m})),define("modules/clean/logging/hive/schemas/web-payments_ux_analytics",["require","exports","tslib","modules/core/browser"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentsUXAnalyticsRow=t.PaymentsUxPlatform=t.FormSubmitTrigger=t.ChallengeType=t.FormFields=t.PaymentsUXEvent=void 0,r=a.__importStar(r),(function(e){e.PageView="page_view",e.FormFieldChange="form_field_change",e.FormValidationError="form_validation_error",e.FormSubmit="form_submit",e.ChallengeStart="challenge_start",e.ChallengeSubmit="challenge_submit",e.FormSubmitSuccess="form_submit_success",e.ApplePayStartup="apple_pay_startup",e.ApplePayPopupShown="apple_pay_popup_shown",e.ApplePayClosedByFailure="apple_pay_closed_by_failure",e.ApplePayError="apple_pay_error",e.ApplePayClosedBySuccess="apple_pay_closed_by_success"})(t.PaymentsUXEvent||(t.PaymentsUXEvent={})),(function(e){e.CountryCode="country_code",e.Cpf="cpf",e.CreditCardCode="cc_code",e.CreditCardExpDate="cc_exp_date",e.CreditCardNumber="cc_number",e.Iban="iban",e.IdealBankId="bank_id",e.PaymentMethod="payment_method",e.SepaAccountHolderName="owner_name",e.SepaMandateSigned="mandate_signed",e.Vat="vat",e.ZipCode="zip_code"})(t.FormFields||(t.FormFields={})),(function(e){e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(t.ChallengeType||(t.ChallengeType={})),(function(e){e.ButtonClick="button_click",e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint",e.Unknown="unknown"})(t.FormSubmitTrigger||(t.FormSubmitTrigger={})),(function(e){e.Legacy="legacy",e.RevenueAPI="revenue_api"})(t.PaymentsUxPlatform||(t.PaymentsUxPlatform={}));var n=function(e){this.category="web-payments_ux_analytics",this.session_id=null,this.user_id=null,this.team_id=null,this.anon_ip=null,this.country=null,this.locale_user_selected=null,this.locale_browser_header=null,this.user_agent=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_os_name=null,this.ua_os_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.event_name=e.event_name,this.event_details=e.event_details,this.url=r.get_href(),this.request_id=e.request_id,this.request_seq=e.request_seq,this.action_seq=e.action_seq,this.platform=e.platform,Object.seal(this)};t.PaymentsUXAnalyticsRow=n})),define("modules/clean/payments/skus/subscription_change_plan_set",["require","exports","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionChangePlanSet=void 0;var n=(function(){function e(e){this._subChangePlans=e}return e.deserialize=function(t){return new e(t.map(r.SubscriptionChangePlan.deserialize))},Object.defineProperty(e.prototype,"plans",{get:function(){return this._subChangePlans.slice()},enumerable:!1,configurable:!0}),e.prototype.filter=function(t){return new e(this._subChangePlans.filter(t))},e.prototype.withProductPlanType=function(e){return this.filter((function(t){var a=t.finalSubState.plan;return!!a&&a.productType===e}))},e.prototype.withSchedule=function(e){return this.filter((function(t){var a=t.finalSubState.billingSchedule;return!!a&&a.id===e}))},e.prototype.withSku=function(e){return this.filter((function(t){return t.finalSubState.plan===e}))},e.prototype.monthly=function(){return this.withSchedule(a.ScheduleId.MONTHLY)},e.prototype.yearly=function(){return this.withSchedule(a.ScheduleId.YEARLY)},e})();t.SubscriptionChangePlanSet=n})),define("modules/clean/react/payments/common/form/middleware/middleware",["require","exports","tslib","lodash","modules/core/browser","modules/core/notify","modules/clean/marketing_tracker"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.marketingEventMiddleware=t.submitFormErrorMiddleware=void 0,r=a.__importStar(r),t.submitFormErrorMiddleware=function(e){return function(e){return function(t){if("SubmitFormError"!==t.type)return e(t);var a=e(t);return t.data.error_message&&o.Notify.error(t.data.error_message),t.data.redirect&&n.redirect(t.data.redirect),a}}};var s={};t.marketingEventMiddleware=function(e){return function(t){return function(a){var n=a.additionalData;switch(a.type){case"SubmitFormStart":if(!n||!n.send_conversion_data)return t(a);var o={event:"conversionDataReady",tealium_event:"conversionDataReady",product:n.product,licenses:n.licenses||1,billing_cycle:n.billing_schedule,purchase_price:n.expected_price_amount,currency:n.currency,type:n.signup_type};if(r.isEqual(s,o))return t(a);i.MarketingTracker.pushWithDefaults(o),s=o;break;case"SubmitFormSuccess":var l=e.getState().pageState;if(l&&l.marketingTracker){var u=l.marketingTracker.onSubmitFormSuccess;u&&i.MarketingTracker.pushEvent(u)}}return t(a)}}}})),define("modules/clean/react/payments/common/form/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/common/form_values","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,r,n,o,i,s,l){"use strict";function u(e,t){var r=i.fieldsToServerProps[e];return r?function(n,o){switch(o.type){case"ShowFormFieldErrors":var i=o;if(n&&!l.FormValueHelper.isValid(n))for(var s=0,u=i.fieldNames;s<u.length;s++){var c=u[s];if(e===c)return a.__assign(a.__assign({},n),{showError:!0})}return n;case"SubmitFormError":var p=o;return p.data instanceof Object&&p.data.error_fields instanceof Object&&p.data.error_fields.hasOwnProperty(r)?n?a.__assign(a.__assign({},n),{showError:!0,serverError:p.data.error_fields[r]}):{showError:!0,serverError:p.data.error_fields[r]}:n;default:return t(n,o)}}:t}function c(e){return function(t,r){return t?a.__assign(a.__assign({},t),e(t,r)):e(t,r)}}function p(e,t){var r=t;switch(r.type){case"SubmitFormError":var o=r;if(o.data instanceof Object&&o.data.hasOwnProperty("error_fields")&&o.data.error_fields.hasOwnProperty("email")){var i=o.data.error_fields.email,u=void 0;switch(i){case"empty":u=n.EmailErrorState.Empty;break;case"account":case"email-taken":u=n.EmailErrorState.TakenError;break;default:u=e?e.errorState:n.EmailErrorState.Valid}return a.__assign(a.__assign({},e),{showError:!0,serverError:i,errorState:u})}return o.data instanceof Object&&o.data.hasOwnProperty("error_type")&&"capturable_user"===o.data.error_type.toString()?a.__assign(a.__assign({},e),{showError:!1,isCapturable:!0}):e;case"ShowFormFieldErrors":var c=r;if(e&&!l.FormValueHelper.isValid(e))for(var p=0,d=c.fieldNames;p<d.length;p++){if("email"===d[p])return a.__assign(a.__assign({},e),{showError:!0})}return e;case"UpdateEmail":var m=r;return s.FormValueFactory.createEmail(m.value,e||void 0);default:return e||null}}function d(e,t){if(void 0===e&&(e=null),"SubmitFormSuccess"!==t.type)return null;var a=t;return a.data&&a.data.next_url?a.data.next_url:null}function m(e,t){switch(void 0===e&&(e=null),t.type){case"SubmitFormStart":return"submitting";case"SubmitFormSuccess":return"success";case"SubmitFormError":return"error";default:return e}}function f(e,t){return void 0===e&&(e=null),"SubmitFormStart"===t.type&&"number"==typeof e?e+1:e}function h(e,t){switch(void 0===e&&(e=!1),t.type){case"SubmitFormStart":return!0;case"SubmitFormSuccess":case"SubmitFormError":return!1;default:return e}}function y(e,t){e=e||{};var r=t;switch(r.type){case"UpdateCpfName":return a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfName(r.value,e.formData.cpfName)})});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(r.value,e.formData.lastName.rawValue,e.pageState.userInfo.displayName)})});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(e.formData.firstName.rawValue,r.value,e.pageState.userInfo.displayName)})});default:return e}}function g(e,t){e=e||{};var r=t;switch(r.type){case"SubmitFormError":var n=r,i="";return n.data&&n.data.error_fields&&(i=n.data.error_fields.product_plan_type),a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{productPlanType:a.__assign(a.__assign({},e.formData.productPlanType),{serverError:i,showError:!0})})});case"ShowFormFieldErrors":var u=r;if(e.formData.productPlanType&&!l.FormValueHelper.isValid(e.formData.productPlanType))for(var c=0,p=u.fieldNames;c<p.length;c++){if("productPlanType"===p[c])return a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{productPlanType:a.__assign(a.__assign({},e.formData.productPlanType),{showError:!0})})})}return e;case"UpdateProductPlanType":var d=r,m=d.value,f=m===o.ProductPlanType.ADVANCED?e.pageState.advancedMinNumUsers:e.pageState.standardMinNumUsers,h=m===o.ProductPlanType.ADVANCED?e.pageState.advancedMaxNumUsers:e.pageState.standardMaxNumUsers;return void 0!==e.pageState.teamNumUsers&&(f=Math.max(f,e.pageState.teamNumUsers)),a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{minNumUsers:f,maxNumUsers:h}),formData:a.__assign(a.__assign({},e.formData),{productPlanType:s.FormValueFactory.createProductPlanType(d.value,e.pricingState.subChangePlans,e.formData.productPlanType)})});default:return e}}function _(e,t){e=e||{};var r=t;switch(r.type){case"SubmitFormError":var n=r,o="";return n.data&&n.data.error_fields&&(o=n.data.error_fields.team_num_users),a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{numberOfUsers:a.__assign(a.__assign({},e.formData.numberOfUsers),{serverError:o,showError:!0})})});case"ShowFormFieldErrors":var i=r;if(e.formData.numberOfUsers&&!l.FormValueHelper.isValid(e.formData.numberOfUsers))for(var u=0,c=i.fieldNames;u<c.length;u++){if("numberOfUsers"===c[u])return a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{numberOfUsers:a.__assign(a.__assign({},e.formData.numberOfUsers),{showError:!0})})})}return e;case"UpdateNumberOfUsers":var p=r;return a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{numberOfUsers:s.FormValueFactory.createNumberOfUsers(p.value,e.pageState,e.formData.numberOfUsers,e.formData.numberOfUsers.minLicenseLimit,e.formData.emailsToInvite?e.formData.emailsToInvite.rawValue.length:0)})});default:return e}}function v(e,t){e=e||{};var r=t;return"UpdateMarketingOptIn"!==r.type?e:a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),{marketingOptIn:s.FormValueFactory.createCheckbox(r.value,e.formData.marketingOptIn,!0)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.FormReducer=t.updateMarketingOptIn=t.updateNumberOfUsers=t.updateProductPlanType=t.updateCpfName=t.teamPhone=t.teamName=t.submitting=t.submitSeq=t.submitState=t.schedule=t.password=t.nextUrl=t.lastName=t.firstName=t.emailsToInvite=t.email=t.companySize=void 0,t.companySize=u("companySize",(function(e,t){return"UpdateCompanySize"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.email=p,t.emailsToInvite=u("emailsToInvite",(function(e,t){return"UpdateEmailsToInvite"===t.type?s.FormValueFactory.createEmailsToInvite(t.value,e||void 0):e||null})),t.firstName=u("firstName",(function(e,t){return"UpdateFirstName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.lastName=u("lastName",(function(e,t){return"UpdateLastName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.nextUrl=d,t.password=u("password",(function(e,t){return"UpdatePassword"===t.type?s.FormValueFactory.createPassword(t.value,e||void 0):e||null})),t.schedule=u("schedule",(function(e,t){return"UpdateSchedule"===t.type?s.FormValueFactory.createSchedule(t.value):e||null})),t.submitState=m,t.submitSeq=f,t.submitting=h,t.teamName=u("teamName",(function(e,t){return"UpdateTeamName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.teamPhone=u("teamPhone",(function(e,t){return"UpdateTeamPhone"===t.type?s.FormValueFactory.createTeamPhone(t.value,e||void 0):e||null})),t.updateCpfName=y,t.updateProductPlanType=g,t.updateNumberOfUsers=_,t.updateMarketingOptIn=v;var P=c(r.combineReducers({nextUrl:d,submitState:m,submitting:h,submitSeq:f})),b=c(r.combineReducers({companySize:t.companySize,email:p,emailsToInvite:t.emailsToInvite,firstName:t.firstName,lastName:t.lastName,password:t.password,schedule:t.schedule,teamName:t.teamName,teamPhone:t.teamPhone}));t.FormReducer=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,r){return t(e(a,r),r)}}))})(y,g,_,v,r.combineReducers({pricingState:function(e){return e||{}},pageState:P,formData:b}))})),define("modules/clean/react/payments/common/payments/reducers/reducers",["require","exports","tslib","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory"],(function(e,t,a,r,n,o){"use strict";function i(e,t){return a.__assign(a.__assign({},e),{formData:a.__assign(a.__assign({},e.formData),t)})}function s(e){var t=r.fieldsToServerProps[e];return t?function(r){return function(o,s){var l=o.formData[e];switch(s.type){case"ShowFormFieldErrors":for(var u=0,c=s.fieldNames;u<c.length;u++){if(c[u]===e&&void 0!==l&&!n.FormValueHelper.isValid(l)){var p={};return p[e]=a.__assign(a.__assign({},l),{showError:!0}),i(o,p)}}return o;case"SubmitFormError":var d=s;if(!d.data||!d.data.error_fields||!d.data.error_fields[t]||void 0===l)return o;var m={};return m[e]=a.__assign(a.__assign({},l),{showError:!0,serverError:d.data.error_fields[t]}),i(o,m);default:return r(o,s)}}}:function(e){return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TermsAndServiceReducers=t.PaymentMethodReducers=t.updateIdealBank=t.updateTermsAndService=t.updateMandateSigned=t.updateIBAN=t.updateAccountHolderName=t.updateThreeDsData=t.updateBrowserInfo=t.updateBIN=t.updateApplePayToken=t.updateEncryptedCardForNetworkToken=t.updateAdyenEncryptedCard=t.updatePayPalNonce=t.updateNonce=t.updateCpfName=t.updateCpf=t.updateVat=t.updateZipCode=t.updateCountryCode=t.updatePaymentMethod=void 0,t.updatePaymentMethod=s("paymentMethod")((function(e,t){if("UpdatePaymentMethod"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a=e.formData,r=e.pageState,n="UpdatePaymentMethod"===t.type?t.value:a.paymentMethod.rawValue,s=a.countryCode.formattedValue;return i(e,{paymentMethod:o.FormValueFactory.createPaymentMethod(n,s,r.paymentFormSpec,a.paymentMethod)})})),t.updateCountryCode=s("countryCode")((function(e,t){return"UpdateCountryCode"!==t.type?e:i(e,{countryCode:o.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})})),t.updateZipCode=s("zipCode")((function(e,t){return"UpdateZipCode"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{zipCode:o.FormValueFactory.createZipCode("UpdateZipCode"===t.type?t.value:e.formData.zipCode.rawValue,e.formData.countryCode.formattedValue,e.pageState.paymentFormSpec,e.formData.zipCode)})})),t.updateVat=s("vat")((function(e,t){return"UpdateVat"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{vat:o.FormValueFactory.createVat("UpdateVat"===t.type?t.value.toUpperCase():e.formData.vat.rawValue,e.formData.countryCode.formattedValue,e.formData.vat)})})),t.updateCpf=s("cpf")((function(e,t){return"UpdateCpf"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{cpf:o.FormValueFactory.createCpf("UpdateCpf"===t.type?t.value.toUpperCase():e.formData.cpf.rawValue,e.formData.cpf)})})),t.updateCpfName=s("cpfName")((function(e,t){return"UpdateCpfName"!==t.type?e:i(e,{cpfName:o.FormValueFactory.createCpfName(t.value,e.formData.cpfName)})})),t.updateNonce=s("nonce")((function(e,t){return"UpdateNonce"!==t.type?e:i(e,{nonce:o.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce)})})),t.updatePayPalNonce=s("nonce")((function(e,t){return"UpdatePayPalNonce"!==t.type?e:i(e,{payPalNonce:o.FormValueFactory.createPayPalNonce(t.value,t.email,e.formData.payPalNonce)})})),t.updateAdyenEncryptedCard=s("adyenEncryptedCard")((function(e,t){return"UpdateAdyenEncryptedCard"!==t.type?e:i(e,{adyenEncryptedCard:o.FormValueFactory.createAdyenEncryptedCard(t.value,e.formData.adyenEncryptedCard)})})),t.updateEncryptedCardForNetworkToken=s("encryptedCardForNetworkToken")((function(e,t){return"UpdateEncryptedCardForNetworkToken"!==t.type?e:i(e,{encryptedCardForNetworkToken:o.FormValueFactory.createEncryptedCardForNetworkToken(t.cardType,t.encryptedCard)})})),t.updateApplePayToken=s("applePayToken")((function(e,t){return"UpdateApplePayToken"!==t.type?e:i(e,{applePayToken:o.FormValueFactory.createApplePayToken(t.value,e.formData.applePayToken)})})),t.updateBIN=s("bin")((function(e,t){return"UpdateBIN"!==t.type?e:i(e,{bin:o.FormValueFactory.createBIN(t.value,e.formData.bin)})})),t.updateBrowserInfo=s("browserInfo")((function(e,t){return"UpdateBrowserInfo"!==t.type?e:i(e,{browserInfo:o.FormValueFactory.createBrowserInfo(t.value,e.formData.browserInfo)})})),t.updateThreeDsData=s("threeDsData")((function(e,t){return"UpdateThreeDsData"!==t.type?e:i(e,{threeDsData:o.FormValueFactory.createThreeDsData(t.value)})})),t.updateAccountHolderName=s("accountHolderName")((function(e,t){return"UpdateAccountHolderName"!==t.type?e:i(e,{accountHolderName:o.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})})),t.updateIBAN=s("iban")((function(e,t){return"UpdateIBAN"!==t.type?e:i(e,{iban:o.FormValueFactory.createIBAN(t.value,e.formData.iban)})})),t.updateMandateSigned=s("mandateSigned")((function(e,t){return"UpdateMandateSigned"!==t.type?e:i(e,{mandateSigned:o.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})})),t.updateTermsAndService=s("termsAndService")((function(e,t){return"UpdateTermsAndService"!==t.type?e:i(e,{termsAndService:o.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})})),t.updateIdealBank=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,r){return t(e(a,r),r)}}))})(s("idealBankId")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankId:o.FormValueFactory.createIdealBankId(t.value.bankId,e.formData.idealBankId)})})),s("idealBankName")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankName:o.FormValueFactory.createIdealBankName(t.value.bankName,e.formData.idealBankName)})}))),t.PaymentMethodReducers=[t.updateCountryCode,t.updatePaymentMethod,t.updateZipCode,t.updateVat,t.updateCpf,t.updateCpfName,t.updateNonce,t.updateAdyenEncryptedCard,t.updateEncryptedCardForNetworkToken,t.updateBIN,t.updateBrowserInfo,t.updateThreeDsData,t.updateAccountHolderName,t.updateIBAN,t.updateMandateSigned,t.updateIdealBank,t.updatePayPalNonce,t.updateApplePayToken],t.TermsAndServiceReducers=[t.updateTermsAndService]})),define("modules/clean/react/payments/common/payments/state/store_creator",["require","exports","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form_value_factory"],(function(e,t,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPaymentFormData=t.createPaymentPageState=t.createPaymentPricingState=void 0,t.createPaymentPricingState=function(e){return{countryCode:r.FormValueFactory.createCountryCode(e.countryCode).formattedValue,countryCodeLoading:void 0,hasCurrencyChanged:!1,hasTaxChangedWithinCountry:!1,loadingPrices:!1,recentLoadEvent:!1,requestToken:-1}},t.createPaymentPageState=function(e){return{paymentFormSpec:new a.PaymentFormSpec(e.serializedPaymentFormSpec),requestId:e.requestId,submitSeq:0,paypalEmail:""}},t.createPaymentFormData=function(e,t,a){var n=e.countryCode,o=e.userInfo,i=e.vat,s=t.paymentFormSpec.default_payment_method_for_country(n);return{city:r.FormValueFactory.createCity(""),phone:r.FormValueFactory.createPhone(""),name:r.FormValueFactory.createName(""),address:r.FormValueFactory.createAddress(""),paymentMethod:r.FormValueFactory.createPaymentMethod(s,n,t.paymentFormSpec),countryCode:r.FormValueFactory.createCountryCode(n),zipCode:r.FormValueFactory.createZipCode("",n,t.paymentFormSpec),vat:r.FormValueFactory.createVat(i||"",n),cpf:r.FormValueFactory.createCpf(""),cpfName:r.FormValueFactory.createCpfNamePrefill("","",o.displayName),nonce:r.FormValueFactory.createNonce(""),payPalNonce:r.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:r.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:r.FormValueFactory.createEncryptedCardForNetworkToken("",""),applePayToken:r.FormValueFactory.createApplePayToken(""),bin:r.FormValueFactory.createBIN(""),browserInfo:r.FormValueFactory.createBrowserInfo(""),threeDsData:r.FormValueFactory.createThreeDsData(""),accountHolderName:r.FormValueFactory.createInput(""),iban:r.FormValueFactory.createIBAN(""),mandateSigned:r.FormValueFactory.createCheckbox(!1),termsAndService:r.FormValueFactory.createCheckbox(!1),idealBankId:r.FormValueFactory.createIdealBankId(""),idealBankName:r.FormValueFactory.createIdealBankName("")}}})),define("modules/clean/react/payments/common/pricing/reducers/reducers",["require","exports","tslib","modules/clean/payments/skus/subscription_change_plan_set"],(function(e,t,a,r){"use strict";function n(e,t){if("PrepareToUpdateTransitions"!==t.type)return e;var r=a.__assign(a.__assign({},e.pricingState),{loadingPrices:!0,recentLoadEvent:!0});return a.__assign(a.__assign({},e),{pricingState:r})}function o(e,t){if("UpdateRecentLoadEventStatus"!==t.type)return e;var r=a.__assign(a.__assign({},e.pricingState),{recentLoadEvent:t.recentLoadEventStatus});return a.__assign(a.__assign({},e),{pricingState:r})}function i(e,t){if("UpdateTransitionsStart"!==t.type)return e;var r=a.__assign(a.__assign({},e.pricingState),{countryCodeLoading:e.formData.countryCode.formattedValue,loadingPrices:!0,recentLoadEvent:!0});return a.__assign(a.__assign({},e),{pricingState:r})}function s(e,t){if("UpdateTransitionsSuccess"!==t.type)return e;var n,o="N/A",i=!1,s=!1;if(t.subChangePlans&&(n=t.subChangePlans,e.pricingState.subChangePlans.plans.length>0)){var l=e.pricingState.subChangePlans.plans[0],u=n[0],c=l.tvm,p=u.tvm,d=c&&c.getCurrency(),m=p&&p.getCurrency();i=(o="N/A"===e.pricingState.originalCurrency?d:e.pricingState.originalCurrency)!==m;var f=l.nextBillingSummary.taxRate,h=f===u.nextBillingSummary.taxRate&&(0===f||d===m);s=e.pricingState.hasTaxChangedWithinCountry||!h,e.pricingState.countryCode!==e.pricingState.countryCodeLoading&&(s=!1)}var y=a.__assign(a.__assign({},e.pricingState),{countryCode:e.pricingState.countryCodeLoading,countryCodeLoading:void 0,hasCurrencyChanged:i,hasTaxChangedWithinCountry:s,loadingPrices:!1,originalCurrency:o,recentLoadEvent:!0,subChangePlans:new r.SubscriptionChangePlanSet(t.subChangePlans),baseSubChangePlans:new r.SubscriptionChangePlanSet(t.subChangePlans)});return a.__assign(a.__assign({},e),{pricingState:y})}Object.defineProperty(t,"__esModule",{value:!0}),t.updateTransitionsSuccess=t.updateTransitionsStart=t.updateRecentLoadEventStatus=t.prepareToUpdateTransitions=t.TransitionManagementReducers=void 0,t.TransitionManagementReducers=[n,o,i,s],t.prepareToUpdateTransitions=n,t.updateRecentLoadEventStatus=o,t.updateTransitionsStart=i,t.updateTransitionsSuccess=s})),define("modules/clean/react/payments/pro/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames","ts-key-enum"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabeledInputRow=t.LabeledSelectInput=t.LabeledRadioInput=t.LabeledCheckboxInput=t.LabeledTextInput=t.LabeledInput=void 0,r=a.__importDefault(r),n=a.__importDefault(n),o=a.__importDefault(o);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=o.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement),"input__label--errormodal":Boolean(this.props.errorText)},this.props.className),t=this.props.containerClassName,a=r.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),n=null;this.props.labelAfterElement&&(n=a,a=null);var i,s=null;this.props.secondaryLabel&&(s=r.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=this.props.errorText);var l=r.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},i);return r.default.createElement("div",{className:t},a,this.props.children,n,s,l)},t})(r.default.Component);t.LabeledInput=s;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.autocomplete,i=t.className,l=t.disabled,u=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,f=t.maxLength,h=t.containerClassName,y=t.placeholder,g=this.props.type||"text",_=o.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return r.default.createElement(s,{className:i,containerClassName:h,labelText:u,htmlFor:a,errorText:p,secondaryLabel:c},r.default.createElement("input",{className:_,type:g,autoComplete:n,placeholder:y,name:a,id:a,ref:function(t){e.input=t},value:m,disabled:l,onChange:this.onChange,onBlur:this.onBlur,maxLength:f}))},t})(r.default.Component);t.LabeledTextInput=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode||(t.props.onClick(n.default.findDOMNode(t.input)),e.preventDefault()))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=n.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.containerClassName,l=t.disabled,u=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=o.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(l)},n);return r.default.createElement(s,{containerClassName:i,className:c,errorText:p,htmlFor:a,labelAfterElement:!0,labelText:u},r.default.createElement("div",{"aria-labelledby":a,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyUp:this.handleCheckboxChange}),r.default.createElement("input",{tabIndex:-1,checked:d,disabled:l,id:a,name:a,ref:function(t){e.input=t},type:"checkbox"}))},t})(r.default.Component);t.LabeledCheckboxInput=u;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleRadioChange=function(e){t.props.disabled?e.stopPropagation():t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode||(t.props.onClick(e,t.props.name,t.props.value),e.preventDefault()))},t}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props,a=t.id,n=t.name,i=t.ariaLabel,l=t.disabled,u=t.value,c=t.checked,p=t.onChange,d=t.labelText,m=t.labelClassName,f=o.default({input__radio:!0,"input__radio--valid":Boolean(c),"input__radio--disabled":Boolean(l)},this.props.className),h=o.default(((e={})[this.props.containerClassName+"--valid"]=!!this.props.containerClassName&&Boolean(c),e),this.props.containerClassName);return r.default.createElement(s,{containerClassName:h,className:m,labelText:d,htmlFor:n,labelAfterElement:!0},r.default.createElement("div",{"aria-label":i||n,role:"radio",tabIndex:0,className:f,onClick:this.handleRadioChange,onKeyUp:this.handleRadioChange}),r.default.createElement("input",{id:a,tabIndex:-1,ref:"radio",type:"radio",name:n,value:u,checked:c,onChange:p,disabled:l}))},t})(r.default.Component);t.LabeledRadioInput=c;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.containerClassName,l=t.labelClassName,u=t.labelText,c=t.errorText,p=o.default({input__select:!0},n);return r.default.createElement(s,{containerClassName:i,className:l,errorText:c,htmlFor:a,labelText:u},r.default.createElement("select",{className:p,id:a,name:a,onChange:this.onChange,value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(r.default.Component);t.LabeledSelectInput=p;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e){return r.default.createElement("div",{className:e.className},r.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(r.default.Component);t.LabeledInputRow=d})),define("modules/clean/payments/cvv_hint",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CvvHint=void 0,r=a.__importStar(r),t.CvvHint=function(){return r.createElement("div",{className:"cvv-hint-view","aria-live":"assertive"},r.createElement("div",null,r.createElement("p",null,n.intl.formatMessage({id:"tx+fwq",defaultMessage:"Your card code is a 3 or 4 digit number that is found in these locations:"})),r.createElement("img",{src:o.static_url("/static/images/cvv2-vflQL_5Od.png"),alt:""}),r.createElement("h5",null,n.intl.formatMessage({id:"e9l+ET",defaultMessage:"Visa/Mastercard"})),r.createElement("p",null,n.intl.formatMessage({id:"arXhRE",defaultMessage:"The security code is a 3 digit number on the back of your credit card. It immediately follows your main card number."})),r.createElement("h5",null,n.intl.formatMessage({id:"t6hm3E",defaultMessage:"American Express"})),r.createElement("p",null,n.intl.formatMessage({id:"yxdGmm",defaultMessage:"The security code is a 4 digit number on the front of your card, just above and to the right of your main card number."}))))}})),define("modules/clean/payments/cvv_hint_container",["require","exports","tslib","react","modules/clean/payments/cvv_hint","modules/clean/react/css","modules/clean/react/tooltip"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CvvHintContainer=t.CvvHintContainerView=void 0;var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setTooltipRef=function(e){t.tooltipRef=e},t.showTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.showTooltip():t.tooltipRef._show()},t.hideTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.hideTooltip():t.tooltipRef._hide()},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.targetDimensions;return r.createElement("div",{className:"cvv-hint-container"},r.createElement("div",{style:{left:e.left,top:e.top}},r.createElement(i.Tooltip,{position:i.TooltipPosition.BOTTOM_RIGHT,tooltip_contents:r.createElement(n.CvvHint,null),ref:this.setTooltipRef,is_focusable:!1},r.createElement("div",{style:{width:e.width,height:e.height}}))))},t})((r=a.__importStar(r)).Component);t.CvvHintContainerView=s,t.CvvHintContainer=o.requireCssWithComponent(s,["/static/css/payments/cvv_hint_container-vflDN68mD.css"])})),define("modules/clean/payments/skus/pricing_data",["require","exports","tslib","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/core/exception","modules/core/i18n"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PricingDataFromPlan=t.PricingDataOrion=t.PricingDataException=t.PricingDataFactory=void 0;var l=(function(){function e(){}return e.createFromState=function(e,t){var a=e.formData,r=e.pricingState,o=n.ProductPlanType.NEW_STANDARD,i=a.productPlanType.formattedValue||t.productPlanType||o,s=r.discountInfo&&r.discountInfo.discountPercentage;if(0!==r.subChangePlans.plans.length){var l=r.subChangePlans.withProductPlanType(i),c=l.yearly().plans.pop(),m=l.monthly().plans.pop(),f=Math.min(c&&c.nextBillingSummary.totalLicenses,m&&m.nextBillingSummary.totalLicenses);return m&&c?isNaN(f)||f<=0?u.NO_LICENSES:new p(r.subChangePlans,i,s):u.NO_PRODUCT_TYPE}switch(i){case n.ProductPlanType.NEW_STANDARD:return new d(t.orionPlanInfo.standard,s);case n.ProductPlanType.ADVANCED:return new d(t.orionPlanInfo.advanced,s);default:return void u.reportException({cause:u.NO_PRODUCT_TYPE,message:"Unable to calculate pricing data for unsupported product type",extra:{productPlanType:i}})}},e})();t.PricingDataFactory=l;var u=(function(){function e(){}return e.reportException=function(e){var t=e.cause,a=e.message,r=e.extra;i.reportStack(t+": "+a,{tags:["BusinessPaymentPages","PricingData"],severity:i.SEVERITY.CRITICAL,exc_extra:r})},e.NO_DATA_SOURCE="No data source",e.NO_LICENSES="No licenses",e.NO_TRANSITION="No transition",e.NO_PRODUCT_TYPE="No product type",e.INCOMPLETE_DATA_SOURCE="Incomplete data source",e.notifyErrorMessage=s.intl.formatMessage({id:"0UBmAV",defaultMessage:"We’re having some trouble right now. Please try again later or contact sales."}),e.notifyErrorMessagePersonal=s.intl.formatMessage({id:"KyRk6M",defaultMessage:"We’re having some trouble right now. Please try again later."}),e})();t.PricingDataException=u;var c=(function(){function e(e){this.promoDiscountPercentage=e||0}return Object.defineProperty(e.prototype,"doesTaxApply",{get:function(){var e,t;return Boolean(null===(t=null===(e=this.getYearlyPlanData())||void 0===e?void 0:e.tvm)||void 0===t?void 0:t.doesTaxApply)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseMonthlyPrice",{get:function(){var e,t;return null===(t=null===(e=this.getMonthlyPlanData())||void 0===e?void 0:e.nextBillingSummary)||void 0===t?void 0:t.base},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseYearlyPrice",{get:function(){var e,t;return null===(t=null===(e=this.getYearlyPlanData())||void 0===e?void 0:e.nextBillingSummary)||void 0===t?void 0:t.base},enumerable:!1,configurable:!0}),e.prototype.getPromoDiscount=function(){return this.promoDiscountPercentage},e.prototype.getTotalYearlyDiscountWithPromoInPercent=function(){var e=this.getMonthlyPerUserPrice();this.promoDiscountPercentage>0&&(e=this.baseMonthlyPrice.divide(this.getNumLicenses()));var t=e.subtract(this.getYearlyPerUserPrice());return Math.round(100*t.divide(e.amount).amount)},e.prototype.getYearlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getYearlyPrice(e),a=this.getNumLicenses();return a>0?t.divide(12).divide(a):t},e.prototype.getMonthlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getMonthlyPrice(e),a=this.getNumLicenses();return a>0?t.divide(a):t},Object.defineProperty(e.prototype,"monthlyPromoDiscount",{get:function(){return this.getMonthlyPriceWithoutPromo(!0).multiply(this.promoDiscountPercentage).divide(100)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearlyPromoDiscount",{get:function(){return this.getYearlyPriceWithoutPromo(this.doesTaxApply).multiply(this.promoDiscountPercentage).divide(100)},enumerable:!1,configurable:!0}),e.prototype.getMonthlyPriceWithoutPromo=function(e){return void 0===e&&(e=!1),this.promoDiscountPercentage>0?this.baseMonthlyPrice:this.getMonthlyPrice(e)},e.prototype.getYearlyPriceWithoutPromo=function(e){return void 0===e&&(e=!1),this.promoDiscountPercentage>0?this.baseYearlyPrice:this.getYearlyPrice(e)},e.prototype.getYearlySavingsWithoutPromo=function(){var e=this.getMonthlyPriceWithoutPromo(!0),t=this.getYearlyPriceWithoutPromo(!0);return e.multiply(12).subtract(t)},e.prototype.getYearlySavingsPercentage=function(){var e=this.getYearlySavingsWithoutPromo(),t=this.getMonthlyPriceWithoutPromo(!0).multiply(12),a=e.divide(t.amount).multiply(100);return Math.round(a.amount)},e.prototype.getTotalLicensePriceData=function(e){var t=this.getNumLicenses(),a=this.getMonthlyPriceWithoutPromo(!0);return e&&(a=a.multiply(12)),{numLicenses:t,totalLicensePrice:a}},e.prototype.getAnnualDiscountData=function(){return{savingsPercentage:this.getYearlySavingsPercentage(),savingsAmount:this.getYearlySavingsWithoutPromo()}},e.prototype.getPromoDiscountData=function(e){return{discountPercentage:this.promoDiscountPercentage,discountAmount:e?this.yearlyPromoDiscount:this.monthlyPromoDiscount}},e})(),p=(function(e){function t(t,a,r){var n=e.call(this,r)||this,o=t.withProductPlanType(a),i=o.yearly().plans.pop(),s=o.monthly().plans.pop();if(n.yearlySubChangePlan=i,n.monthlySubChangePlan=s,n.numLicenses=Math.min(i&&i.nextBillingSummary.totalLicenses,s&&s.nextBillingSummary.totalLicenses),!n.monthlySubChangePlan||!n.yearlySubChangePlan){var l=n.monthlySubChangePlan?"yearly":"monthly";u.reportException({cause:u.NO_TRANSITION,message:"Unable to find a "+l+" subChangePlan in PricingDataOrion",extra:{subChangePlans:t}})}return(isNaN(n.numLicenses)||n.numLicenses<=0)&&u.reportException({cause:u.NO_LICENSES,message:"Number of licenses is 0 in PricingDataOrion",extra:{yearlySubChangePlan:n.yearlySubChangePlan}}),n}return a.__extends(t,e),t.prototype.getPlanDisplayName=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displayName():""},t.prototype.getPlanDisplaySpace=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displaySpace():""},t.prototype.getMonthlyPlanData=function(){return this.monthlySubChangePlan},t.prototype.getYearlyPlanData=function(){return this.yearlySubChangePlan},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.yearlySubChangePlan?this.yearlySubChangePlan.finalSubState.minLicenseLimitForPlan||e:this.monthlySubChangePlan&&this.monthlySubChangePlan.finalSubState.minLicenseLimitForPlan||e},t.prototype.getNumLicenses=function(){return this.numLicenses},t.prototype.getYearlyPrice=function(e){var t;void 0===e&&(e=!1);var a=new r.Cash(0,"USD");if(null===(t=this.yearlySubChangePlan)||void 0===t?void 0:t.tvm){var n=this.yearlySubChangePlan,o=n.tvm,i=n.nextBillingSummary;if(a=this.yearlySubChangePlan.isOnTrial?(null==i?void 0:i.total)||a:o.getBilledPrice(),e&&o.doesTaxApply){var s=o.getTaxPrice();a=a.subtract(s)}}return a},t.prototype.getMonthlyPrice=function(e){var t;void 0===e&&(e=!1);var a=new r.Cash(0,"USD");if(null===(t=this.monthlySubChangePlan)||void 0===t?void 0:t.tvm){var n=this.monthlySubChangePlan,o=n.tvm,i=n.nextBillingSummary;if(a=this.monthlySubChangePlan.isOnTrial?(null==i?void 0:i.total)||a:o.getBilledPrice(),e&&o.doesTaxApply){var s=o.getTaxPrice();a=a.subtract(s)}}return a},t})(c);t.PricingDataOrion=p;var d=(function(e){function t(t,a){var r=e.call(this,a)||this;return r.planInfo=t,r}return a.__extends(t,e),t.prototype.getPlanDisplayName=function(){return this.planInfo.skuContent.name},t.prototype.getPlanDisplaySpace=function(){return o.SkuContentClient.deserialize(this.planInfo.skuContent).spaceShortFormTb()},t.prototype.getMonthlyPlanData=function(){},t.prototype.getYearlyPlanData=function(){},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.planInfo.minLicenseCount||e},t.prototype.getNumLicenses=function(){return this.getMinLicensesLimit()},t.disallowTaxCalculations=function(e){e||u.reportException({cause:u.INCOMPLETE_DATA_SOURCE,message:"Cannot calculate price with tax from plan info",extra:{}})},t.prototype.getYearlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),r.Cash.fromObject(this.planInfo.yearlyPrice)},t.prototype.getMonthlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),r.Cash.fromObject(this.planInfo.monthlyPrice)},t})(c);t.PricingDataFromPlan=d})),define("modules/clean/react/payments/business/state/business_state",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingFormSteps=t.BuyFormSteps=t.TryFormSteps=t.PAYMENT_INFO_STEP=t.PLAN_SELECTION_STEP=t.ACCOUNT_INFO_OR_CHECKOUT_STEP=t.SKU_SELECTION_STEP=t.TEAM_RESTORE_STEP=t.serverPropsToFields=t.fieldsToServerProps=void 0,t.fieldsToServerProps={accountHolderName:"owner_name",adyenEncryptedCard:"adyen_encrypted_card",encryptedCardForNetworkToken:"encrypted_card_for_network_token",bin:"bin",browserInfo:"browser_info",threeDsData:"three_ds_data",captcha:"recaptcha_response",companySize:"company_size",countryCode:"country_code",cpf:"cpf",cpfName:"cpf_name",email:"email",emailsToInvite:"emails_to_invite",firstName:"fname",iban:"iban",idealBankId:"bank_id",idealBankName:"bank_name",lastName:"lname",mandateSigned:"mandate_signed",marketingOptIn:"marketing_opt_in",nonce:"nonce",numberOfUsers:"team_num_users",password:"password",paymentMethod:"payment_method",payPalNonce:"paypal_nonce",schedule:"schedule_id",scheduleId:"schedule_id",selectedUser:"selected_user",teamName:"team_name",teamPhone:"team_phone",termsAndService:"tos_agree",vat:"vat",zipCode:"zip",city:"city",phone:"phone",name:"name",address:"address",applePayToken:"apple_pay_token"},t.serverPropsToFields={};for(var a=0,r=Object.keys(t.fieldsToServerProps);a<r.length;a++){var n=r[a],o=t.fieldsToServerProps[n];o&&(t.serverPropsToFields[o]=n)}t.TEAM_RESTORE_STEP=-1,t.SKU_SELECTION_STEP=0,t.ACCOUNT_INFO_OR_CHECKOUT_STEP=1,t.PLAN_SELECTION_STEP=2,t.PAYMENT_INFO_STEP=3,t.TryFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,accountInfoStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP,planSelectionStep:t.PLAN_SELECTION_STEP,paymentInfoStep:t.PAYMENT_INFO_STEP}},t.BuyFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}},t.BillingFormSteps=function(){return{teamRestoreStep:t.TEAM_RESTORE_STEP,skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}}})),define("modules/clean/react/payments/buy/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames","ts-key-enum"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabeledInputRow=t.LabeledSelectInput=t.LabeledRadioInput=t.LabeledCheckboxInput=t.LabeledTextInput=t.LabeledInput=void 0,r=a.__importDefault(r),n=a.__importDefault(n),o=a.__importDefault(o);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=o.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement)},this.props.className),t=this.props.containerClassName,a=r.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),n=null;this.props.labelAfterElement&&(n=a,a=null);var i,s=null;return this.props.secondaryLabel&&(s=r.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=r.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},this.props.errorText)),r.default.createElement("div",{className:t},a,this.props.children,n,s,i)},t})(r.default.Component);t.LabeledInput=s;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(t.input)},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.autocomplete,i=t.className,l=t.disabled,u=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,f=t.maxLength,h=t.containerClassName,y=t.placeholder,g=this.props.type||"text",_=o.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return r.default.createElement(s,{className:i,containerClassName:h,labelText:u,htmlFor:a,errorText:p,secondaryLabel:c},r.default.createElement("input",{autoComplete:n,className:_,type:g,placeholder:y,name:a,id:a,ref:function(t){e.input=t},value:m,disabled:l,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,maxLength:f}))},t})(r.default.Component);t.LabeledTextInput=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode&&" "!==e.key&&32!==e.charCode||(t.props.onClick(n.default.findDOMNode(t.input)),e.preventDefault()))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t.preventSpacebarScrolling=function(e){" "!==e.key&&32!==e.charCode||e.preventDefault()},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=n.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.containerClassName,l=t.disabled,u=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=o.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(l)},n);return r.default.createElement(s,{containerClassName:i,className:c,errorText:p,htmlFor:a,labelAfterElement:!0,labelText:u},r.default.createElement("div",{"aria-checked":d,"aria-labelledby":a,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyDown:this.preventSpacebarScrolling,onKeyUp:this.handleCheckboxChange,onBlur:this.onBlur}),r.default.createElement("input",{readOnly:!0,"aria-hidden":!0,tabIndex:-1,checked:d,disabled:l,id:a,name:a,ref:function(t){e.input=t},type:"checkbox"}))},t})(r.default.Component);t.LabeledCheckboxInput=u;var c=(function(e){function t(t){var a=e.call(this,t)||this;return a.focus=function(){null!==a.radio.current&&a.radio.current.focus()},a.handleClick=function(e){a.props.disabled?e.stopPropagation():a.focus()},a.handleRadioChange=function(e){a.props.disabled?e.stopPropagation():a.props.onClickOrChange&&(a.props.onClickOrChange(e,a.props.inputId,a.props.value),e.preventDefault())},a.handleRadioKeyUp=function(e){if(a.props.disabled)e.stopPropagation();else{(["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)||[9,37,38,39,40].includes(e.keyCode))&&a.props.onClickOrChange&&(e.preventDefault(),a.focus(),a.props.onClickOrChange(e,a.props.inputId,a.props.value))}},a.radio=r.default.createRef(),a}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.name,a=e.inputId,n=e.ariaLabelId,i=e.disabled,s=e.value,l=e.checked,u=e.labelSpan,c=e.labelClassName,p=o.default({input__radio:!0,"input__radio--valid":Boolean(l),"input__radio--disabled":Boolean(i)},this.props.className),d=l?0:-1;return r.default.createElement("label",{htmlFor:s,className:c},r.default.createElement("span",{className:p,onClick:this.handleClick},r.default.createElement("input",{"aria-labelledby":n,ref:this.radio,type:"radio",name:t,id:a,value:s,tabIndex:d,"aria-checked":Boolean(l),checked:Boolean(l),onChange:this.handleRadioChange,onKeyUp:this.handleRadioKeyUp,disabled:i}),u))},t})(r.default.Component);t.LabeledRadioInput=c;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.containerClassName,l=t.hasError,u=t.labelClassName,c=t.labelText,p=t.errorText,d=t.autoComplete,m=o.default({input__select:!0,"input__select--error":Boolean(p)||l},n);return r.default.createElement(s,{containerClassName:i,className:u,errorText:p,htmlFor:a,labelText:c},r.default.createElement("select",{className:m,id:a,name:a,onChange:this.onChange,onBlur:this.onBlur,value:this.props.value,autoComplete:d,ref:function(t){e.input=t}},this.props.children))},t})(r.default.Component);t.LabeledSelectInput=p;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e,t){return r.default.createElement("div",{className:e.className,key:e.name+"-"+t},r.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(r.default.Component);t.LabeledInputRow=d})),define("modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabeledCheckboxInput=void 0,r=a.__importDefault(r),n=a.__importStar(n);var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.findDOMNode(t.input))},t}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(n.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.labelText,s=t.errorText,l=t.errorHTML,u=t.checked,c=t.disabled;return r.default.createElement(o.LabeledInput,{className:n,errorHTML:l,errorText:s,htmlFor:a,labelAfterElement:!0,labelText:i},r.default.createElement("input",{checked:u,disabled:c,id:a,name:a,onChange:this.onChange.bind(this),onBlur:this.onBlur,ref:function(t){e.input=t},type:"checkbox"}))},t})(r.default.Component);t.LabeledCheckboxInput=i})),define("modules/clean/react/payments/checkout/components/inputs/labeled_input",["require","exports","tslib","classnames","dompurify","react","modules/core/browser_detection","modules/clean/react/tooltip","modules/clean/react/sprite"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabeledInput=void 0,r=a.__importDefault(r),n=a.__importStar(n),o=a.__importDefault(o),i=a.__importStar(i);var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=r.default({"input__label--errormodal":Boolean(this.props.errorText),"input-with-inline-tooltip":Boolean(this.props.inlineTooltipText)},this.props.className,"label-input","input__label"),t=o.default.createElement("label",{className:"label "+(this.props.labelClass?this.props.labelClass:""),htmlFor:this.props.htmlFor},this.props.labelText),a=null;this.props.labelAfterElement&&(a=t,t=null);var u=null;u=this.props.rightLabelElement?o.default.createElement("div",{className:"grid__item grid--x-bookend"},t,o.default.createElement("div",null,this.props.rightLabelElement)):t;var c=null;this.props.errorText?c=this.props.errorText:this.props.errorHTML&&(c=o.default.createElement("span",{dangerouslySetInnerHTML:{__html:n.sanitize(this.props.errorHTML)}}));var p=o.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},c),d=null;if(this.props.inlineTooltipText){var m=i.is_supported_mobile_browser()?s.TooltipPosition.BOTTOM:s.TooltipPosition.RIGHT,f=o.default.createElement(s.Tooltip,{tooltip_classname:"input__inline-tooltip-bubble",position:m,tooltip_contents:this.props.inlineTooltipText},o.default.createElement(l.Sprite,{group:"web",name:"info",alt:""}));d=o.default.createElement("span",{className:"grid__item grid--y-middle input__tooltip--inline"},f)}return o.default.createElement("div",{className:e},u,d,this.props.children,a,p)},t})(o.default.Component);t.LabeledInput=u})),define("modules/clean/react/payments/checkout/components/inputs/labeled_text_input",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BizLabeledTextInput=void 0,r=a.__importDefault(r),n=a.__importDefault(n),o=a.__importStar(o);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(o.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(o.findDOMNode(t.input))},t.onChange=function(e){t.props.onChange&&t.props.onChange(o.findDOMNode(t.input))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.autoComplete,o=t.className,s=t.disabled,l=t.errorHTML,u=t.errorText,c=t.inlineTooltipText,p=t.labelAfterElement,d=t.labelClass,m=t.labelText,f=t.maxLength,h=t.name,y=t.placeholder,g=t.value,_=this.props.type||"text",v=r.default({input__text:!0,"input__text--errormodal":Boolean(u)},this.props.inputClassName);return n.default.createElement(i.LabeledInput,{className:o,errorHTML:l,errorText:u,htmlFor:h,inlineTooltipText:c,labelAfterElement:p,labelClass:d,labelText:m},n.default.createElement("input",{autoComplete:a,className:v,type:_,name:h,id:h,ref:function(t){e.input=t},value:null===g?"":g,disabled:s,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:f,placeholder:y}))},t})(n.default.Component);t.BizLabeledTextInput=s})),define("modules/clean/react/payments/checkout/components/inputs/labeled_select_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BizLabeledSelectInput=void 0,r=a.__importDefault(r),n=a.__importStar(n);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(n.findDOMNode(this.input))},t.prototype.onClick=function(e){this.props.onClick&&this.props.onClick(n.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,n=t.className,i=t.labelClass,s=t.labelText,l=t.rightLabelElement,u=t.errorText,c=t.errorHTML,p=t.autoComplete;return r.default.createElement(o.LabeledInput,{className:n,errorHTML:c,errorText:u,labelClass:i,htmlFor:a,labelText:s,rightLabelElement:l},r.default.createElement("select",{autoComplete:p,className:"option-selector",id:a,name:a,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(r.default.Component);t.BizLabeledSelectInput=i})),define("modules/clean/react/payments/checkout/components/payment_method_form/address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_select_input","modules/clean/react/payments/common/constants"],(function(e,t,a,r,n,o,i,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddressForms=void 0;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCountryCodeChange=function(e){t.props.actions.updateCountryCode(e.value)},t.onZipCodeBlur=function(e){t.props.actions.showFormFieldErrors(["zipCode"],"ZipCodeBlur"),t.props.actions.blurZipCode(e.value)},t.onZipCodeChange=function(e){t.props.actions.updateZipCode(e.value)},t}return a.__extends(t,e),t.prototype.renderCountrySelector=function(e){var t=this,a="grid__item--2-3";e?a="grid__item":this.props.isInModal||(a="grid__item--fluid grid__item--margin-right--1-24");var i=this.props.countryList.map((function(e){var a=e[0],n=e[1];return r.default.createElement("option",{key:"location-"+a,value:a,"aria-selected":a===t.props.formData.countryCode.formattedValue},n)}));return 1==this.props.businessStyling?r.default.createElement(l.BizLabeledSelectInput,{autoComplete:"country",className:a,labelText:n.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange.bind(this),value:this.props.formData.countryCode.rawValue},i):r.default.createElement(o.LabeledSelectInput,{autoComplete:"country",className:"payment-info__country",containerClassName:a,labelText:n.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},i)},t.prototype.zipCodeErrorString=function(){var e=this.props.formData.zipCode;return!s.FormValueHelper.isValid(e)&&e.showError?"US"===this.props.formData.countryCode.formattedValue?n.intl.formatMessage({id:"kWjJlf",defaultMessage:"Please enter a valid billing ZIP code."}):u.ZipCodeErrorMessage:""},t.prototype.renderBillingFields=function(){return!0===this.props.businessStyling?r.default.createElement(r.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput()):r.default.createElement(o.LabeledInputRow,{className:"payment-info__location grid__item grid--x-bookend grid--y-top"},this.renderCountrySelector(!1),this.renderZipCodeInput())},t.prototype.renderZipCodeInput=function(e){void 0===e&&(e=!1);var t=n.intl.formatMessage({id:"5kJrVX",defaultMessage:"Postal Code"}),a="US"===this.props.formData.countryCode.formattedValue?n.intl.formatMessage({id:"ciLB6A",defaultMessage:"Billing ZIP"}):t,s=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue),l=this.props.formData.zipCode.errorState&&this.props.formData.zipCode.showError;if(!0===this.props.businessStyling)return r.default.createElement(i.BizLabeledTextInput,{autoComplete:"postal-code",className:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:s,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:a,name:"zip",onChange:this.onZipCodeChange.bind(this),value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur.bind(this)});var u=e?"grid__item--fluid grid__item--margin-right--1-24":"grid__item--fluid",c=this.zipCodeErrorString();return r.default.createElement(o.LabeledTextInput,{className:"payment-info__zip",containerClassName:u,name:"zip",autocomplete:"postal-code",labelText:a,value:this.props.formData.zipCode.rawValue,hasError:Boolean(l),disabled:s,onBlur:this.onZipCodeBlur,onChange:this.onZipCodeChange,errorText:c})},t.prototype.render=function(){return this.renderBillingFields()},t})((r=a.__importDefault(r)).default.Component);t.AddressForms=c})),define("modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame",["require","exports","tslib","react","react-dom","modules/clean/ajax","classnames","modules/core/exception","modules/core/notify","modules/core/i18n","modules/clean/payments/cvv_hint_container","modules/clean/react/payments/common/form/actions/actions","modules/clean/payments/payment_form/iframe_rpc","modules/clean/payments/three_ds_helper","modules/clean/metrics/index","apex-metrics/index"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d,m,f,h){"use strict";function y(){var e={};return e.promise=new Promise((function(t,a){e.resolve=t,e.reject=a})),e}Object.defineProperty(t,"__esModule",{value:!0}),t.CreditCardFrame=void 0,r=a.__importDefault(r),n=a.__importStar(n),o=a.__importStar(o),i=a.__importDefault(i),s=a.__importStar(s);var g=(function(e){function t(t){var r=e.call(this,t)||this;return r.timeInitialized=null,r.timeBeforeFetchBraintreeToken=null,r.timeBeforeFetchAdyenKey=null,r.timeBeforeTokenize=null,r.setCvvHintContainerRef=function(e){r.cvvHintContainerRef=e},r.setIframeRef=function(e){r.iframeRef=e},r.submitThreeDsChallenge=function(){r.props.submitForm(p.SubmitFormTriggerType.ThreeDsChallenge)},r.submitThreeDsFingerprint=function(){r.props.submitForm(p.SubmitFormTriggerType.ThreeDsFingerprint)},r.showTooltip=function(e,t){if("cvv"===e){var o=r.iframeRef.getBoundingClientRect(),i=n.findDOMNode(r.cvvHintContainerRef).getBoundingClientRect(),s=o.left-i.left,l=o.top-i.top,u={left:t.left+s,top:t.top+l,width:t.width,height:t.height};r.setState((function(e){return a.__assign(a.__assign({},e),{cvvHintDimensions:u})})),r.cvvHintContainerRef&&r.cvvHintContainerRef.getWrappedComponent().showTooltip()}},r.hideTooltip=function(e){"cvv"===e&&r.cvvHintContainerRef&&r.cvvHintContainerRef.getWrappedComponent().hideTooltip()},r.handle3DsMessage=function(e){r.threeDsHandler&&r.threeDsHandler.handle3DsMessage(e)},r.iframeReady=!1,r.state={cvvHintDimensions:{left:0,top:0,width:0,height:0},iframeFormHeight:null},r.timeInitialized=Date.now(),r}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.logLatency(this.timeInitialized,"componentDidMount"),this.isSeleniumChangesTest())return this.props.actions.updateNonce("fake-valid-nonce",{ccn:{error:!1},ccode:{error:!1},ccexp:{error:!1}}),void this.props.actions.updateBIN("457173");this.braintreeTokenLoaded=y(),this.adyenKeyLoaded=y(),this.iFrameRpcListener=new d.IFrameRpcListener(this.getCCIframeOrigin(),this);var e=frames.cc_iframe.window;this.iframeMessageTransport=new d.IFrameRpcTransport(this.props.iframeUrl,e),this.pingIframe()},t.prototype.componentWillUnmount=function(){this.isSeleniumChangesTest()||this.iFrameRpcListener.removeMessageListener()},t.prototype.componentWillReceiveProps=function(e){e.nonce.showError&&this.showFormErrors()},t.prototype.render=function(){var e=this.props,t=e.hidden,a=e.iframeUrl,n=i.default({grid__item:!0,hidden:t}),o=i.default("iframe-holder iframe-holder--full-width",{"iframe-holder--responsive":this.props.isResponsive}),s={};return this.props.getHeightFromIframe&&(s={height:this.state.iframeFormHeight}),r.default.createElement("div",{id:"iframe-holder",className:n},r.default.createElement(c.CvvHintContainer,{targetDimensions:this.state.cvvHintDimensions,ref:this.setCvvHintContainerRef}),r.default.createElement("div",{className:o,style:s,ref:this.setIframeRef},r.default.createElement("iframe",{src:a,name:"cc_iframe",frameBorder:"0",title:u.intl.formatMessage({id:"ljVFCM",defaultMessage:"Form for entering credit card information"})})))},t.prototype.isSeleniumChangesTest=function(){return""===this.props.iframeUrl&&!1},t.prototype.getCCIframeOrigin=function(){var e=this.props.iframeUrl.split("/");return e[0]+"//"+e[2]},t.prototype.startServerTimeUpdate=function(){var e=this,t=function(t,a,r){var n=JSON.parse(t);if(n&&n.hasOwnProperty("server_time")){var o={serverTime:n.server_time};e.iframeMessageTransport.sendMessage(d.IFrameRpc.SET_SERVER_TIME,o)}e.startServerTimeUpdate()},a=function(t,a,r){e.startServerTimeUpdate()};setTimeout((function(){o.BackgroundRequest({url:"/credit_card_secrets/server_time",type:"GET",success:t,error:a})}),216e5)},t.prototype.encryptWithAdyen=function(){var e=this;return this.adyenEncrypting?this.adyenEncryptionDeferred.promise:(this.adyenEncrypting=!0,this.adyenEncryptionDeferred=y(),this.isSeleniumChangesTest()?this.submitEncryptedAdyenCard("brisket"):this.adyenKeyLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(d.IFrameRpc.ENCRYPT_WITH_ADYEN)})),this.adyenEncryptionDeferred.promise)},t.prototype.encryptForNetworkToken=function(){return this.networkTokenEncrypting?this.networkTokenEncryptionDeferred.promise:(this.networkTokenEncrypting=!0,this.networkTokenEncryptionDeferred=y(),this.isSeleniumChangesTest()?this.submitEncryptedCardForNetworkToken("mastercard","test_for_network_token"):this.iframeMessageTransport.sendMessage(d.IFrameRpc.ENCRYPT_FOR_NETWORK_TOKEN),this.networkTokenEncryptionDeferred.promise)},t.prototype.tokenizeWithBraintree=function(){var e=this;return this.braintreeTokenizing?this.braintreeTokenizingDeferred.promise:(this.braintreeTokenizing=!0,this.braintreeTokenizingDeferred=y(),this.isSeleniumChangesTest()?this.submitTokenized("fake-valid-nonce","457173"):this.braintreeTokenLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(d.IFrameRpc.TOKENIZE)})),this.braintreeTokenizingDeferred.promise)},t.prototype.tokenize=function(){return this.timeBeforeTokenize=Date.now(),this.encryptWithAdyen(),this.encryptForNetworkToken(),Promise.all([this.tokenizeWithBraintree()]).then((function(e){for(var t=!0,a=0,r=e;a<r.length;a++){var n=r[a];t=t&&n}return t}))},t.prototype.submitTokenized=function(e,t){this.props.actions.updateNonce(e),this.props.actions.updateBIN(t),this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!0),this.logLatency(this.timeBeforeTokenize,"BrainTreeEncryption")},t.prototype.submitEncryptedAdyenCard=function(e){var t=m.collectBrowserInfo();t&&this.props.actions.updateBrowserInfo(t),this.props.actions.updateAdyenEncryptedCard(e),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!0),this.logLatency(this.timeBeforeTokenize,"AdyenEncryption")},t.prototype.submitEncryptedCardForNetworkToken=function(e,t){this.props.actions.updateEncryptedCardForNetworkToken(e,t),this.networkTokenEncrypting=!1,this.networkTokenEncryptionDeferred.resolve(!0),this.logLatency(this.timeBeforeTokenize,"NetworkTokenEncryption")},t.prototype.logLatency=function(e,t){if(e){var a=Date.now()-e;f.getMetricsReporter().createStats({ns:"payments_frontend",name:"iframe_latency"},{category:t}).recordDuration(a,h.TimeUnit.MILLISECONDS)}},t.prototype.originReady=function(e){var t=this;this.iframeReady||(this.iframeReady=!0,this.logLatency(this.timeInitialized,"iframeReady"),this.isSeleniumChangesTest()||(this.iframeMessageTransport.sendMessage(d.IFrameRpc.READY),this.iframeMessageTransport.sendMessage(d.IFrameRpc.INIT_NETWORK_TOKEN,{isProd:!0}),this.timeBeforeFetchBraintreeToken=Date.now(),this.fetchBraintreeToken().then((function(e){t.iframeMessageTransport.sendMessage(d.IFrameRpc.INIT_BRAINTREE,{token:e}),t.braintreeTokenLoaded.resolve(!0),t.logLatency(t.timeBeforeFetchBraintreeToken,"fetchBraintreeToken")})).catch((function(){l.Notify.error(u.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"})),t.logLatency(t.timeBeforeFetchBraintreeToken,"fetchBraintreeTokenError")})),this.timeBeforeFetchAdyenKey=Date.now(),this.fetchAdyenKey().then((function(e){t.iframeMessageTransport.sendMessage(d.IFrameRpc.INIT_ADYEN,e),t.adyenKeyLoaded.resolve(!0),t.logLatency(t.timeBeforeFetchAdyenKey,"fetchAdyenKey")})).catch((function(){l.Notify.error(u.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"})),t.logLatency(t.timeBeforeFetchAdyenKey,"fetchAdyenKeyError")})),this.threeDsHandler=new m.ThreeDsHandler({updateThreeDsData:this.props.actions.updateThreeDsData,submitThreeDsChallenge:this.submitThreeDsChallenge,triggerThreeDsChallenge:this.props.actions.triggerThreeDsChallenge,submitThreeDsFingerprint:this.submitThreeDsFingerprint,triggerThreeDsFingerprint:this.props.actions.triggerThreeDsFingerprint,isDesktop:!1,isSeleniumChangesTest:this.isSeleniumChangesTest()})))},t.prototype.fetchAdyenKey=function(e,t){var a=this;void 0===e&&(e=2),void 0===t&&(t=y());return o.BackgroundRequest({url:"/credit_card_secrets/adyen_key",type:"GET",success:function(e,r,n){var o=JSON.parse(e);if(o&&o.hasOwnProperty("key")&&o.hasOwnProperty("server_time")){var i={key:o.key,serverTime:o.server_time};t.resolve(i)}else t.reject(u.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}));a.startServerTimeUpdate()},error:function(r,n,o){a.tokenErrorHandler(e,a.fetchAdyenKey,t,r,"get adyen key failed:",["fetch_adyen_key_failed"],o)}}),t.promise},t.prototype.fetchBraintreeToken=function(e,t){var a=this;void 0===e&&(e=2),void 0===t&&(t=y());return o.BackgroundRequest({url:"/payments/braintree_token",success:function(e,a,r){try{var n=JSON.parse(e);if(!n||!n.hasOwnProperty("token"))throw new Error("Invalid response from server");t.resolve(n.token)}catch(e){t.reject(u.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}))}},error:function(r,n,o){a.tokenErrorHandler(e,a.fetchBraintreeToken,t,r,"ajax /braintree_token failed:",["fetch_braintree_token_failed"],o)}}),t.promise},t.prototype.tokenErrorHandler=function(e,t,a,r,n,o,i){if(--e>0)setTimeout((function(){t(e,a)}),2e3);else{var l=n+" "+(JSON.stringify(r.status)+", "+r.statusText+", "+r.readyState);s.reportException({err:new Error(l),severity:s.SEVERITY.CRITICAL,tags:o}),a.reject(i)}},t.prototype.pingIframe=function(){var e=this;this.iframeReady||(this.pingTimeoutLogged||(this.firstPing?(new Date).getTime()-this.firstPing>12e4&&(s.reportException({err:new Error("PCI iFrame timeout"),severity:s.SEVERITY.NONCRITICAL,tags:["iframe_ping_timeout"]}),this.pingTimeoutLogged=!0):this.firstPing=(new Date).getTime()),this.iframeMessageTransport.sendMessage(d.IFrameRpc.READY),setTimeout((function(){e.pingIframe()}),250))},t.prototype.showCvvModal=function(){},t.prototype.showFormErrors=function(){this.isSeleniumChangesTest()||this.iframeMessageTransport.sendMessage(d.IFrameRpc.SHOW_FORM_ERRORS)},t.prototype.focusOutsideIframe=function(){},t.prototype.handleValidationFailure=function(e){this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!1),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!1),this.networkTokenEncrypting=!1,this.networkTokenEncryptionDeferred.resolve(!1)},t.prototype.handleDataStatusUpdate=function(e){},t.prototype.handleValidationUpdate=function(e){this.props.actions.updateNonce(this.props.nonce.rawValue,e),this.props.actions.updateBIN(this.props.bin.rawValue)},t.prototype.handleSizeUpdate=function(e){this.setState({iframeFormHeight:e})},t.prototype.handleBlurField=function(e){this.props.actions.blurCCField(e)},t.defaultProps={isResponsive:!1},t})(r.default.Component);t.CreditCardFrame=g})),define("modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form",["require","exports","tslib","react","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/i18n","modules/clean/react/sprite_div","modules/clean/react/tooltip"],(function(e,t,a,r,n,o,i,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectDebitForm=void 0,r=a.__importDefault(r),l=a.__importDefault(l);var c=(u=a.__importStar(u)).Tooltip,p=u.TooltipPosition,d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAccountHolderNameBlur=function(e){t.props.actions.showFormFieldErrors(["accountHolderName"],"AccountHolderNameBlur"),t.props.actions.blurAccountHolderName(e.value)},t.onIBANBlur=function(e){t.props.actions.showFormFieldErrors(["iban"],"IBANBlur"),t.props.actions.blurIBAN(e.value)},t}return a.__extends(t,e),t.prototype.onAccountHolderNameChange=function(e){this.props.actions.updateAccountHolderName(e.value)},t.prototype.onIBANChange=function(e){this.props.actions.updateIBAN(e.value)},t.prototype.onMandateSignedChange=function(e){this.props.actions.updateMandateSigned(e.checked)},t.prototype.onMandateSignedBlur=function(e){this.props.actions.showFormFieldErrors(["mandateSigned"],"MandateSignedBlur")},t.prototype.accountHolderNameErrorString=function(){var e=this.props.formData.accountHolderName;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"lVEpBU",defaultMessage:"Please enter the account holder’s name."}):""},t.prototype.ibanErrorString=function(){var e=this.props.formData.iban;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"jqBL8f",defaultMessage:"Please enter a valid bank account number."}):""},t.prototype.mandateSignedErrorString=function(){var e=this.props.formData.mandateSigned;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"X6vQlG",defaultMessage:"Please agree to the SEPA mandate terms by clicking on this check box."}):""},t.prototype.renderIBANLabel=function(){var e=r.default.createElement(l.default,{group:"web",name:"info"}),t=s.intl.formatMessage({id:"yIGH7D",defaultMessage:"An International Bank Account Number (IBAN) is a unique identification code for a bank account. It’s made up of a two-letter country code and up to 30 alphanumeric characters. Check your bank statements or ask your bank for your IBAN."}),a=r.default.createElement(c,{tooltip_classname:"iban-label-tooltip-bubble",position:p.RIGHT,tooltip_contents:t},e);return r.default.createElement("span",{className:"grid__item grid--y-middle"},s.intl.formatMessage({id:"6BVmpd",defaultMessage:"IBAN"}),a)},t.prototype.render=function(){var e=this.props.formData,t=s.intl.formatMessage({id:"Pb48Th",defaultMessage:"I hereby authorize Dropbox International Unlimited Company, and its payment service provider, Adyen Client Management, to collect payments from my account via direct debit. At the same time, I instruct my bank to honor the direct debits drawn on my account. Notice: Within eight weeks, beginning with the debit date, I am entitled to claim a refund of the debited amount. In this case the terms and conditions agreed with my bank shall apply."});return r.default.createElement("div",{id:"sepa-direct-debit-form",className:"direct-debit-container"},r.default.createElement("div",{className:"direct-debit-fields"},r.default.createElement(o.BizLabeledTextInput,{name:"owner_name",labelText:s.intl.formatMessage({id:"vj7NTF",defaultMessage:"Account holder name"}),value:e.accountHolderName.rawValue,errorText:this.accountHolderNameErrorString(),errorHTML:e.accountHolderName.serverError,onBlur:this.onAccountHolderNameBlur,onChange:this.onAccountHolderNameChange.bind(this)}),r.default.createElement(o.BizLabeledTextInput,{name:"iban",labelText:this.renderIBANLabel(),value:e.iban.rawValue,errorText:this.ibanErrorString(),errorHTML:e.iban.serverError,onBlur:this.onIBANBlur,onChange:this.onIBANChange.bind(this)})),this.props.locationFields,r.default.createElement(i.LabeledCheckboxInput,{checked:e.mandateSigned.rawValue,className:"billing-mandate-signed",errorHTML:e.mandateSigned.serverError,errorText:this.mandateSignedErrorString(),labelText:t,name:"mandate_signed",onBlur:this.onMandateSignedBlur.bind(this),onChange:this.onMandateSignedChange.bind(this)}))},t})(r.default.Component);t.DirectDebitForm=d})),define("modules/clean/react/payments/checkout/components/payment_method_form/apple_pay",["require","exports","tslib","modules/clean/react/payments/common/form/actions/actions","modules/clean/ajax_as_promised","modules/core/notify","modules/core/i18n","modules/core/exception","modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMerchantIdentifier=t.processPaymentResponse=t.fetchPaymentSession=t.applePayAction=void 0,s=a.__importStar(s);var u=i.intl.formatMessage({id:"OVUDyw",defaultMessage:"We weren't able to process your payment. Double check the payment info and try again. If that doesn't work, try another payment method or contact your bank"});function c(e,t){return n.BackgroundRequest({url:"/payments/apple_pay_session",type:"GET",data:{session_url:t}}).then((function(t){var a=JSON.parse(t);return a&&a.hasOwnProperty("session")?JSON.parse(a.session):(s.reportStack("Apple Pay Error (No Payment Session from Server Response)",{severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(r.applePayError("Step 1 - Blocked by No Payment Session")),e(r.paymentBannerError(u)),Promise.reject("No payment session from server response"))})).catch((function(t){return s.reportException({err:new Error("Apple Pay Error (No Payment Session from Server Response) "+t),severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(r.applePayError("Step 1 - Blocked by ERROR getting Payment Session")),e(r.paymentBannerError(u)),Promise.reject("error in getting payment session from server")}))}function p(e,t){var a=t.details,n=btoa(JSON.stringify(a.token.paymentData));e(r.updateApplePayToken(n))}function d(){return"merchant.dropbox.com"}t.applePayAction=function(e){var t=this,n=e.planName,i=e.price;return function(e){return a.__awaiter(t,void 0,void 0,(function(){var t,m,f,h,y,g,_,v,P;return a.__generator(this,(function(a){switch(a.label){case 0:if(!window.PaymentRequest)return[3,5];if(t={supportedMethods:"https://apple.com/apple-pay",data:{version:3,merchantIdentifier:d(),merchantCapabilities:["supports3DS","supportsCredit","supportsDebit"],supportedNetworks:["amex","discover","masterCard","visa"],countryCode:i.taxCountryCode}},e(r.applePayStartup("Step 0 - Trying to Initialize")),void 0===i.taxAmount||void 0===i.totalPrice||void 0===i.currency)return o.Notify.error(u),s.reportException({err:new Error("Apple Pay Error transition prices are undefined "),severity:s.SEVERITY.OPERATIONAL,tags:["applepay","payments"],exc_extra:{prices:i}}),e(r.paymentBannerError(u)),[2,Promise.resolve(!1)];m=i.taxAmount.amount,f=i.totalPrice.amount,h=i.currency,y=[t],g={total:{label:n,amount:{value:f.toString(),currency:h}},displayItems:[{label:n,amount:{value:(f-m).toString(),currency:h}}]},m>0&&g.displayItems.push({label:l.getTaxNameForCountry(i.taxCountryCode,void 0),amount:{value:m.toString(),currency:h}}),(_=new PaymentRequest(y,g,{})).onmerchantvalidation=function(t){var a=c(e,t.validationURL);t.complete(a)},a.label=1;case 1:return a.trys.push([1,3,,4]),e(r.applePayPopupShown("Step 2 - Payment Session OK - Showing")),[4,_.show()];case 2:return v=a.sent(),p(e,v),e(r.applePayClosedBySuccess("Step 3 - Payment response processed - closing")),v.complete("success"),[2,Promise.resolve(!0)];case 3:return(P=a.sent())&&"AbortError"===P.name?(s.reportException({err:new Error("Apple Pay User Aborted Most Likely: "+P),severity:s.SEVERITY.NONCRITICAL,tags:["applepay","payments"]}),[2,Promise.resolve(!1)]):(s.reportException({err:new Error("Apple Pay Error (Most Likely NOT User Abort) "+P),severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(r.applePayError("Step 2 - User Failed to Pay or Display")),e(r.paymentBannerError(u)),[2,Promise.resolve(!1)]);case 4:return[3,6];case 5:return[2,Promise.resolve(!1)];case 6:return[2]}}))}))}},t.fetchPaymentSession=c,t.processPaymentResponse=p,t.getMerchantIdentifier=d})),define("modules/clean/react/payments/common/constants",["require","exports","modules/core/i18n"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NameErrorMessage=t.CityErrorMessage=t.AddressErrorMessage=t.ZipCodeErrorMessage=t.PricingToggleAnnual=t.PricingToggleMonthly=t.PricingToggleCookie=void 0,t.PricingToggleCookie="pricing-schedule",t.PricingToggleMonthly="monthly",t.PricingToggleAnnual="annual",t.ZipCodeErrorMessage=a.intl.formatMessage({id:"CAxLNf",defaultMessage:"Please enter a valid postal code."}),t.AddressErrorMessage=a.intl.formatMessage({id:"0Mt769",defaultMessage:"Please enter a valid address."}),t.CityErrorMessage=a.intl.formatMessage({id:"RF+x3N",defaultMessage:"Please enter a valid city/town."}),t.NameErrorMessage=a.intl.formatMessage({id:"OSqOkI",defaultMessage:"Please enter the card holder name."})})),define("modules/clean/react/payments/common/form_value_factory",["require","exports","tslib","modules/clean/react/payments/common/form_values","modules/clean/payments/validation","modules/clean/datetime"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormValueFactory=void 0,r=a.__importStar(r);var i=(function(){function e(){}return e.createInput=function(e,t){var a=e&&!!e.trim();return{rawValue:e,formattedValue:e,errorState:a?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(!a||!t)&&t.showError,serverError:""}},e.createCheckbox=function(e,t,a){var n=a||e?r.InputErrorState.Valid:r.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:n,showError:!(n===r.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createProductPlanType=function(e,t,a){var n=!1;return e&&t&&(n=0===t.plans.length||t.withProductPlanType(e).plans.length>0),{rawValue:e,formattedValue:e,errorState:n?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!1,serverError:""}},e.createSchedule=function(e){return{rawValue:e,formattedValue:e,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createTrialEndDate=function(e,t){var a="";if(t&&e){var n=t.replace("_","-");a=o.daysAfterToday(e).toLocaleDateString(n,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}return{rawValue:a,formattedValue:a,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createNumberOfUsers=function(e,t,a,n,o){var i,s,l,u,c=t.minNumUsers,p=t.maxNumUsers,d=e,m=parseInt(d,10),f=!isNaN(m);f?(i=m<n,s=m<c,u=m>p,l=0!==o&&m<o+1,m=Math.min(Math.max(m,n),p)):(i=!1,s=!1,u=!1,l=!1,m=c);var h=f&&!s&&!l&&!u;return{rawValue:d,formattedValue:m,errorState:h?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(h||!a)&&a.showError,isUnderLicenseLimit:i,isUnderLimit:s,isOverLimit:u,minLicenseLimit:n,minNumUsers:c,maxNumUsers:p,serverError:""}},e.createEmail=function(e,t){var a=e.trim(),n=r.EmailErrorState.Valid;if(a){var o=a.split("@");if(2!==o.length)n=r.EmailErrorState.NoAt;else{var i=o[0],s=o[1],l=new RegExp("^([a-z0-9][a-z0-9\\-]*\\.)+([a-z]+|xn--[a-z0-9\\-]+)$","i");/^[\w!#$%&'*+\-\/=?^`{|}~.]+$/.test(i)?(!s||/^[\x00-\x7f]*$/.test(s)&&!l.test(s))&&(n=r.EmailErrorState.BadDomain):n=r.EmailErrorState.BadUsername}}else n=r.EmailErrorState.Empty;return{rawValue:e,formattedValue:a,errorState:n,showError:n!==r.EmailErrorState.Valid&&!!t&&t.showError,serverError:"",isCapturable:!1}},e.createTeamPhone=function(e,t){var a=r.TeamPhoneErrorState.Valid;return e||(a=r.TeamPhoneErrorState.Empty),{rawValue:e,formattedValue:e,errorState:a,showError:!(a===r.TeamPhoneErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPassword=function(e,t){var a=r.PasswordErrorState.Valid;return e&&e.length<6?a=r.PasswordErrorState.TooShort:e||(a=r.PasswordErrorState.Empty),{rawValue:e,formattedValue:e,errorState:a,showError:!(a===r.PasswordErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPaymentMethod=function(e,t,a,n){return a.available_payment_methods_for_country(t).indexOf(e)<0&&(e=a.default_payment_method_for_country(t)),{rawValue:e,formattedValue:e,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createCountryCode=function(e,t){var a=e?r.InputErrorState.Valid:r.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:a,showError:!(a===r.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createAddress=function(e,t){var a=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:a?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(a||!t)&&t.showError,serverError:""}},e.createPhone=function(e,t){var a=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:a?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(a||!t)&&t.showError,serverError:""}},e.createCity=function(e,t){var a=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:a?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(a||!t)&&t.showError,serverError:""}},e.createName=function(e,t){var a=e&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:a?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(a||!t)&&t.showError,serverError:""}},e.createZipCode=function(e,t,a,n){var o=!0,i=/\s+$/gi;if(a.allow_zip_code_for_country(t))if("US"===t){/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(e.replace(i,""))||(o=!1)}else(!e||e.length>15||""===e.trim())&&(o=!1);else e="";var s=o?r.InputErrorState.Valid:r.InputErrorState.Invalid,l=!(o||!n)&&n.showError,u=o?e.replace(i,"").replace(".",""):"";return{rawValue:e,formattedValue:u,errorState:s,showError:l,serverError:""}},e.createVat=function(e,t,a){var o=r.InputErrorState,i=o.Valid,s=o.Invalid,l=e.replace(/\s+/gi,""),u=n.validateVat(t,l)?i:s;return{rawValue:e,formattedValue:l,errorState:u,showError:!(u===i||!a)&&a.showError,serverError:""}},e.createCpf=function(e,t,a){var o,i=r.InputErrorState,s=i.Valid,l=i.Invalid,u=e.replace(/[^\d]+/g,"");return{rawValue:e,formattedValue:u,errorState:o=""===e&&a?s:n.validateCpf(u)?s:l,showError:!(o===s||!t)&&t.showError,serverError:""}},e.createCpfName=function(e,t,a){var n=e&&!!e.trim()||""===e&&a;return{rawValue:e,formattedValue:e,errorState:n?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(!n||!t)&&t.showError,serverError:"",manuallyEdited:!0}},e.createCpfNamePrefill=function(e,t,a,n,o){var i="",s=(i=a||(e&&t?e+" "+t:e||t))&&!!i.trim()||""===i&&o;return{rawValue:i,formattedValue:i,errorState:s?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!(!s||!n)&&n.showError,serverError:"",manuallyEdited:!1}},e.createNonce=function(e,t,a,n){var o=r.InputErrorState,i=o.Valid,s=o.Invalid,l=!!a&&a.isCCNValid,u=!!a&&a.isCCodeValid,c=!!a&&a.isCCExpValid;t&&(l=t.ccn?!t.ccn.error:l,u=t.ccode?!t.ccode.error:u,c=t?t.ccexp?!t.ccexp.error:t.ccexpyr&&t.ccexpmo?!t.ccexpyr.error&&!t.ccexpmo.error:c:c);var p=e||(a?a.rawValue:""),d=l&&u&&c?i:s;return{rawValue:p,formattedValue:p,errorState:d,showError:!(d===i||!a)&&a.showError&&!n,serverError:"",isCCNValid:l,isCCodeValid:u,isCCExpValid:c}},e.createPayPalNonce=function(e,t,a){var n=e,o=""!==e?r.InputErrorState.Valid:r.InputErrorState.Invalid;return{rawValue:n,email:t,formattedValue:n,errorState:o,showError:!(o===r.InputErrorState.Valid||!a)&&a.showError,serverError:""}},e.createAdyenEncryptedCard=function(e,t){var a=e||(t?t.rawValue:"");return{rawValue:a,formattedValue:a,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createEncryptedCardForNetworkToken=function(e,t,a){var n=t||(a?a.encryptedCard:""),o=e||(a?a.cardType:"");return{rawValue:{cardType:o,encryptedCard:n},formattedValue:JSON.stringify({cardType:o,encryptedCard:n}),cardType:o,encryptedCard:n,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createBIN=function(e,t){var a=e||(t?t.rawValue:"");return{rawValue:a,formattedValue:a,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createBrowserInfo=function(e,t){var a=e||(t?t.rawValue:"");return{rawValue:a,formattedValue:a,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createThreeDsData=function(e){return{rawValue:e,formattedValue:e,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createApplePayToken=function(e,t){var a=e||(t?t.value:"");return{value:a,rawValue:a,formattedValue:a,errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e.createIBAN=function(e,t){var a=r.InputErrorState,o=a.Valid,i=a.Invalid,s=e.replace(/\s+/gi,""),l=n.validIBANForCountry(s)?o:i;return{rawValue:e,formattedValue:s,errorState:l,showError:!(l===o||!t)&&t.showError,serverError:""}},e.createIdealBankId=function(e,t){var a=e?r.InputErrorState.Valid:r.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:a,showError:!(a===r.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createIdealBankName=function(e,t){return{rawValue:e,formattedValue:e,errorState:e?r.InputErrorState.Valid:r.InputErrorState.Invalid,showError:!1,serverError:""}},e.createEmailsToInvite=function(e,t){return{rawValue:e=e||[],formattedValue:JSON.stringify(e),errorState:r.InputErrorState.Valid,showError:!1,serverError:""}},e})();t.FormValueFactory=i})),define("modules/clean/react/payments/common/form_value_helpers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormValueHelper=void 0,(function(e){e.isValid=function(e){return 0===e.errorState},e.hasServerError=function(e){return!!e.serverError}})(t.FormValueHelper||(t.FormValueHelper={}))})),define("modules/clean/react/payments/common/form_values",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeamPhoneErrorState=t.PasswordErrorState=t.EmailErrorState=t.InputErrorState=void 0,(function(e){e[e.Valid=0]="Valid",e[e.Invalid=1]="Invalid"})(t.InputErrorState||(t.InputErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.NoAt=2]="NoAt",e[e.BadUsername=3]="BadUsername",e[e.BadDomain=4]="BadDomain",e[e.TakenError=5]="TakenError",e[e.TakenWarning=6]="TakenWarning"})(t.EmailErrorState||(t.EmailErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.TooShort=2]="TooShort"})(t.PasswordErrorState||(t.PasswordErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty"})(t.TeamPhoneErrorState||(t.TeamPhoneErrorState={}))})),define("modules/clean/react/payments/common/form/actions/actions",["require","exports","tslib","modules/clean/react/payments/common/constants","modules/clean/react/payments/common/pricing/actions/actions","lodash","modules/clean/react/payments/common/form_value_helpers","modules/clean/auth/common/captcha","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/core/cookies","modules/clean/payments/payments_web_request"],(function(e,t,a,r,n,o,i,s,l,u,c,p,d){"use strict";var m,f;function h(e,t,a,r,n,i,l,u,p){for(var m={},h=0,b=r;h<b.length;h++){var C=b[h],E=a[C];m[c.fieldsToServerProps[C]]=E.formattedValue}o.assignIn(m,n);var T=function(t){for(var a=0,r=t;a<r.length;a++){var n=r[a];if(n.length>=3){var o=n[0],i=n[2];switch(o){case"notifyError":"emailTaken"===i&&e(S())}}}};if(l){var N=s.get_captcha_responses(l);N["g-recaptcha-response"]&&(m["g-recaptcha-response"]=N["g-recaptcha-response"],p=f.RecaptchaV2,e(P()))}e(y(p,n));var w=new d.PaymentsWebRequest({url:t,data:m,success:function(t,a,r){var o;e(g(t,n)),(null===(o=null==t?void 0:t.actions)||void 0===o?void 0:o.length)&&T(t.actions)},error:function(t,a,r){var n=null;try{n=JSON.parse(r)}catch(e){}finally{if(e(_(n||r)),u&&n&&u(n),n&&n.error_type&&n.msg&&"Payment"===n.error_type&&e(F(n.msg)),l)s.handle_captcha_errors(l,n)&&e(v())}}});i?w.request():new d.PaymentsWebRequest({url:"/checkout/create_user",type:"POST",data:{fname:m.fname,lname:m.lname,email:m.email,is_trial:"trial"===m.signup_type,password:m.password,plan_id:m.plan_id,marketing_opt_in:m.marketing_opt_in,tos_agree:m.tos_agree,schedule_id:m.schedule_id,signup_url:m.signup_url,signup_tag:m.signup_tag,signup_referrer:m.signup_referrer,tracking_params:m.tracking_params},success:function(t){var a;if(null===(a=null==t?void 0:t.actions)||void 0===a?void 0:a.length)return T(t.actions),void e(_(t));w.request()},error:function(t,a,r){e(_(r))}}).request(),l&&s.clear_captcha_response(l),p!==f.ThreeDsChallenge&&p!==f.ThreeDsFingerprint||e(I(""))}function y(e,t){return void 0===e&&(e=f.ButtonClick),{type:m.SubmitFormStart,trigger:e,additionalData:t}}function g(e,t){return{type:m.SubmitFormSuccess,data:e,additionalData:t}}function _(e){return{type:m.SubmitFormError,data:e}}function v(){return{type:m.TriggerCaptcha}}function P(){return{type:m.SubmitCaptcha}}function b(e,t){return{type:m.ShowFormFieldErrors,fieldNames:e,origin:t}}function S(){return{type:m.EmailTakenError}}function C(e,t){return function(a){a(n.prepareToUpdatePrice()),a(E(e)),a(n.updatePrice(t))}}function E(e){return{type:m.UpdateNumberOfUsers,value:e}}function T(e){return{type:m.UpdateCountryCode,value:e}}function N(e){return{type:m.UpdateZipCode,value:e}}function w(e){return{type:m.UpdateVat,value:e}}function F(e){return{type:m.PaymentBannerError,msg:e}}function k(e){return{type:m.ApplePayClosedByFailure,msg:e}}function I(e){return{type:m.UpdateThreeDsData,value:e}}function M(e,t){for(var a=0,r=t;a<r.length;a++){var n=e[r[a]];if(!i.FormValueHelper.isValid(n))return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidSubmitState=t.updateEmailsToInvite=t.updateIdealBank=t.updateTermsAndService=t.updateMarketingOptIn=t.updateMandateSigned=t.blurIBAN=t.updateIBAN=t.blurAccountHolderName=t.updateAccountHolderName=t.updateBIN=t.triggerThreeDsFingerprint=t.triggerThreeDsChallenge=t.updateThreeDsData=t.updateBrowserInfo=t.updateApplePayToken=t.updateEncryptedCardForNetworkToken=t.updateAdyenEncryptedCard=t.blurCCField=t.updatePayPalNonce=t.updateNonce=t.updateCpfName=t.applePayClosedByFailure=t.applePayClosedBySuccess=t.applePayError=t.applePayPopupShown=t.applePayStartup=t.paymentBannerError=t.blurCpf=t.updateCpf=t.blurVat=t.updateVat=t.updateVatAndPrice=t.blurZipCode=t.updateZipCode=t.updateZipCodeAndPrice=t.updateCountryCode=t.updateCountryCodeAndPrice=t.updatePaymentMethod=t.updateCompanySize=t.updateTeamPhone=t.updateTeamName=t.updatePassword=t.updateEmail=t.clickGoogleSignup=t.blurEmail=t.updateLastName=t.updateFirstName=t.updateNumberOfUsers=t.updateProductPlanType=t.updateSchedule=t.showEmailTakenWarning=t.showEmailTakenError=t.showFormFieldErrors=t.submitCaptcha=t.triggerCaptcha=t.submitFormError=t.submitFormSuccess=t.submitFormStart=t.submitFormData=t.submitForm=t.SubmitFormTriggerType=t.FormActionEnum=void 0,r=a.__importStar(r),n=a.__importStar(n),o=a.__importStar(o),(function(e){e.BlurEmail="BlurEmail",e.ClickGoogleSignup="ClickGoogleSignup",e.SubmitFormStart="SubmitFormStart",e.SubmitFormSuccess="SubmitFormSuccess",e.SubmitFormError="SubmitFormError",e.ShowFormFieldErrors="ShowFormFieldErrors",e.SubmitCaptcha="SubmitCaptcha",e.TriggerCaptcha="TriggerCaptcha",e.UpdateTransitions="UpdateTransitions",e.UpdateSchedule="UpdateSchedule",e.UpdateProductPlanType="UpdateProductPlanType",e.UpdateNumberOfUsers="UpdateNumberOfUsers",e.UpdateFirstName="UpdateFirstName",e.UpdateLastName="UpdateLastName",e.UpdateEmail="UpdateEmail",e.UpdatePassword="UpdatePassword",e.UpdateTeamName="UpdateTeamName",e.UpdateTeamPhone="UpdateTeamPhone",e.UpdateCompanySize="UpdateCompanySize",e.UpdatePaymentMethod="UpdatePaymentMethod",e.UpdateCountryCode="UpdateCountryCode",e.UpdateZipCode="UpdateZipCode",e.BlurZipCode="BlurZipCode",e.UpdateVat="UpdateVat",e.BlurVat="BlurVat",e.UpdateCpf="UpdateCpf",e.BlurCpf="BlurCpf",e.UpdateCpfName="UpdateCpfName",e.UpdateNonce="UpdateNonce",e.UpdatePayPalNonce="UpdatePayPalNonce",e.BlurCCField="BlurCCField",e.UpdateAdyenEncryptedCard="UpdateAdyenEncryptedCard",e.UpdateEncryptedCardForNetworkToken="UpdateEncryptedCardForNetworkToken",e.UpdateBrowserInfo="UpdateBrowserInfo",e.UpdateThreeDsData="UpdateThreeDsData",e.TriggerThreeDsChallenge="TriggerThreeDsChallenge",e.TriggerThreeDsFingerprint="TriggerThreeDsFingerprint",e.UpdateBIN="UpdateBIN",e.UpdateAccountHolderName="UpdateAccountHolderName",e.BlurAccountHolderName="BlurAccountHolderName",e.UpdateIBAN="UpdateIBAN",e.BlurIBAN="BlurIBAN",e.UpdateMandateSigned="UpdateMandateSigned",e.UpdateIdealBank="UpdateIdealBank",e.UpdateMarketingOptIn="UpdateMarketingOptIn",e.UpdateTermsAndService="UpdateTermsAndService",e.UpdateEmailsToInvite="UpdateEmailsToInvite",e.EmailTakenError="EmailTakenError",e.EmailTakenWarning="EmailTakenWarning",e.PaymentBannerError="PaymentBannerError",e.UpdateApplePayToken="UpdateApplePayToken",e.ApplePayStartup="ApplePayStartup",e.ApplePayPopupShown="ApplePayPopupShown",e.ApplePayClosedByFailure="ApplePayPopupCloseByFailure",e.ApplePayError="ApplePayError",e.ApplePayClosedBySuccess="ApplePayClosedBySuccess"})(m=t.FormActionEnum||(t.FormActionEnum={})),(function(e){e.ButtonClick="button_click",e.RecaptchaV2="recaptcha_v2",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(f=t.SubmitFormTriggerType||(t.SubmitFormTriggerType={})),t.submitForm=function(e,t,a,r,n,o,i){return void 0===r&&(r={}),r.time_on_page_ms=window.performance.now(),function(s,u){var c=u();M(c.formData,t)?a().then((function(a){var p,d,m,f=null===(m=null!==(p=c.pageState.existingAccountShowing)&&void 0!==p?p:null===(d=c.pageState.userInfo)||void 0===d?void 0:d.existingAccount)||void 0===m||m;a?h(s,e,u().formData,t,r,f,n,o,i):u().formData.paymentMethod.formattedValue===l.PaymentMethod.ApplePay&&s(k("Step 2 - User Closed Most Likely"))})):s(b(t,"SubmitForm"))}},t.submitFormData=h,t.submitFormStart=y,t.submitFormSuccess=g,t.submitFormError=_,t.triggerCaptcha=v,t.submitCaptcha=P,t.showFormFieldErrors=b,t.showEmailTakenError=S,t.showEmailTakenWarning=function(){return{type:m.EmailTakenWarning}},t.updateSchedule=function(e){return p.Cookies.create(r.PricingToggleCookie,e===u.ScheduleId.MONTHLY?r.PricingToggleMonthly:r.PricingToggleAnnual,30),{type:m.UpdateSchedule,value:e}},t.updateProductPlanType=function(e){var t={type:m.UpdateProductPlanType,value:e};return function(e,a){var r=a();e(t),e(E(r.formData.numberOfUsers.rawValue))}},t.updateNumberOfUsers=C,t.updateFirstName=function(e){return{type:m.UpdateFirstName,value:e}},t.updateLastName=function(e){return{type:m.UpdateLastName,value:e}},t.blurEmail=function(e){return{type:m.BlurEmail,value:e}},t.clickGoogleSignup=function(){return{type:m.ClickGoogleSignup}},t.updateEmail=function(e){return{type:m.UpdateEmail,value:e}},t.updatePassword=function(e){return{type:m.UpdatePassword,value:e}},t.updateTeamName=function(e){return{type:m.UpdateTeamName,value:e}},t.updateTeamPhone=function(e){return{type:m.UpdateTeamPhone,value:e}},t.updateCompanySize=function(e){return{type:m.UpdateCompanySize,value:e}},t.updatePaymentMethod=function(e){return{type:m.UpdatePaymentMethod,value:e}},t.updateCountryCodeAndPrice=function(e){return function(t){t(n.prepareToUpdatePrice()),t(T(e)),t(n.updatePrice())}},t.updateCountryCode=T,t.updateZipCodeAndPrice=function(e,t){return function(a){a(n.prepareToUpdatePrice()),a(N(e)),a(n.updatePrice(t))}},t.updateZipCode=N,t.blurZipCode=function(e){return{type:m.BlurZipCode,value:e}},t.updateVatAndPrice=function(e,t){return function(a){a(n.prepareToUpdatePrice()),a(w(e)),a(n.updatePrice(t))}},t.updateVat=w,t.blurVat=function(e){return{type:m.BlurVat,value:e}},t.updateCpf=function(e){return{type:m.UpdateCpf,value:e}},t.blurCpf=function(e){return{type:m.BlurCpf,value:e}},t.paymentBannerError=F,t.applePayStartup=function(e){return{type:m.ApplePayStartup,msg:e}},t.applePayPopupShown=function(e){return{type:m.ApplePayPopupShown,msg:e}},t.applePayError=function(e){return{type:m.ApplePayError,msg:e}},t.applePayClosedBySuccess=function(e){return{type:m.ApplePayClosedBySuccess,msg:e}},t.applePayClosedByFailure=k,t.updateCpfName=function(e){return{type:m.UpdateCpfName,value:e}},t.updateNonce=function(e,t){return{type:m.UpdateNonce,value:e,creditCardIframeFields:t}},t.updatePayPalNonce=function(e,t){return{type:m.UpdatePayPalNonce,value:e,email:t}},t.blurCCField=function(e){return{type:m.BlurCCField,creditCardIframeFields:e}},t.updateAdyenEncryptedCard=function(e){return{type:m.UpdateAdyenEncryptedCard,value:e}},t.updateEncryptedCardForNetworkToken=function(e,t){return{type:m.UpdateEncryptedCardForNetworkToken,cardType:e,encryptedCard:t}},t.updateApplePayToken=function(e){return{type:m.UpdateApplePayToken,value:e}},t.updateBrowserInfo=function(e){return{type:m.UpdateBrowserInfo,value:e}},t.updateThreeDsData=I,t.triggerThreeDsChallenge=function(){return{type:m.TriggerThreeDsChallenge}},t.triggerThreeDsFingerprint=function(){return{type:m.TriggerThreeDsFingerprint}},t.updateBIN=function(e){return{type:m.UpdateBIN,value:e}},t.updateAccountHolderName=function(e){return{type:m.UpdateAccountHolderName,value:e}},t.blurAccountHolderName=function(e){return{type:m.BlurAccountHolderName,value:e}},t.updateIBAN=function(e){return{type:m.UpdateIBAN,value:e}},t.blurIBAN=function(e){return{type:m.BlurIBAN,value:e}},t.updateMandateSigned=function(e){return{type:m.UpdateMandateSigned,value:e}},t.updateMarketingOptIn=function(e){return{type:m.UpdateMarketingOptIn,value:e}},t.updateTermsAndService=function(e){return{type:m.UpdateTermsAndService,value:e}},t.updateIdealBank=function(e){return{type:m.UpdateIdealBank,value:e}},t.updateEmailsToInvite=function(e,t){return function(a){a((function(e){return{type:m.UpdateEmailsToInvite,value:e}})(e)),a(C(Math.max(e.length+1,t)+""))}},t.isValidSubmitState=M})),define("modules/clean/react/payments/common/pricing/actions/actions",["require","exports","tslib","lodash","modules/core/i18n","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/payments/dfb_util","modules/core/notify"],(function(e,t,a,r,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateRenewTransitionsError=t.updateRenewTransitionsSuccess=t.updateRenewTransitionsStart=t.updateTransitionsError=t.updateTransitionsSuccess=t.updateTransitionsStart=t.updatePrice=t.prepareToUpdatePrice=void 0;var u=(r=a.__importStar(r)).debounce((function(e,t){e((function(e){return{type:"UpdateRecentLoadEventStatus",recentLoadEventStatus:e}})(t))}),400),c=new i.SubscriptionService,p=r.debounce((function(e,t,a,r,n,i){var s,l={discountPercentage:100*n,discountAllowMonthly:i};if(t.currentPlanSku){var u=new o.SubscriptionDiff;u.setPlan(t.currentPlanSku),u.setTotalLicenses(a),s=[u]}else s=t.subChangePlans.plans.map((function(e){var t=o.SubscriptionDiff.fromSubscriptionStatus(e);return t.setTotalLicenses(a),t}));c.priceSet(s,r,l).then((function(t){f(e,t)})).catch((function(t){e(h(t))}))}),400),d=r.debounce((function(e,t,a,r,o){var i=t().pageState.transition,u=new s.DfBTransitionInfoFetcher([i]),c={total_users:r,country_code:o.countryCode,zip_code:o.zipCode,vat_id:o.vat,renew:!0};u.get((function(t){var a=t[0].transition_view_model;e(g(a))}),c,(function(t){l.Notify.error(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),e(_(t))}))}),400);function m(){return{type:"UpdateTransitionsStart"}}function f(e,t){e({type:"UpdateTransitionsSuccess",subChangePlans:t}),u(e,!1)}function h(e){return{type:"UpdateTransitionsError",error:e}}function y(){return{type:"UpdateRenewTransitionsStart"}}function g(e){return{type:"UpdateRenewTransitionsSuccess",transition:e}}function _(e){return{type:"UpdateRenewTransitionsError",error:e}}t.prepareToUpdatePrice=function(){return{type:"PrepareToUpdateTransitions"}},t.updatePrice=function(e){return void 0===e&&(e=!1),function(t,a){var r,n=a(),o=n.formData,i=n.pricingState,s=i.discountInfo,l=o.numberOfUsers.formattedValue,u=!0;s&&(r=s.discountRatio,u=s.allowMonthly);var c={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};e?(t({type:"UpdateRenewTransitionsStart"}),d(t,a,i,l,c)):(t({type:"UpdateTransitionsStart"}),p(t,i,l,c,r,u))}},t.updateTransitionsStart=m,t.updateTransitionsSuccess=f,t.updateTransitionsError=h,t.updateRenewTransitionsStart=y,t.updateRenewTransitionsSuccess=g,t.updateRenewTransitionsError=_})),define("modules/clean/payments/dfb_util",["require","exports","tslib","lodash","modules/clean/ajax","modules/clean/payments/validation","modules/clean/payments/cash","modules/core/exception"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DfBTransitionInfoFetcher=t.DfBTransitionInfo=t.DfbTransitionSpaceParams=void 0,r=a.__importStar(r),n=a.__importStar(n),o=a.__importStar(o);var l=(function(){function e(e,t,a,r,n,o,i){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=a,this.currencies=r,this.country_code=n,this.zip_code=o,this.vat_id=i,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}return e.prototype.set_only_license_count=function(e){var t=Object.keys(this.license_ids_and_counts)[0];this.license_ids_and_counts[t]=e},e.prototype.get_only_license_count=function(){var e=Object.keys(this.license_ids_and_counts)[0];return this.license_ids_and_counts[e]},e.prototype.set_country_code=function(e){this.country_code=e},e.prototype.set_zip_code=function(e){this.zip_code=e},e.prototype.set_currencies=function(e){this.currencies=e},e.prototype.set_renew=function(e){this.renew=e},e.prototype.set_discount_ratio=function(e){this.discount_ratio=e},e.prototype.set_discount_allow_monthly=function(e){this.discount_allow_monthly=e},e.prototype.set_vat_id=function(e){""!==e&&o.validateVat(this.country_code||"",e)?this.vat_id=e:this.vat_id=""},e.prototype.cache_key=function(e){var t;return void 0===e&&(e=!1),this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")},e.prototype.to_json=function(){var e=this.renew?{renew:1}:{};return a.__assign(a.__assign({},e),{plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly})},e.from_transition_view_models=function(t){for(var a,n=[],o=[],i=[],l=null,u=null,c=null,p=0,d=t;p<d.length;p++){var m=d[p],f=void 0;if(n.push(m.state.plan.id),o.push(m.state.schedule.id),i.push(m.state.currency),void 0===a){a={};for(var h=0,y=m.state.allocated_licenses;h<y.length;h++)a[(f=y[h]).license_id]=f.license_count;r.isObject(m.read_only_invoice)&&(l=m.read_only_invoice.tax_country_code||null,u=m.read_only_invoice.tax_exclusion_id||null,c=m.read_only_invoice.tax_zip_code||null)}else{s.assert(m.state.allocated_licenses.length===Object.keys(a).length,"License sets differ");for(var g=0,_=m.state.allocated_licenses;g<_.length;g++)f=_[g],s.assert(a.hasOwnProperty(""+f.license_id),"License sets differ"),s.assert(a[f.license_id]===f.license_count,"License count must match");s.assert(l===(m.read_only_invoice&&m.read_only_invoice.tax_country_code||null),"country code must match"),s.assert(c===(m.read_only_invoice&&m.read_only_invoice.tax_zip_code||null),"zip code must match"),s.assert(u===(m.read_only_invoice&&m.read_only_invoice.tax_exclusion_id||null),"VAT ID must match")}}return new e(r.uniq(n),r.uniq(o),a||{},r.uniq(i),l,c,u)},e})();t.DfbTransitionSpaceParams=l;var u=function(e){if(this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=i.Cash.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new i.Cash(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=i.Cash.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new i.Cash(0,this.transition_view_model.state.currency),this.recurring_total=i.Cash.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=i.Cash.fromObject(this.transition_view_model.prices.tax):this.tax=new i.Cash(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=i.Cash.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new i.Cash(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice){var t=this.transition_view_model.read_only_invoice.line_items,a=t.length>0?t[0]:void 0;a&&!r.isEmpty(a.country_tax_percentage)?this.tax_percentage=parseFloat(a.country_tax_percentage):a&&!r.isEmpty(a.state_tax_percentage)&&(this.tax_percentage=parseFloat(a.state_tax_percentage))}};t.DfBTransitionInfo=u;var c=(function(){function e(e){var t=this;this.has_inflight_request=function(){return Object.keys(t.transition_view_model_requests).length>0},this.add_to_cache=function(e,a){void 0===a&&(a=!1);var r=l.from_transition_view_models(e).cache_key(a),n=e.map((function(e){return new u(e)}));return t.transition_info_cache[r]=n,n},this.get_transition_info_for=function(e){return t.transition_info_cache.hasOwnProperty(e)?t.transition_info_cache[e]:null},this.default_transition_view_models=e,this.transition_view_model_requests={},this.transition_info_cache={},this.add_to_cache(this.default_transition_view_models)}return e.prototype.get=function(e,t,a){var o=this,i=l.from_transition_view_models(this.default_transition_view_models);t.total_users&&i.set_only_license_count(t.total_users),t.country_code&&i.set_country_code(t.country_code),t.currency&&i.set_currencies([t.currency]),!0===t.remove_currency&&i.set_currencies([]),t.zip_code&&i.set_zip_code(t.zip_code),r.isBoolean(t.renew)&&i.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&i.set_vat_id(t.vat_id),t.discount_ratio&&i.set_discount_ratio(t.discount_ratio),r.isBoolean(t.discount_allow_monthly)&&i.set_discount_allow_monthly(t.discount_allow_monthly);var s=i.cache_key(),u=this.get_transition_info_for(s);if(u)e(u);else if(!this.transition_view_model_requests[s])return this.transition_view_model_requests[s]=!0,n.SilentBackgroundRequest({url:"/business/transition-model",type:"GET",dataType:"json",data:i.to_json(),success:function(a){delete o.transition_view_model_requests[s];var r=o.add_to_cache(a,t.remove_currency);e(r)},error:function(e){r.isFunction(a)&&a(e),delete o.transition_view_model_requests[s]}})},e})();t.DfBTransitionInfoFetcher=c}));
//# sourceMappingURL=pkg-checkout.min.js-vflArPt-t.map