define("modules/clean/metrics/coin",["require","exports","tslib","apex-metrics/index","dropbox/proto/apex_metrics_web/apex_metrics_web","google/protobuf/timestamp","google/protobuf/empty"],(function(e,t,n,i,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observeCoin=t.APIv2CoinToProtobufCoin=t.protobufCoinToAPIv2Coin=t.newCoinState=void 0,t.newCoinState=function(){return r.apex_metrics_web.ApexMetricsCacheData.CoinState.create({lastFlipTime:null,lastResult:!1,numTimesChecked:0})},t.protobufCoinToAPIv2Coin=function(e){var t=void 0;if(e.stickiness&&e.stickiness.limit)switch(e.stickiness.limit){case"independent":t={".tag":"independent"};break;case"permanent":t={".tag":"permanent"};break;case"nResults":t={".tag":"n_results",n_results:e.stickiness.nResults};break;case"nSeconds":t={".tag":"n_seconds",n_seconds:e.stickiness.nSeconds}}return{fraction:null!==e.fraction?e.fraction:void 0,stickiness:t?{limit:t}:void 0}},t.APIv2CoinToProtobufCoin=function(e){var t=void 0;if(e.stickiness&&e.stickiness.limit)switch(e.stickiness.limit[".tag"]){case"independent":t={independent:a.google.protobuf.Empty.create()};break;case"permanent":t={permanent:a.google.protobuf.Empty.create()};break;case"n_results":t={nResults:e.stickiness.limit.n_results};break;case"n_seconds":t={nSeconds:e.stickiness.limit.n_seconds}}return r.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2.create({fraction:e.fraction,stickiness:t?r.apex_metrics_web.RecordNamespace.StickinessV2.create(t):void 0})},t.observeCoin=function(e,t,r){if(!t.stickiness||!t.stickiness.limit)return{nextState:r,result:!1};var a,s,c=Date.now()/1e3,u=r.lastFlipTime,l=void 0===u?o.google.protobuf.Timestamp.create({seconds:0,nanos:0}):u,p=r.lastResult,d=r.numTimesChecked,f=void 0===d?0:d,m=!1;switch(t.stickiness.limit[".tag"]){case"n_results":m=null===f||f%t.stickiness.limit.n_results==0;break;case"n_seconds":if(!l){m=!0;break}m=i.Instant.toMilliseconds({value:(a=c,s=l.seconds,"number"!=typeof a?a.sub(s).toNumber():"number"==typeof s?a-s:s.sub(a).negate().toNumber()),unit:i.TimeUnit.SECONDS})>i.Instant.toMilliseconds({value:t.stickiness.limit.n_seconds,unit:i.TimeUnit.SECONDS});break;case"permanent":m=0===f;break;case"independent":m=!0;break;case"other":default:return{nextState:r,result:!1}}if(m){var _=e()<(t.fraction||0);return{nextState:{lastFlipTime:o.google.protobuf.Timestamp.create({seconds:c,nanos:0}),lastResult:_,numTimesChecked:f?f+1:1},result:_}}return{nextState:n.__assign(n.__assign({},r),{numTimesChecked:f?f+1:1}),result:!!p}}})),define("modules/clean/metrics/database",["require","exports","tslib"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storeIncomingSpans=t.checkAndSetPublishTime=t.getDatabase=t.getNamespaceRange=t.CONTROL_VALUE_LASTPUBLISHTIME=t.CONTROL_VALUE_STORE=t.NAMESPACE_INDEX=t.SPAN_STORE=t.DATABASE_VERSION=void 0;function i(e,n,i){var r=e.result,o=function(e){r.removeEventListener("error",o),i(e)};if(r.addEventListener("error",o),e.transaction.addEventListener("complete",(function(){r.removeEventListener("error",o)})),e.transaction.addEventListener("error",(function(e){r.removeEventListener("error",o),i(e)})),n.oldVersion<1)try{r.createObjectStore(t.SPAN_STORE,{keyPath:["namespace","tagNames","tagValues"]}).createIndex(t.NAMESPACE_INDEX,"namespace",{unique:!1}),r.createObjectStore(t.CONTROL_VALUE_STORE,{keyPath:"name"})}catch(e){return void o(e)}if(n.oldVersion<2){var a=e.transaction.objectStore(t.SPAN_STORE).openCursor();a.addEventListener("success",(function(e){var t=a.result;if(t){var n=!1;for(var i in t.value.spans)t.value.spans.hasOwnProperty(i)&&(n=!0,t.value.spans[i]={spanCount:0,samples:t.value.spans[i]});n&&t.update(t.value),t.continue()}}))}}t.DATABASE_VERSION=2,t.SPAN_STORE="spans",t.NAMESPACE_INDEX="namespace",t.CONTROL_VALUE_STORE="controlValues",t.CONTROL_VALUE_LASTPUBLISHTIME="lastPublishTime",t.getNamespaceRange=function(e,n){return new Promise((function(i,r){var o=e.index(t.NAMESPACE_INDEX).getKey(IDBKeyRange.lowerBound(n,!0));o.addEventListener("success",(function(e){if(o.result){var t=o.result[0];i(IDBKeyRange.bound([n],[t],!1,!0))}else i(IDBKeyRange.lowerBound([n]))})),o.addEventListener("error",(function(e){r(e)}))}))},t.getDatabase=function(e){return void 0===e&&(e=t.DATABASE_VERSION),n.__awaiter(this,void 0,Promise,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:if(t=null,"undefined"==typeof indexedDB)return[2,t];n.label=1;case 1:return n.trys.push([1,3,,7]),[4,new Promise((function(t,n){var r=indexedDB.open("apexMetrics",e);r.addEventListener("success",(function(){t(r.result)})),r.addEventListener("error",(function(e){n(e)})),r.addEventListener("upgradeneeded",(function(e){try{i(r,e,n)}catch(e){n(e)}}))}))];case 2:return t=n.sent(),[3,7];case 3:return(r=n.sent()).target&&r.target.error&&r.target.error.name&&"VersionError"===r.target.error.name?[4,new Promise((function(e,t){var n=indexedDB.deleteDatabase("apexMetrics");n.addEventListener("success",(function(){return e()})),n.addEventListener("error",(function(e){return t(e)}))}))]:[3,6];case 4:return n.sent(),[4,new Promise((function(t,n){var r=indexedDB.open("apexMetrics",e);r.addEventListener("success",(function(){return t(r.result)})),r.addEventListener("error",(function(e){return n(e)})),r.addEventListener("upgradeneeded",(function(e){try{i(r,e,n)}catch(e){n(e)}}))}))];case 5:t=n.sent(),n.label=6;case 6:return[3,7];case 7:return[2,t]}}))}))},t.checkAndSetPublishTime=function(e,i,r){var o=this;return new Promise((function(a,s){return n.__awaiter(o,void 0,void 0,(function(){var o,c;return n.__generator(this,(function(n){try{o=e.transaction(t.CONTROL_VALUE_STORE,"readwrite").objectStore(t.CONTROL_VALUE_STORE)}catch(e){if(e instanceof DOMException&&("InvalidStateError"===e.name||11===e.code))return a(!1),[2];throw e}return(c=o.get(t.CONTROL_VALUE_LASTPUBLISHTIME)).addEventListener("success",(function(e){var n=c.result;if(n&&i-+n.value<r)a(!1);else{var u=o.put({name:t.CONTROL_VALUE_LASTPUBLISHTIME,value:i});u.addEventListener("success",(function(){a(!0)})),u.addEventListener("error",(function(e){s(e)}))}})),c.addEventListener("error",(function(e){s(e)})),[2]}))}))}))},t.storeIncomingSpans=function(e,n){return Promise.all(n.map((function(n){return new Promise((function(i,r){var o;try{o=e.transaction(t.SPAN_STORE,"readwrite")}catch(e){if(e instanceof DOMException&&("InvalidStateError"===e.name||11===e.code))return void i();throw e}var a=o.objectStore(t.SPAN_STORE);o.addEventListener("complete",(function(e){return i()})),o.addEventListener("error",(function(e){return r(e)}));var s=[],c=[];for(var u in n.tags)n.tags.hasOwnProperty(u)&&(s.push(u),c.push(n.tags[u]));var l=a.get([n.namespace,s,c]);l.addEventListener("success",(function(e){var t=l.result?l.result:{namespace:n.namespace,tagNames:s,tagValues:c,spans:{}};t.spans[n.metricName]||(t.spans[n.metricName]={spanCount:0,samples:[]}),t.spans[n.metricName].spanCount++,t.spans[n.metricName].samples=t.spans[n.metricName].samples.concat(n.samples),t.spans[n.metricName].samples.sort(),a.put(t)}))}))})))}})),define("modules/clean/metrics/filter",["require","exports","tslib","modules/clean/metrics/coin","modules/clean/metrics/database","modules/clean/metrics/serialization"],(function(e,t,n,i,r,o){"use strict";function a(e,t){return n.__awaiter(this,void 0,Promise,(function(){var i,r,o,a;return n.__generator(this,(function(n){switch(n.label){case 0:return i=null,crypto.subtle&&window.TextEncoder?(r=new TextEncoder,[4,crypto.subtle.digest("SHA-256",r.encode(t))]):[3,2];case 1:o=n.sent(),a=new Uint32Array(o),i=a.reduce((function(e,t){return e^t})),n.label=2;case 2:return null===i?[2,0]:[2,((i^e)>>>0)/4294967296]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.SpanGroupFilter=t.makeNamespaceMap=void 0,t.makeNamespaceMap=function(e,t){for(var n={},r=0,o=e;r<o.length;r++){var a=o[r],s=a.metric_namespace;n[s]={dropFractionOfHostsPerMetric:a.drop_fraction_of_hosts_per_metric||null,dropPeriodCoin:a.drop_periods?{config:a.drop_periods,state:t.namespaceCoinState&&t.namespaceCoinState[s]&&t.namespaceCoinState[s].dropPeriodCoin||i.newCoinState()}:null,dropSamplesCoin:a.drop_samples?{config:a.drop_samples,state:t.namespaceCoinState&&t.namespaceCoinState[s]&&t.namespaceCoinState[s].dropSamplesCoin||i.newCoinState()}:null}}return n};var s=(function(){function e(e,t,n,i,r,o){this.filterID=e,this.randomEngine=t,this.clock=n,this.maxScopes=i,this.namespaceMap=r,this.configuredNamespaces=o}return e.prototype.extend=function(t,i,r){return new e(this.filterID,this.randomEngine,this.clock,t||this.maxScopes,n.__assign(n.__assign({},this.namespaceMap),i),r)},e.prototype.getState=function(){var e={filterID:this.filterID,namespaceCoinState:{}};for(var t in this.namespaceMap)this.namespaceMap.hasOwnProperty(t)&&(e.namespaceCoinState[t]={dropPeriodCoin:this.namespaceMap[t].dropPeriodCoin?n.__assign({},this.namespaceMap[t].dropPeriodCoin.state):null,dropSamplesCoin:this.namespaceMap[t].dropSamplesCoin?n.__assign({},this.namespaceMap[t].dropSamplesCoin.state):null});return e},e.prototype.getConfiguredNamespaces=function(){return this.configuredNamespaces},e.prototype.partitionAndSerializeSpans=function(e,t,s,c){return n.__awaiter(this,void 0,Promise,(function(){var u=this;return n.__generator(this,(function(l){return[2,new Promise((function(l,p){var d,f=[],m=0,_=0;try{d=e.transaction(r.SPAN_STORE,"readwrite")}catch(e){if(e instanceof DOMException&&("InvalidStateError"===e.name||11===e.code))return void l(null);throw e}d.addEventListener("complete",(function(){return l([f,m,_])})),d.addEventListener("error",(function(e){return p(e)}));var h,g=d.objectStore(r.SPAN_STORE);try{h=g.index(r.NAMESPACE_INDEX)}catch(e){return void p(e)}var v=h.openKeyCursor(null,"nextunique");v.addEventListener("success",(function(){return n.__awaiter(u,void 0,void 0,(function(){var e,u,l,d,h,w,b,S,y,T,E,x,O,k=this;return n.__generator(this,(function(C){switch(C.label){case 0:if(!(e=v.result))return[2];if(0!==this.maxScopes&&f.length===this.maxScopes)return[2];if(u=e.key,!this.configuredNamespaces.has(u))return e.continue(),[2];l=this.namespaceMap[u]||{},d=l.dropPeriodCoin,h=l.dropSamplesCoin,w=l.dropFractionOfHostsPerMetric,C.label=1;case 1:return C.trys.push([1,3,,4]),[4,r.getNamespaceRange(g,u)];case 2:return b=C.sent(),[3,4];case 3:return S=C.sent(),p(S),[2];case 4:return d&&(y=i.observeCoin(this.randomEngine,d.config,d.state),T=y.result,E=y.nextState,d.state=E,T)?(g.delete(b),e.continue(),[2]):(x={metric_namespace:u,timestamp_sec:s,tags:o.formatTags(t),descendants:[]},(O=g.openCursor(b)).addEventListener("success",(function(){return n.__awaiter(k,void 0,void 0,(function(){var t,r,s,l,p,d,g,v,b=this;return n.__generator(this,(function(n){switch(n.label){case 0:if(!(t=O.result))return x.descendants.length>0&&f.push(x),e.continue(),[2];for(p in r={tags:o.zipTags(t.value.tagNames,t.value.tagValues),metrics:[]},s=t.value.spans,l=[],s)l.push(p);d=0,n.label=1;case 1:return d<l.length?(g=l[d],s.hasOwnProperty(g)?w?[4,a(this.filterID,g)]:[3,3]:[3,4]):[3,5];case 2:if(n.sent()<w)return[3,4];n.label=3;case 3:if(v=s[g].samples,h&&(v=v.filter((function(e){var t=i.observeCoin(b.randomEngine,h.config,h.state),n=t.result,r=t.nextState;return h.state=r,!n}))),0===v.length)return[3,4];c.includes(u)||(m+=s[g].spanCount,_+=v.length),r.metrics.push({name:{value:{".tag":"string_value",string_value:g}},data:{".tag":"numerical_data",samples:v}}),n.label=4;case 4:return d++,[3,1];case 5:return r.metrics.length>0&&x.descendants.push(r),t.delete(),t.continue(),[2]}}))}))})),[2])}}))}))}))}))]}))}))},e})();t.SpanGroupFilter=s})),define("modules/clean/metrics/index",["require","exports","apex-metrics/index","modules/clean/api_v2/noauth_client","modules/clean/metrics/database","modules/clean/metrics/apiv2_sink","modules/clean/metrics/server_view_sink"],(function(e,t,n,i,r,o,a){"use strict";function s(){return new n.BrowserPerformanceClock}Object.defineProperty(t,"__esModule",{value:!0}),t.getMetricsReporter=void 0;var c=new i.NoAuthApiV2Client,u=new o.Apiv2MetricsSink(c,s(),o.makeDefaultInitialization(c),o.makeDefaultCacheFactory(),new n.SetTimeoutExecutor((function(){return{value:5*Math.random(),unit:n.TimeUnit.SECONDS}})),Math.random,r.getDatabase),l=new a.ServerViewMetricsSink;t.getMetricsReporter=function(){return void 0!==window._clientBridge?n.MetricsReporterImpl.root(l,s()):n.MetricsReporterImpl.root(u,s())}})),define("modules/clean/metrics/serialization",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipTags=t.formatTags=void 0,t.formatTags=function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];t.push({name:{value:{".tag":"string_value",string_value:n}},value:{value:{".tag":"string_value",string_value:i}}})}return t},t.zipTags=function(e,t){if(e.length!==t.length)throw new Error("Cannot zip values of different dimensions!");return e.map((function(e,n){return{name:{value:{".tag":"string_value",string_value:e}},value:{value:{".tag":"string_value",string_value:t[n]}}}}))}})),define("modules/clean/metrics/apiv2_sink",["require","exports","tslib","apex-metrics/index","eventemitter3","modules/clean/metrics/coin","modules/clean/metrics/database","modules/clean/metrics/filter","modules/core/browser_detection","modules/constants/page_load","modules/core/exception","google/protobuf/timestamp","dropbox/proto/apex_metrics_web/apex_metrics_web","proto_utils/unpack"],(function(e,t,n,i,r,o,a,s,c,u,l,p,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Apiv2MetricsSink=t.recordInstrumentation=t.makeDefaultCacheFactory=t._PERSISTENTCACHE_KEY=t.makeDefaultInitialization=t.PublishType=void 0,r=n.__importDefault(r),c=n.__importStar(c),l=n.__importStar(l);var m;(function(e){e.ALLOWED="allowed",e.DENIED="denied"})(m=t.PublishType||(t.PublishType={}));var _={".tag":"trigger_heartbeat"},h={".tag":"trigger_publish"},g={client_version:6,implementation:{".tag":"typescript"}};function v(e,t,n){var i,r=[];return t.forEach((function(e){return r.push(e)})),{scopes:e,known_namespaces:r,environment:"prod",artifact_name:"dropbox-web",artifact_version:u.REPO_REV,client_metadata:g,trigger:n,os:c.mac?{name:{".tag":"mac"},version:"unknown"}:c.windows?{name:{".tag":"windows"},version:(i=c.windowsInfo,i.windowsXP||i.windowsXPx64?"XP":i.windowsVista?"Vista":i.windows7?"7":i.windows8?"8":i.windows8_1?"8.1":i.windows10?"10 Unknown":"unknown")}:c.is_android()?{name:{".tag":"android"},version:"unknown"}:c.iOS?{name:{".tag":"ios"},version:"unknown"}:{name:{".tag":"unknown_os"},version:"unknown"}}}function w(e,t,n,i,r,o){var a=function(t,n){e.createStats({ns:"amp_client",name:t}).record(n)};a("samples_sink/submitted_spans",t),a("samples_sink/submitted_samples",n),a("samples_sink/request/latency",i),a("samples_sink/request/dropped_spans",r),a("samples_sink/request/dropped_samples",o)}t.makeDefaultInitialization=function(e){var i=this;return function(r){return n.__awaiter(i,void 0,void 0,(function(){var i,a,s,c,u,p;return n.__generator(this,(function(n){switch(n.label){case 0:return i=[],!r||!(a=(function(e){var n=e.getItem(t._PERSISTENTCACHE_KEY);if(null===n)return null;var i,r=Date.now()/1e3,a=[];try{i=f.unpackProto(n,d.apex_metrics_web.ApexMetricsCacheData)}catch(e){return l.reportException({err:e,tags:["js:web:amp-sink","js:web:amp-sink/local-storage"],severity:"non-critical"}),null}if(!i.config||!i.state||!i.timeStored)return l.reportStack("Sink cache was missing data",{tags:["js:web:amp-sink","js:web:amp-sink/local-storage"]}),null;var s=(function(e,t){if("number"!=typeof e)return e.sub(t).toNumber();if("number"==typeof t)return e-t;return t.sub(e).negate().toNumber()})(r,i.timeStored.seconds);if(s<0)return l.reportStack("Sink cache was stored in the future instead of the past",{tags:["js:web:amp-sink","js:web:amp-sink/local-storage"]}),null;var c={};i.config&&(a=i.config.reportingConfigs.map((function(e){return e.metricNamespace})),c.reporting_configs=i.config.reportingConfigs?i.config.reportingConfigs.filter((function(e){return s<e.maxTimeUntilRefreshSeconds})).map((function(e){return{metric_namespace:e.metricNamespace,max_time_until_refresh_seconds:e.maxTimeUntilRefreshSeconds,stop_publication_for_seconds:e.stopPublicationForSeconds,drop_samples:e.dropSamples?o.protobufCoinToAPIv2Coin(e.dropSamples):void 0,drop_periods:e.dropPeriods?o.protobufCoinToAPIv2Coin(e.dropPeriods):void 0,drop_fraction_of_hosts_per_metric:e.dropFractionOfHostsPerMetric,aggregation_interval_seconds:e.aggregationIntervalSeconds}})):[],c.publication_interval_seconds=i.config.publicationIntervalSeconds,c.max_scopes_per_request=i.config.maxScopesPerRequest,c.stop_publication_for_seconds=i.config.stopPublicationForSeconds,c.debug_infos=i.config.debugInfos);return{config:c,state:i.state,knownNamespaces:a}})(r))||(i=a.knownNamespaces,s=new Set,a.config.reporting_configs.forEach((function(e){return s.add(e.metric_namespace)})),i.some((function(e){return!s.has(e)})))?(c=new Set,i.forEach((function(e){return c.add(e)})),[4,e.ns("client_metrics").rpc("record",v([],c,_),{})]):[2,a];case 1:return u=n.sent(),p=Math.floor(4294967296*Math.random())>>>0,[2,{knownNamespaces:i,config:u,state:{filterID:p,namespaceCoinState:{}}}]}}))}))}},t._PERSISTENTCACHE_KEY="amp-sink-cache",t.makeDefaultCacheFactory=function(){return function(){try{return window.localStorage||null}catch(e){return null}}},t.recordInstrumentation=w;var b=(function(){function e(e,t,n,i,o,a,s){var c=this;this.client=e,this.clock=t,this.initializer=n,this.cacheFactory=i,this.executor=o,this.randomEngine=a,this.databaseFactory=s,this.nextRequest=null,this.knownNamespaces=new Set,this.bufferedSpans=[],this.eventEmitter=new r.default,this.cache=this.cacheFactory(),this.currentRequest=this.initializer(this.cache).then((function(e){return e&&c.updateConfiguration(e.config,e.state),c.eventEmitter.emit("initialized"),e.config||null}))}return e.prototype.updateConfiguration=function(e,n){var r=this,a=e.reporting_configs,s=void 0===a?[]:a,c=e.stop_publication_for_seconds,u=e.publication_interval_seconds,l=new Set;s.forEach((function(e){r.knownNamespaces.add(e.metric_namespace),l.add(e.metric_namespace)})),this.updateBlackoutCallback({value:c,unit:i.TimeUnit.SECONDS}),this.updatePublishTimer({value:u,unit:i.TimeUnit.SECONDS}),this.updateSpanGroupFilter(e,n,l),this.cache&&(function(e,n,i){try{var r=Math.floor(Date.now()/1e3),a=d.apex_metrics_web.ApexMetricsCacheData.create({config:d.apex_metrics_web.RecordNamespace.RecordResponse.create({reportingConfigs:n.reporting_configs?n.reporting_configs.map((function(e){return d.apex_metrics_web.RecordNamespace.MetricReportingConfigV2.create({metricNamespace:e.metric_namespace,maxTimeUntilRefreshSeconds:e.max_time_until_refresh_seconds,stopPublicationForSeconds:e.stop_publication_for_seconds,dropSamples:e.drop_samples?o.APIv2CoinToProtobufCoin(e.drop_samples):void 0,dropPeriods:e.drop_periods?o.APIv2CoinToProtobufCoin(e.drop_periods):void 0,dropFractionOfHostsPerMetric:e.drop_fraction_of_hosts_per_metric,aggregationIntervalSeconds:e.aggregation_interval_seconds})})):[],publicationIntervalSeconds:n.publication_interval_seconds,maxScopesPerRequest:n.max_scopes_per_request,stopPublicationForSeconds:n.stop_publication_for_seconds,debugInfos:n.debug_infos||[]}),timeStored:p.google.protobuf.Timestamp.create({seconds:r,nanos:0}),state:i});e.setItem(t._PERSISTENTCACHE_KEY,f.packProto(a))}catch(e){}})(this.cache,e,n)},e.prototype.updateSpanGroupFilter=function(e,t,n){for(var i=e.reporting_configs,r=void 0===i?[]:i,o=e.max_scopes_per_request,a=new Set,c=n.values(),u=c.next();!u.done;u=c.next())a.add(u.value);var l=s.makeNamespaceMap(r,t);this.spanGroupFilter=this.spanGroupFilter?this.spanGroupFilter.extend(o,l,a):new s.SpanGroupFilter(t.filterID,this.randomEngine,this.clock,o,l,a)},e.prototype.updateBlackoutCallback=function(e){var t=this;0!==e.value?(this.blackoutCallback=function(){return t.blackoutCallback=null,t.eventEmitter.emit("publicationResumed"),!1},this.eventEmitter.emit("publicationPaused"),this.executor.executeEvery(e,this.blackoutCallback)):this.blackoutCallback=null},e.prototype.updatePublishTimer=function(e){var t=this,r=e.unit===i.TimeUnit.SECONDS?e.value:i.Instant.toMilliseconds(e)/1e3;if(0!==e.value){if(!this.publishTimer||i.Instant.toMilliseconds(this.publishTimer.period)!==i.Instant.toMilliseconds(e)){var o={period:e,callback:function(){return t.publishTimer===o&&(t.nextRequest=t.currentRequest.then((function(){return n.__awaiter(t,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(n){switch(n.label){case 0:return this.nextRequest=null,e=Math.floor(Date.now()/1e3),[4,this.getDB()];case 1:if(!(t=n.sent()))return[2];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,a.checkAndSetPublishTime(t,e,r)];case 3:return n.sent()&&(this.currentRequest=this.send()),[3,5];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))})),!0)}};this.publishTimer=o,this.executor.executeEvery(this.publishTimer.period,this.publishTimer.callback)}}else this.publishTimer=null},e.prototype.send=function(){return n.__awaiter(this,void 0,Promise,(function(){var e,t,r,o,a,s,u,l,p,d,f,_,g,b,S,y,T,E,x,O;return n.__generator(this,(function(n){switch(n.label){case 0:if(this.blackoutCallback)return this.eventEmitter.emit("publish",m.DENIED),[2,null];for(e=Math.floor(Date.now()/1e3),t=[[c.chrome,"chrome"],[c.edge,"edge"],[c.mozilla,"firefox"],[c.msie,"msie"],[c.safari,"safari"]],r="other",o=0,a=t;o<a.length;o++)if((s=a[o])[0]){r=s[1];break}return u={browser:r},[4,this.getDB()];case 1:if(!(l=n.sent()))return[2,null];p=[],d=0,f=0,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.spanGroupFilter.partitionAndSerializeSpans(l,u,e,["amp_client"])];case 3:return(_=n.sent())&&(p=_[0],d=_[1],f=_[2]),[3,5];case 4:if((g=n.sent())instanceof DOMException&&("InvalidStateError"===g.name||11===g.code))return[2,null];throw g;case 5:if(b=null,!(S=p.length>0))for(y=this.spanGroupFilter.getConfiguredNamespaces(),T=this.knownNamespaces.values(),E=T.next();!E.done;E=T.next())if(!y.has(E.value)){S=!0;break}if(!S)return[3,10];x=v(p,this.knownNamespaces,h),O=this.clock.now(),n.label=6;case 6:return n.trys.push([6,8,,9]),[4,this.client.ns("client_metrics").rpc("record",x,{})];case 7:return b=n.sent(),0!==d&&w(i.MetricsReporterImpl.root(this,this.clock),d,f,i.Instant.toMilliseconds(this.clock.now())-i.Instant.toMilliseconds(O),0,0),[3,9];case 8:return n.sent(),0!==d&&w(i.MetricsReporterImpl.root(this,this.clock),0,0,-1,d,f),[2,null];case 9:this.updateConfiguration(b,this.spanGroupFilter.getState()),n.label=10;case 10:return this.eventEmitter.emit("publish",m.ALLOWED),[2,b]}}))}))},e.prototype.getDB=function(){return n.__awaiter(this,void 0,Promise,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return this.database?[3,2]:(e=this,[4,this.databaseFactory()]);case 1:e.database=t.sent(),t.label=2;case 2:return[2,this.database]}}))}))},e.prototype.recordSpan=function(e){var t=this;this.knownNamespaces.add(e.namespace),this.bufferedSpans.push(e),this.nextRequest||(this.nextRequest=this.currentRequest.then((function(){return n.__awaiter(t,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this.getDB()];case 1:if(!(e=t.sent()))return[2];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,a.storeIncomingSpans(e,this.bufferedSpans)];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return this.bufferedSpans=[],this.publishTimer||(this.currentRequest=this.send()),this.nextRequest=null,[2]}}))}))})))},e})();t.Apiv2MetricsSink=b})),define("modules/clean/metrics/server_view_sink",["require","exports","tslib"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerViewMetricsSink=void 0;var i=(function(){function t(){this.spans=[],this.bridgeInitialized=!1}return t.prototype.recordSpan=function(e){this.spans.push(e),this.bridgeInitialized||this.initializeBridgeSink()},t.prototype.initializeBridgeSink=function(){return n.__awaiter(this,void 0,Promise,(function(){var t,i=this;return n.__generator(this,(function(r){switch(r.label){case 0:return this.bridgeInitialized=!0,[4,new Promise((function(t,n){e(["modules/clean/server_side_client_view_bridge"],t,n)})).then(n.__importStar)];case 1:return[4,(t=r.sent()).IsBridgeFunctionSupported("reportMetricsV2")];case 2:return r.sent()?(setInterval((function(){i.spans.length>0&&(t.ReportMetrics(i.spans),i.spans=[])}),5e3),window.addEventListener("beforeunload",(function(){i.spans.length>0&&(console.log("Attempting to send "+i.spans.length+" pending AMP spans"),t.ReportMetrics(i.spans),i.spans=[])}))):setInterval((function(){this.spans=[]}),6e4),[2]}}))}))},t})();t.ServerViewMetricsSink=i})),define("modules/clean/perf_tools/resource_utils",["require","exports","tslib","modules/core/browser","modules/clean/js_client_stopwatch","modules/clean/perf_tools/cpu_utils"],(function(e,t,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.summarizePerformanceResourceTimings=t.logResourceTiming=t.logResourcesData=void 0,i=n.__importStar(i),o=n.__importStar(o),t.logResourcesData=function(e){(function(e){var t=window.requireContexts;if(!t)return;var n=o.listExecutionPerfMeasurementsForRequireContexts(t),i=r.JSStopwatch.createDetachedStopwatch("resource_init_timeline",e);n.forEach((function(e){var t=i.startSpan(e.name,{startTime:e.startTime});i.addSpanAnnotation(e.name,"totalTimeNs",Math.round(1e6*e.totalTime).toString(),t),i.endSpan(e.name,{endTime:e.startTime+e.totalTime,spanId:t})})),i.logData()})(e),(function(e){var t=i.performance();if(!t||!t.getEntriesByType)return;var n=r.JSStopwatch.createDetachedStopwatch("resource_timeline",e),o={},a=t.getEntriesByType("resource");if(a instanceof Array)for(var u=0,l=a;u<l.length;u++){var p=l[u],d=s(p);if(d){var f=o[d]||0;o[d]=f+1,f>0&&(d=d+"-"+f);var m=n.startSpan(d,{startTime:p.startTime,async:!0}),_=c(p);n.addSpanAnnotation(d,"type",_,m),0===p.transferSize?n.addSpanAnnotation(d,"cached","true",m):void 0===p.transferSize?n.addSpanAnnotation(d,"cached","unknown",m):n.addSpanAnnotation(d,"cached","false",m),p.responseEnd<p.startTime?(n.addSpanAnnotation(d,"negativeSpanLength",(p.responseEnd-p.startTime).toString(),m),n.endSpan(d,{endTime:p.startTime,spanId:m})):n.endSpan(d,{endTime:p.responseEnd,spanId:m})}}n.logData()})(e)};var a=document&&document.createElement?document.createElement("a"):null;function s(e){if(a){if(a.href=e.name,a.host.match(/dropboxstatic.com$/)&&a.pathname.match(/^\/static/)){var t=a.pathname,n=t.match(/vfl[a-zA-Z0-9]*\.[a-z]*$/);n&&n.index&&(t=t.substring(0,n.index-1));for(var i=0,r=["/static/js/","/static/"];i<r.length;i++){var o=r[i];t.startsWith(o)&&(t=t.substring(o.length))}return t}return a.host.match(/photos-[0-9]+.dropbox.com$/)&&a.pathname.match(/^\/t\/2/)?"/thumbnail":void 0}}function c(e){var t=e.name,n=e.initiatorType,i=t.lastIndexOf(".");if(i>0){var r=t.substring(i);if([".png",".gif",".jpg",".svg"].indexOf(r)>-1)return"img";if(".js"===r)return"script";if(".css"===r)return"css"}return-1===["css","img","script","link"].indexOf(n)?"xmlhttprequest"===n?"ajax":"other":n}t.logResourceTiming=function(e){var t=i.performance();if(t&&t.getEntriesByType){var n=t.getEntriesByType("resource").filter((function(t){return-1!==t.name.indexOf(e)}))[0];if(n&&n.responseEnd){var o="resource_response_end_"+e;return r.JSStopwatch.create_stopwatch_if_not_exist("resource_timing"),r.JSStopwatch.recordTrace(o,{stopwatchName:"resource_timing",traceTime:n.responseEnd}),n}}},t.summarizePerformanceResourceTimings=function(e,t){void 0===t&&(t=void 0);var n={pre:{},total:{}};if(r.JSStopwatch.create_stopwatch_if_not_exist("resource_timeline"),e instanceof Array)for(var i=function(e){var i=c(e),r=[];t&&e.responseEnd<=t&&(i in n.pre||(n.pre[i]={count:0,total_time:0,last_transfer_end:0}),r.push(n.pre[i])),i in n.total||(n.total[i]={count:0,total_time:0,last_transfer_end:0}),r.push(n.total[i]),r.forEach((function(t){var n;t.count++,t.total_time+=e.duration,t.last_transfer_end=Math.max(t.last_transfer_end,e.responseEnd),"css"!==(n=i)&&"script"!==n&&"img"!==n||void 0===e.transferSize||void 0===e.encodedBodySize||(t.total_size=t.total_size||0,t.transfer_size=t.transfer_size||0,0!==e.transferSize&&(t.transfer_size+=e.encodedBodySize),t.total_size=t.total_size||0,t.total_size+=e.encodedBodySize)}))},o=0,a=e;o<a.length;o++){i(a[o])}return n}})),define("modules/clean/perf_tools/cpu_utils",["require","exports","modules/clean/js_client_stopwatch"],(function(e,t,n){"use strict";var i;function r(e){if(e.require&&e.require.perfMeasurements){var t=0;return e.require.perfMeasurements.map((function(e){var n=e.name,i=e.startTime,r=e.totalTime;return n.endsWith("anon")&&(n+="-"+t++),{jsExecutionType:c(n),name:n,startTime:i,totalTime:r}}))}var n=e.module_callback_times;return Object.keys(n).filter((function(e){return n[e].callbackDuration&&n[e].callbackTime})).map((function(e){return{jsExecutionType:c(e),name:e,startTime:n[e].callbackTime,totalTime:n[e].callbackDuration}}))}function o(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];t=t.concat(r(i))}return t}function a(e){return Object.keys(e).map((function(t){var n=e[t];return{measurement:{jsExecutionType:s(t),name:t,startTime:n.start,totalTime:n.end-n.start},annotations:n.annotations}}))}function s(e){return e.startsWith("dws-processChunk")?i.DWS:i.UNKNOWN}function c(e){return e.startsWith("execCb.anon")||e.startsWith("overhead.anon")||e.startsWith("execCb.require-tier")||e.startsWith("overhead.require-tier")?i.OTHER:e.startsWith("execCb")||e.startsWith("overhead")?i.MODULE:i.UNKNOWN}Object.defineProperty(t,"__esModule",{value:!0}),t.logCumulativeExecutionTimes=t.cumulativeExecutionTimesBefore=t.listAnnotatedExecutionPerfMeasurementsForEnsemble=t.listExecutionPerfMeasurementsForRequireContexts=t.getAllGlobalExecutionPerfMeasurements=t.ALL_JS_EXECUTION_TYPES=t.JSExecutionType=void 0,(function(e){e.DWS="dws",e.MODULE="module",e.OTHER="other",e.UNKNOWN="unknown"})(i=t.JSExecutionType||(t.JSExecutionType={})),t.ALL_JS_EXECUTION_TYPES=[i.DWS,i.MODULE,i.OTHER,i.UNKNOWN],t.getAllGlobalExecutionPerfMeasurements=function(){var e=[];return window.ensemble&&window.ensemble.getJSStopwatchData&&(e=e.concat(a(window.ensemble.getJSStopwatchData()).map((function(e){return e.measurement})))),window.requireContexts&&(e=e.concat(o(window.requireContexts))),e},t.listExecutionPerfMeasurementsForRequireContexts=o,t.listAnnotatedExecutionPerfMeasurementsForEnsemble=a,t.cumulativeExecutionTimesBefore=function(e,t){var n={},i=function(i){if(e.hasOwnProperty(i)){var r=e[i];n[i]={},t.forEach((function(e){0<e.startTime&&e.startTime<r&&(n[i][e.jsExecutionType]=n[i][e.jsExecutionType]||0,n[i][e.jsExecutionType]+=e.totalTime)}))}};for(var r in e)i(r);return n},t.logCumulativeExecutionTimes=function(e,i){var r=n.JSStopwatch.createDetachedStopwatch("cumulative_cpu_time",e),o=function(e){i.hasOwnProperty(e)&&t.ALL_JS_EXECUTION_TYPES.forEach((function(t){r.recordTrace("cpu_before_"+e+"_due_to_"+t,i[e][t]||0)}))};for(var a in i)o(a);r.logData()}})),define("modules/clean/perf_tools/browser_perf_utils",["require","exports","tslib","modules/core/browser","modules/core/xhr","modules/constants/request","modules/clean/js_client_stopwatch","modules/constants/webtiming"],(function(e,t,n,i,r,o,a,s){"use strict";function c(e){var t=i.performance();if(t&&t.timing){var n=t.timing,c={navigation_start:n.navigationStart,unload_event_start:n.unloadEventStart,unload_event_end:n.unloadEventEnd,redirect_start:n.redirectStart,redirect_end:n.redirectEnd,fetch_start:n.fetchStart,domain_lookup_start:n.domainLookupStart,domain_lookup_end:n.domainLookupEnd,connect_start:n.connectStart,secure_connect_start:n.secureConnectionStart,connect_end:n.connectEnd,request_start:n.requestStart,response_start:n.responseStart,response_end:n.responseEnd,dom_loading:n.domLoading,dom_interactive:n.domInteractive,dom_content_loaded_event_start:n.domContentLoadedEventStart,dom_content_loded_event_end:n.domContentLoadedEventEnd,dom_complete:n.domComplete,load_event_start:n.loadEventStart,load_event_end:n.loadEventEnd},u={};u.request_id=o.REQUEST_ID,u.referrer=document.referrer;var l=a.JSStopwatch.createDetachedStopwatch("browser_perf",e);for(var p in c)c.hasOwnProperty(p)&&(u[p]=c[p],c[p]&&l.recordTrace(p,c[p]-n.navigationStart));l.logData(),s.LOG_BROWSER_PERFORMANCE_INFO&&r.sendXhr("/alternate_wtl_browser_performance_info",u)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logBrowserPerformanceInfo=t.logBrowserPerfData=void 0,i=n.__importStar(i),r=n.__importStar(r),o=n.__importStar(o),s=n.__importStar(s),t.logBrowserPerfData=function(e){(function(e){var t=i.performance();if(!t||!t.getEntriesByType)return;var n=a.JSStopwatch.createDetachedStopwatch("performance_marks",e),r=t.getEntriesByType("mark");if(r instanceof Array)for(var o=0,s=r;o<s.length;o++){var c=s[o];n.recordTrace(c.name,c.startTime)}n.logData()})(e),c(e)},t.logBrowserPerformanceInfo=c})),define("modules/clean/perf_tools/web_timing_logger_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebTimerEvent=t.NavigationType=void 0;var n=(function(){function e(){}return e.getFromNavigation=function(t){switch(t.type){case t.TYPE_NAVIGATE:return e.NAVIGATE;case t.TYPE_RELOAD:return e.RELOAD;case t.TYPE_BACK_FORWARD:return e.BACK_FORWARD}},e.NAVIGATE="navigate",e.RELOAD="reload",e.BACK_FORWARD="back_forward",e})();t.NavigationType=n;var i=(function(){function e(t,n,i,r,o){void 0===i&&(i=!1),void 0===r&&(r=!0),this.name=t,this.flag=1<<n,this.triggersLogging=i,this.timestampPrefix=o||t,this.ordered=r,e.allEvents.push(this)}return e.allEvents=[],e.APPLICATION_START=new e("application_code_start",1),e.LOAD_END=new e("load_end",2,!0,!1),e.MARK_TIME_TO_VIEW=new e("mark_time_to_view",3,!0,!0,"TTV"),e.FETCHED_DATA_FOR_TTI=new e("fetched_data_required_for_tti",4),e.MARK_TIME_TO_INTERACTIVE=new e("mark_time_to_interactive",5),e.TIME_TO_INTERACTIVE=new e("time_to_interactive",6,!0,!0,"TTI"),e})();t.WebTimerEvent=i})),define("modules/clean/perf_tools/web_timing_utils",["require","exports","tslib","modules/core/browser"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableCallback=t.WebTimingUtil=void 0,i=n.__importStar(i);var r=(function(){function e(){}return e.generateCorrelationId=function(){return Math.random().toString(36).substring(2)},e.getNow=function(){var e=i.performance();if(e&&e.timing&&e.now){var t=e.timing;return(t.navigationStart||t.fetchStart)+Math.floor(e.now())}return Date.now()},e.newContext=function(t,n){var r;if(void 0===n&&(n="unnamed_timer"),t)r=e.getNow();else{var o=i.performance();if(o&&o.timing){var a=o.timing;r=a.navigationStart||a.fetchStart}else r=e.getNow()}return{initialized:!1,is_pagelet:!1,is_dws:!1,is_dws2:!1,is_early_ensemble:!1,is_page_restore:!1,log_time_to_view:!1,log_time_to_interactive:!1,ttv_at_dom_interactive:!1,tti_at_dom_interactive:!1,source_type:"web",subtypes:{},tti_exclusion_flow:"",have_logged_web_timing:!1,delayed_tti_for_css:!1,timing_results:null,start_time:r,time_to_view:null,time_to_interactive:null,correlation_id:e.generateCorrelationId(),timesStagesWereReached:{},context_name:n}},e})();t.WebTimingUtil=r;var o=(function(){function e(e){this.canceled=!1,this.callback=e}return e.prototype.exec=function(){this.canceled||this.callback()},e.prototype.cancel=function(){this.canceled=!0},e.prototype.isCanceled=function(){return this.canceled},e})();t.CancellableCallback=o})),define("modules/clean/visibility_logging",["require","exports","modules/clean/js_client_stopwatch","modules/clean/js_basic_stopwatch"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logVisibilityChangeEvents=t.logPaintPerformance=void 0,t.logPaintPerformance=function(e){if(window.performance&&window.performance.getEntriesByType){var t=window.performance.getEntriesByType("paint").map((function(e){return{type:i.TimingDataType.Trace,name:e.name,endTime:e.startTime}}));if(t.length>0){var r=n.JSStopwatch.createDetachedStopwatch("paint",e);r.recordEntries(t),r.logData()}}},t.logVisibilityChangeEvents=function(e,t){if(window.performance&&window.performance.getEntriesByType){var r=Number.MAX_VALUE;e.time_to_interactive&&(r=e.time_to_interactive-e.start_time);var o,a=window.performance.getEntriesByType("mark").filter((function(e){return e.name.startsWith("VisibilityState.")})).map((function(e){return{visibility:e.name,time:e.startTime}})),s={"VisibilityState.visible":0,"VisibilityState.hidden":0},c=function(e){o&&o.time<r&&(s[o.visibility]=(s[o.visibility]||0)+Math.min(e,r)-o.time)},u=[];for(var l in a.forEach((function(e,t){c(e.time),u.push({type:i.TimingDataType.Trace,name:"visibility-change-"+t,endTime:e.time,annotations:{visibility:e.visibility}}),o=0===t?{visibility:e.visibility,time:0}:e})),c(window.performance.now()),s)s.hasOwnProperty(l)&&u.push({type:i.TimingDataType.Trace,name:"total-"+l+"-time",endTime:s[l]});var p=n.JSStopwatch.createDetachedStopwatch("visibility",t);p.recordEntries(u),p.logData()}}})),define("modules/clean/web_module_timing",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.add_module=t.get_module_times=void 0,t.get_module_times=function(){var e=[];for(var t in window.requireContexts){var n=window.requireContexts[t].module_callback_times;for(var i in n)if(n.hasOwnProperty(i)){var r=n[i];if(null!=r.loadTime){var o={load_time:r.loadTime,callback_duration:r.callbackDuration,callback_time:r.callbackTime,name:r.name,url:r.url,parent:r.parent};e.push(o)}}}return e},t.add_module=function(){}})),define("modules/clean/web_timing_logger",["require","exports","tslib","apex-metrics/index","modules/clean/metrics/index","modules/clean/devtools/panels/performance/perf_hub_actions","modules/clean/event_load","modules/clean/web_module_timing","modules/clean/window_util","modules/clean/perf_tools/resource_utils","modules/clean/perf_tools/web_timing_logger_types","modules/clean/perf_tools/web_timing_utils","modules/clean/js_client_stopwatch","modules/clean/perf_tools/browser_perf_utils","modules/clean/init_react","modules/clean/perf_tools/cpu_utils","modules/clean/js_basic_stopwatch","modules/constants/request","modules/constants/webtiming","modules/constants/page_load","modules/core/browser","modules/core/exception","modules/core/xhr","dropbox/proto/js_init_data/web_timing_logger/web_timing_logger","modules/clean/visibility_logging"],(function(e,t,n,i,r,o,a,s,c,u,l,p,d,f,m,_,h,g,v,w,b,S,y,T,E){"use strict";var x;Object.defineProperty(t,"__esModule",{value:!0}),t.log_js_modules_fetched_data_required_for_tti=t.log_js_modules_application_code_start=t.waitForTTI=t.mark_time_to_interactive=t.mark_time_to_view=t.set_tti_exclusion_flow=t.time_since_start=t.start_time=t.reset=t.initialize=t.initialize_module=t.time_to_interactive=t.time_to_view=t.delete_timer=t.get_timer=t.perfHubClassName=void 0,a=n.__importStar(a),c=n.__importStar(c),g=n.__importStar(g),v=n.__importStar(v),w=n.__importStar(w),b=n.__importStar(b),S=n.__importStar(S),y=n.__importStar(y),(function(e){e[e.NEW=1]="NEW",e[e.RUNNING=2]="RUNNING",e[e.ABORTED=3]="ABORTED",e[e.CLOSED=4]="CLOSED"})(x||(x={})),t.perfHubClassName="perf-hub-link-container";var O=["navigation_type","referrer","repo_rev","source_type","active_user_id"],k=["tti_flow","tti_exclusion_flow","is_dws2"];function C(){return"hidden"===window.document.visibilityState}var I=[[l.WebTimerEvent.APPLICATION_START,l.WebTimerEvent.MARK_TIME_TO_VIEW,l.WebTimerEvent.FETCHED_DATA_FOR_TTI,l.WebTimerEvent.MARK_TIME_TO_INTERACTIVE],[l.WebTimerEvent.TIME_TO_INTERACTIVE]].reverse(),R=1;var N=["requirejs_start","ensemble_payload_start","body_start"];var A=["craft_fast_prefetch_done","dws_core_externals_loaded","dws_ensemble_init","dws-processChunk-embedded-app-done-1","dws-processChunk-embedded-app-require_config-1","ensemble_init","module_init","last_js_const_end","pagelet_render_on_page_embedded-app","pagelet_css_loaded_embedded-app"];var P,D=(function(){function e(){d.JSStopwatch.create_stopwatch_if_not_exist("web_timing_logger"),this.shouldLogJsModuleTimes=function(){return Math.random()<.001}}return e.prototype.buildBaseParams=function(e,t,n){void 0===n&&(n={});var i=e.start_time,r=e.subtypes||{};e.tti_flow&&(r.tti_flow=e.tti_flow);var o,a,s={log_source:t.name,subtypes:JSON.stringify(r),correlation_id:e.correlation_id};e.extra_columns&&Object.keys(e.extra_columns).forEach((function(t){var n=e.extra_columns[t];n&&(s[t]=n)})),Object.keys(n).forEach((function(e){var t=n[e];t&&(s[e]=t)})),g.IS_HTTP2&&(s.is_spdy=!0),e.is_pagelet&&(s.is_pagelet=!0),e.is_dws&&(s.is_dws=!0),e.is_early_ensemble&&(s.is_early_ensemble=!0),s.delayed_tti_for_css=e.delayed_tti_for_css,""!==e.tti_exclusion_flow&&(s.tti_exclusion_flow=e.tti_exclusion_flow),o=e.log_time_to_view&&null!=e.time_to_view?e.time_to_view-i:null,a=e.log_time_to_interactive&&null!=e.time_to_interactive?e.time_to_interactive-i:null;var c={navigation_type:e.is_page_restore?l.NavigationType.RELOAD:this.get_navigation_type(),server_request_start_time:g.REQUEST_START_TIME,extra_columns:JSON.stringify(s),subtypes:JSON.stringify(r),source_type:e.source_type,page_load_time:e.end_time-e.start_time,repo_rev:w.REPO_REV};if(this.shouldLogJsModuleTimes()&&Y(c),e.log_time_to_view&&(c.time_to_view=o),e.log_time_to_interactive&&(c.time_to_interactive=a),c.url=b.get_href(),0===c.url.indexOf("/dws2/")&&(c.url=c.url.substring("/dws2/".length-1)),c.referrer=document.referrer,c.request_id=e.request_id||g.REQUEST_ID,c.request_tracing_enabled=g.REQUEST_TRACING_ENABLED,window.ensemble&&window.ensemble.viewer){var u=window.ensemble.viewer.getActiveUser();u&&(c.active_user_id=u.userId),c.dws_page_name=window.ensemble.getPageName()}return c},e.prototype.get_navigation_type=function(){var e=b.performance();if(e&&e.navigation){var t=e.navigation;return l.NavigationType.getFromNavigation(t)}},e.prototype.log=function(e,n,i){void 0===i&&(i=!1);var r=d.JSStopwatch.startSpan("wtl_endpoint",{stopwatchName:"web_timing_logger"});d.JSStopwatch.addSpanAnnotation("wtl_endpoint","navigation_type",n.navigation_type,{stopwatchName:"web_timing_logger",spanId:r});var a=y.sendXhr("/alternate_wtl",n);a.onreadystatechange=function(e){if(a.readyState===XMLHttpRequest.DONE&&200===a.status){d.JSStopwatch.endSpan("wtl_endpoint",{stopwatchName:"web_timing_logger",spanId:r});var n=document.getElementsByClassName(t.perfHubClassName);if(i&&n.length){var s=JSON.parse(a.responseText);s.status&&o.PerfHubActions.add_web_timing_details(s)}}}},e})(),M=(function(e){function t(){return e.call(this)||this}return n.__extends(t,e),t.prototype.shouldLog=function(e){return e.initialized&&!e.have_logged_web_timing&&void 0!==e.end_time&&(!e.log_time_to_view||null!=e.time_to_view)&&(!e.log_time_to_interactive||null!=e.time_to_interactive)},t.prototype.logTiming=function(e,t){e.have_logged_web_timing=!0;var n=this.buildBaseParams(e,t),i=F(e,n);return this.log(e,n,!1),i},t.prototype.get_navigation_type=function(){return"ajax"},t})(D),L=(function(e){function t(){var t=e.call(this)||this;return t.metricsReporter=r.getMetricsReporter(),t}return n.__extends(t,e),t.prototype.shouldLog=function(e){if(!e.initialized||e.have_logged_web_timing)return!1;var t=b.performance();if(!t||!t.timing)return!1;var n=t.timing,i=e.start_time,r=e.end_time;return!(!i||!r)&&(!(e.log_time_to_view&&!(e.ttv_at_dom_interactive&&n.domInteractive||null!=e.time_to_view))&&!(e.log_time_to_interactive&&!(e.tti_at_dom_interactive&&n.domInteractive||null!=e.time_to_interactive)))},t.prototype.logTiming=function(e,t){var n=b.performance(),r=n.timing,o=_.getAllGlobalExecutionPerfMeasurements(),a=e.timesStagesWereReached["dws_embedded-app_require_config_callback"];void 0===a?a=e.timesStagesWereReached.application_code_start:e.timesStagesWereReached.hasOwnProperty("application_code_start")&&(a=Math.min(a,e.timesStagesWereReached.application_code_start)),d.JSStopwatch.startSpan("process_nav_timing",{stopwatchName:"web_timing_logger"});var s=this.buildBaseParams(e,t,{}),c=F(e,s),p=window.ensemble&&window.ensemble.getJSStopwatchData?window.ensemble.getJSStopwatchData():{},h="function"==typeof n.getEntriesByType?u.summarizePerformanceResourceTimings(n.getEntriesByType("resource"),a):{pre:{},total:{}};if(s.browser_time=(r.redirectStart||r.fetchStart)-e.start_time,s.redirect_time=r.fetchStart-e.start_time,s.dns_time=r.domainLookupEnd-e.start_time,s.tcp_connect_time=(r.secureConnectionStart||r.requestStart)-e.start_time,s.ssl_connect_time=r.requestStart-e.start_time,s.time_to_first_byte=r.responseStart-e.start_time,s.time_to_last_byte=r.responseEnd-e.start_time,s.dom_load_time=r.domContentLoadedEventEnd-e.start_time,s.idle_cpu_time=e.timing_results?Math.round(e.timing_results.idleCPUTime):void 0,s.total_tracked_cpu_time=e.timing_results?Math.round(e.timing_results.totalTrackedCPUTime):void 0,s.untracked_time_after_first_byte=e.timing_results&&null!=e.timing_results.untrackedTimeAfterFirstByte?Math.round(e.timing_results.untrackedTimeAfterFirstByte):void 0,b.performance().getEntriesByType&&((function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t["resource_"+n+"_count"]=e[n].count,t["resource_"+n+"_avg_time"]=e[n].total_time/e[n].count||1,void 0!==e[n].total_size&&(t["resource_"+n+"_total_size"]=e[n].total_size),void 0!==e[n].transfer_size&&(t["resource_"+n+"_transfer_size"]=e[n].transfer_size))})(h.total,s),(function(e,t){var n;for(n in e)if(e.hasOwnProperty(n)){var i=e[n];for(var r in i)if(i.hasOwnProperty(r)){var o=i[r].transfer_size,a=i[r].total_size,s=i[r].count,c=i[r].total_time;if(t.recordTrace(n+"_"+r+"_count",s),t.recordTrace(n+"_"+r+"_total_time",c),void 0!==o&&void 0!==a&&a>0){var u=o/a;t.recordTrace(n+"_"+r+"_transferred_size",o),t.recordTrace(n+"_"+r+"_total_size",a),t.recordTrace(n+"_percent_"+r+"_transferred",100*u)}t.recordTrace(n+"_last_"+r+"_transfer_end",i[r].last_transfer_end)}}t.logData()})(h,d.JSStopwatch.createDetachedStopwatch("resources_percent_transferred",c)),d.JSStopwatch.addSpanAnnotation("process_nav_timing","logged_resources","1",{stopwatchName:"web_timing_logger"})),this.shouldLogJsModuleTimes()&&Y(s),d.JSStopwatch.addSpanAnnotation("process_nav_timing","logged_modules","1",{stopwatchName:"web_timing_logger"}),d.JSStopwatch.endSpan("process_nav_timing",{stopwatchName:"web_timing_logger"}),e.is_pagelet&&Object.getOwnPropertyNames(p).length>0&&(function(e,t,n){var i=(function(e,t){var n=_.listAnnotatedExecutionPerfMeasurementsForEnsemble(t),i=d.JSStopwatch.createDetachedStopwatch("ensemble",e),r=n.map((function(e){var t=e.measurement,n=e.annotations;return{name:t.name,startTime:t.startTime,endTime:t.startTime+t.totalTime,annotations:n}}));return G(i,r),i})(n,t),r=void 0,o=void 0;for(var a in t)t.hasOwnProperty(a)&&(K.includes(a)&&(e.timesStagesWereReached[a]=t[a].start),["ensemble_init","dws_embedded-app_require_config_callback"].includes(a)&&(r=r?Math.min(r,t[a].end):t[a].end),$.test(a)&&(o=o?Math.max(o,t[a].end):t[a].end));o&&i.recordTrace("last_js_const_end",o);r&&i.recordTrace("module_init",r)})(e,p,c),f.logBrowserPerfData(c),(function(e,t,n){_.logCumulativeExecutionTimes(e,_.cumulativeExecutionTimesBefore(t,n))})(c,e.timesStagesWereReached,o),this.get_navigation_type()===l.NavigationType.NAVIGATE&&((function(e){var t=m.getReactInitData();G(d.JSStopwatch.createDetachedStopwatch("init_react",e),t)})(c),u.logResourcesData(c)),d.JSStopwatch.log_stored_results(),(function(e,t){return!e.is_page_restore&&(t.navigation_type===l.NavigationType.NAVIGATE||"ajax"===t.navigation_type)})(e,s)){var g=(function(e,t){var n={is_dws:String(e.is_dws),source_type:String(e.source_type)},i="";return e.subtypes.amp_tti_flow?i=e.subtypes.amp_tti_flow:t.dws_page_name&&(i="dws_page_name:"+t.dws_page_name),""!==i&&(n.product=i),t.navigation_type&&(n.navigation_type=t.navigation_type),n})(e,s),v=this.metricsReporter.child(g);(function(e,t){e.time_to_interactive&&t.createStats({ns:"web_timing",name:"temp/time-to-interactive"}).recordDuration(e.time_to_interactive,i.TimeUnit.MILLISECONDS)})(s,v),(function(e,t){var n;for(n in e)if(e.hasOwnProperty(n)){var r=e[n];for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],s=a.transfer_size,c=a.total_size,u=a.count,l=a.total_time,p=a.last_transfer_end;t.createStats({ns:"web_timing",name:"temp/resources/"+n+"/"+o+"/count"}).record(u),t.createStats({ns:"web_timing",name:"temp/resources/"+n+"/"+o+"/total-time"}).recordDuration(l,i.TimeUnit.MILLISECONDS),t.createStats({ns:"web_timing",name:"temp/resources/"+n+"/"+o+"/last-transfer-end"}).recordDuration(p,i.TimeUnit.MILLISECONDS),void 0!==s&&void 0!==c&&c>0&&(t.createStats({ns:"web_timing",name:"temp/resources/"+n+"/"+o+"/transferred-size"}).record(s),t.createStats({ns:"web_timing",name:"temp/resources/"+n+"/"+o+"/total-size"}).record(c))}}})(h,v),e.is_pagelet&&Object.getOwnPropertyNames(p).length>0&&(function(e,t,n){var r=_.listAnnotatedExecutionPerfMeasurementsForEnsemble(t),o=void 0,a=void 0;r.forEach((function(t){var r=t.measurement,s=r.startTime+r.totalTime;-1!==A.indexOf(r.name)&&n.createStats({ns:"web_timing",name:"temp/ensemble-timing/"+r.name}).recordDuration(s,i.TimeUnit.MILLISECONDS),K.includes(r.name)&&(e.timesStagesWereReached[r.name]=r.startTime),["ensemble_init","dws_embedded-app_require_config_callback"].includes(r.name)&&(o=o?Math.min(o,s):s),$.test(r.name)&&(a=a?Math.max(a,s):s)})),void 0!==a&&n.createStats({ns:"web_timing",name:"temp/last-js-const-end"}).recordDuration(a,i.TimeUnit.MILLISECONDS),void 0!==o&&n.createStats({ns:"web_timing",name:"temp/module-init"}).recordDuration(o,i.TimeUnit.MILLISECONDS)})(e,p,v),n&&n.getEntriesByType&&((function(e,t){e.getEntriesByType("mark").filter((function(e){return N.indexOf(e.name)>-1})).forEach((function(e){t.createStats({ns:"web_timing",name:"temp/browser-perf/marks/"+e.name}).recordDuration(e.startTime,i.TimeUnit.MILLISECONDS)}))})(n,v),(function(e,t){var n=e.getEntriesByType("navigation")[0],r=void 0===n?null:n;r&&([["temp/browser-perf/navigation/unload-event-start",r.unloadEventStart],["temp/browser-perf/navigation/unload-event-end",r.unloadEventEnd],["temp/browser-perf/navigation/dom-interactive",r.domInteractive],["temp/browser-perf/navigation/dom-content-loaded-event-start",r.domContentLoadedEventStart],["temp/browser-perf/navigation/dom-content-loaded-event-end",r.domContentLoadedEventEnd],["temp/browser-perf/navigation/dom-complete",r.domComplete],["temp/browser-perf/navigation/load-event-start",r.loadEventStart],["temp/browser-perf/navigation/load-event-end",r.loadEventEnd],["temp/browser-perf/navigation/redirect-count",r.redirectCount],["temp/browser-perf/navigation/worker-start",r.workerStart],["temp/browser-perf/navigation/redirect-start",r.redirectStart],["temp/browser-perf/navigation/redirect-end",r.redirectEnd],["temp/browser-perf/navigation/fetch-start",r.fetchStart],["temp/browser-perf/navigation/domain-lookup-start",r.domainLookupStart],["temp/browser-perf/navigation/domain-lookup-end",r.domainLookupEnd],["temp/browser-perf/navigation/connect-start",r.connectStart],["temp/browser-perf/navigation/connect-end",r.connectEnd],["temp/browser-perf/navigation/secure-connect-start",r.secureConnectionStart],["temp/browser-perf/navigation/request-start",r.requestStart],["temp/browser-perf/navigation/response-start",r.responseStart],["temp/browser-perf/navigation/response-end",r.responseEnd],["temp/browser-perf/navigation/transfer-size",r.transferSize]].forEach((function(e){var n=e[0],r=e[1];"number"==typeof r&&t.createStats({ns:"web_timing",name:n}).recordDuration(r,i.TimeUnit.MILLISECONDS)})),[["temp/browser-perf/navigation/encoded-body-size",r.encodedBodySize],["temp/browser-perf/navigation/decoded-body-size",r.decodedBodySize]].forEach((function(e){var n=e[0],i=e[1];"number"==typeof i&&t.createStats({ns:"web_timing",name:n}).record(i)})))})(n,v))}return E.logPaintPerformance(c),E.logVisibilityChangeEvents(e,c),e.have_logged_web_timing=!0,this.log(e,s,!0),c},t.prototype.log=function(t,n,i){void 0===i&&(i=!1),e.prototype.log.call(this,t,n,i)},t})(D),j=(function(){function e(e,t,n,i){this.childSpans=[],this.spanName=e,this.startTime=void 0!==n?n:p.WebTimingUtil.getNow(),this.originTs=t,this.startTimeOffsetMS=this.startTime-t,this.endCallback=i}return e.prototype.startSpan=function(t){var n=new e(t,this.originTs);return this.childSpans.push(n),n},e.prototype.markSpan=function(t,n){var i=new e(t,this.originTs,this.startTime);this.childSpans.push(i),i.endSpan(n)},e.prototype.endSpan=function(e){var t=this;this.endTime=void 0!==e?e:p.WebTimingUtil.getNow(),this.childSpans.forEach((function(e){e.hasEnded()||e.endSpan(t.endTime)})),this.endCallback&&this.endCallback(this)},e.prototype.getEndTimeOffsetMS=function(){return void 0!==this.endTime?this.endTime-this.originTs:void 0},e.prototype.hasEnded=function(){return void 0!==this.endTime},e})(),B=(function(){function e(e,t,n,i){void 0===i&&(i=!1),this.timerState=x.RUNNING,this.loggedEvents=0,this.activeSpans=[],this.endedSpans=[],this.context=e,this.timingStopwatch=t,this.userStopwatch=n,this.id=R++,this.strictAssert=i}return e.prototype.startSpan=function(e){var t=this,n=new j(e,this.context.start_time,void 0,(function(e){t.endSpan(e)}));return this.activeSpans.push(n),n},e.prototype.markSpan=function(e,t){if(void 0===t&&(t={}),this.userStopwatch){var n=void 0===t.startTime?0:t.startTime,i=this.timeSinceStart(t.endTime),r=this.userStopwatch.startSpan(e,{startTime:n});this.userStopwatch.endSpan(e,{spanId:r,endTime:i})}else{var o=new j(e,this.context.start_time,t.startTime);o.endSpan(t.endTime),this.endedSpans.push(o)}},e.prototype.endSpan=function(e){var t=this.activeSpans.indexOf(e);t>=0&&(delete this.activeSpans[t],this.userStopwatch?this.recordSpan(e):this.endedSpans.push(e))},e.prototype.recordSpan=function(e){var t=this,n=this.userStopwatch.startSpan(e.spanName,{startTime:e.startTimeOffsetMS});e.childSpans.forEach((function(e){t.recordSpan(e)})),this.userStopwatch.endSpan(e.spanName,{spanId:n,endTime:e.getEndTimeOffsetMS()})},e.prototype.getContextName=function(){return this.context.context_name},e.prototype.applicationStart=function(){this.logEvent(l.WebTimerEvent.APPLICATION_START)},e.prototype.fetchedDataRequiredForTTI=function(){this.logEvent(l.WebTimerEvent.FETCHED_DATA_FOR_TTI)},e.prototype.startTime=function(){return this.context.start_time},e.prototype.timeSinceStart=function(e){return(e||p.WebTimingUtil.getNow())-this.context.start_time},e.prototype.timeToView=function(){return this.context.time_to_view},e.prototype.timeToInteractive=function(){return this.context.time_to_interactive},e.prototype.reportTTIAfterPaint=function(){var e=this,t=new p.CancellableCallback((function(){e.reportTTI()}));return window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){t.exec()}))})),t},e.prototype.setExtraColumns=function(e){this.context.extra_columns=e},e.prototype.excludeFromTTI=function(e){""!==this.context.tti_exclusion_flow&&(this.context.tti_exclusion_flow=this.context.tti_exclusion_flow+","),this.context.tti_exclusion_flow=this.context.tti_exclusion_flow+e},e.prototype.logEvent=function(e,t){this.logEventInternal(e,!0,t)},e.prototype.logSilentEvent=function(e,t){this.logEventInternal(e,!1,t)},e.prototype.logEventInternal=function(e,t,n){this.loggedEvents|=e.flag,e.ordered&&this.validateEventOrder(e);var i=this.timeSinceStart(n);this.context.timesStagesWereReached[e.name]=i,this.timingStopwatch.recordTrace(e.name,i),console.timeStamp&&console.timeStamp(e.timestampPrefix);var r=b.performance();r&&"function"==typeof r.mark&&r.mark(e.name),t&&e.triggersLogging&&this.logIfReady(e)},e.prototype.validateEventOrder=function(e){for(var t=0,n=0,i=I;n<i.length;n++){var r=i[n];if(r.includes(e))break;for(var o=0,a=r;o<a.length;o++){t|=a[o].flag}}var s=t&this.loggedEvents;if(s>0){var c=l.WebTimerEvent.allEvents.filter((function(e){return(e.flag&s)>0})).map((function(e){return e.name}));this.reportSwMisuse("Received "+e.name+" after ["+c.join(",")+"]")}},e.prototype.logIfReady=function(e){if(this.logger.shouldLog(this.context)){this.addEventBasedTiming();var t=this.logger.logTiming(this.context,e);V(this.timingStopwatch,t),V(this.userStopwatch,t),this.timingStopwatch.logData(),this.userStopwatch.logData(),this.timerState=x.CLOSED}},e.prototype.addEventBasedTiming=function(){var e=b.performance().timing;this.context.ttv_at_dom_interactive&&(this.context.is_pagelet&&window.ensemble?this.context.time_to_view=window.ensemble.getEmbeddedAppDOMInteractive():this.context.time_to_view=e.domInteractive,this.logSilentEvent(l.WebTimerEvent.MARK_TIME_TO_VIEW,this.context.time_to_view)),this.context.tti_at_dom_interactive&&(this.context.time_to_interactive=e.domInteractive,this.logSilentEvent(l.WebTimerEvent.MARK_TIME_TO_INTERACTIVE,this.context.time_to_interactive),this.logSilentEvent(l.WebTimerEvent.TIME_TO_INTERACTIVE,this.context.time_to_interactive))},e.prototype.reportSwMisuse=function(e){e="WebTimer: "+e,this.strictAssert?S.assert(!1,e):S.reportStack(e,{severity:S.SEVERITY.NONCRITICAL,tags:["web_timing_logger"]})},e})(),W=(function(e){function t(t){var n=e.call(this,t,d.JSStopwatch.createDetachedStopwatch("maestro_tracing",{correlation_id:t.correlation_id}),d.JSStopwatch.createDetachedStopwatch("user_tracing",{correlation_id:t.correlation_id}),!1)||this;return n.logger=new M,n}return n.__extends(t,e),t.prototype.initialize=function(e){this.context.initialized||(this.context.initialized=!0,this.context.log_time_to_view=e.requireTTV,this.context.log_time_to_interactive=e.requireTTI,this.context.tti_flow=e.url,this.timingStopwatch.url=this.context.tti_flow,this.userStopwatch.url=this.context.tti_flow)},t.prototype.start=function(){this.isUsable()&&this.timerState===x.NEW&&(this.context.start_time=p.WebTimingUtil.getNow(),this.timerState=x.RUNNING)},t.prototype.restart=function(){this.TTICallback&&(this.TTICallback.cancel(),this.TTICallback=void 0),this.loggedEvents=0,this.context.have_logged_web_timing=!1,this.context.correlation_id=p.WebTimingUtil.generateCorrelationId(),this.context.start_time=p.WebTimingUtil.getNow(),this.context.end_time=void 0,this.context.time_to_view=null,this.context.time_to_interactive=null,this.timerState=x.RUNNING,d.JSStopwatch.deleteStopwatch(this.timingStopwatch),this.timingStopwatch=d.JSStopwatch.createDetachedStopwatch("maestro_tracing",{request_id:this.context.request_id,url:this.context.tti_flow,correlation_id:this.context.correlation_id}),d.JSStopwatch.deleteStopwatch(this.userStopwatch),this.userStopwatch=d.JSStopwatch.createDetachedStopwatch("user_tracing",{request_id:this.context.request_id,url:this.context.tti_flow,correlation_id:this.context.correlation_id})},t.prototype.abort=function(){this.timerState!==x.CLOSED&&(this.timerState=x.ABORTED)},t.prototype.markTimeToView=function(){this.isUsable()&&(null==this.context.time_to_view&&(this.context.time_to_view=p.WebTimingUtil.getNow()),this.logEvent(l.WebTimerEvent.MARK_TIME_TO_VIEW))},t.prototype.markTimeToInteractive=function(){this.isUsable()&&(this.logEvent(l.WebTimerEvent.MARK_TIME_TO_INTERACTIVE),C()?this.reportTTI():this.TTICallback=this.reportTTIAfterPaint())},t.prototype.reportTTI=function(){null==this.context.time_to_interactive&&(this.context.time_to_interactive=p.WebTimingUtil.getNow(),this.logEvent(l.WebTimerEvent.TIME_TO_INTERACTIVE),X(this.id))},t.prototype.end=function(e){this.isUsable()&&(void 0===this.context.end_time&&(this.context.end_time=p.WebTimingUtil.getNow()),this.context.request_id=e,this.timingStopwatch.request_id=e,this.userStopwatch.request_id=e,this.logEvent(l.WebTimerEvent.LOAD_END))},t.prototype.waitForTTI=function(e){var t=this;return new Promise((function(n,i){if(null==t.context.time_to_interactive){var r,o=function(e){window.removeEventListener("TTI."+t.id,o),clearTimeout(r),n()};window.addEventListener("TTI."+t.id,o),e&&void 0!==e.timeoutMS&&(r=setTimeout(o,e.timeoutMS))}else n()}))},t.prototype.isUsable=function(){return this.timerState===x.NEW||this.timerState===x.RUNNING},t})(B),U=(function(t){function i(e){var n=t.call(this,e,d.JSStopwatch.createDetachedStopwatch("maestro_tracing",{correlation_id:e.correlation_id}),d.JSStopwatch.createDetachedStopwatch("user_tracing",{correlation_id:e.correlation_id}),!1)||this;return n.logger=new L,n}return n.__extends(i,t),i.prototype.initialize=function(e){var t=this;if(!this.context.initialized){if(!b.performance())return;this.context.log_time_to_view=e.requireTTV,this.context.log_time_to_interactive=e.requireTTI,this.context.is_pagelet=!!e.is_pagelet,this.context.is_dws=!!e.is_dws,this.context.is_dws2=!!e.is_dws2,this.context.is_early_ensemble=!!e.is_early_ensemble,this.context.is_page_restore=!1,this.context.ttv_at_dom_interactive=!!e.ttv_at_dom_interactive,this.context.tti_at_dom_interactive=!!e.tti_at_dom_interactive,this.context.source_type=null!=e.source_type?e.source_type:"web",this.context.subtypes=null!=e.subtypes?e.subtypes:{},this.context.tti_exclusion_flow=null!=e.tti_exclusion_flow?e.tti_exclusion_flow:"",this.context.have_logged_web_timing=!1,this.context.delayed_tti_for_css=!1,this.context.initialized=!0,e.url&&(this.context.tti_flow=e.url,this.timingStopwatch.url=e.url,this.userStopwatch.url=e.url),this.context.subtypes.tti_flow&&(this.context.tti_flow=this.context.subtypes.tti_flow);var n=0;v.LOG_TIMING_DELAY&&(n=600),d.JSStopwatch.create_stopwatch_if_not_exist("web_timing_logger"),a.window_load((function(){setTimeout((function(){return t.end()}),n)})),c.onPageRestore((function(e){t.context.is_page_restore=!0;var n=d.JSStopwatch.createDetachedStopwatch("browser_perf",{correlation_id:t.context.correlation_id});n.recordTrace("page_restore"),n.logData()})),!this.context.ttv_at_dom_interactive&&window._timingData&&(null!=window._timingData.ttv&&(this.context.time_to_view=window._timingData.ttv.getTime(),this.logEvent(l.WebTimerEvent.MARK_TIME_TO_VIEW,this.context.time_to_view)),null!=window._timingData.tti&&(this.context.time_to_interactive=window._timingData.tti.getTime(),this.logEvent(l.WebTimerEvent.TIME_TO_INTERACTIVE,this.context.time_to_interactive),X()))}},i.prototype.start=function(){this.isUsable()&&this.timerState===x.NEW&&(this.timerState=x.RUNNING)},i.prototype.restart=function(){this.TTICallback&&(this.TTICallback.cancel(),this.TTICallback=void 0),this.loggedEvents=0,this.context.correlation_id=p.WebTimingUtil.generateCorrelationId(),this.context.end_time=void 0,this.context.time_to_view=null,this.context.time_to_interactive=null,this.timerState=x.RUNNING,this.timingStopwatch=d.JSStopwatch.createDetachedStopwatch("maestro_tracing",{correlation_id:this.context.correlation_id}),this.userStopwatch=d.JSStopwatch.createDetachedStopwatch("user_tracing",{correlation_id:this.context.correlation_id})},i.prototype.abort=function(){this.timerState!==x.CLOSED&&(this.timerState=x.ABORTED)},i.prototype.markTimeToView=function(){this.isUsable()&&(null!=this.context.time_to_view||this.context.ttv_at_dom_interactive||(window._timingData&&null!=window._timingData.ttv?this.context.time_to_view=window._timingData.ttv.getTime():this.context.time_to_view=p.WebTimingUtil.getNow(),this.logEvent(l.WebTimerEvent.MARK_TIME_TO_VIEW,this.context.time_to_view)))},i.prototype.markTimeToInteractive=function(){var e=this;if(window.ensemble&&window.ensemble.waitingForCss)return this.context.delayed_tti_for_css=!0,void(window.ensemble.mark_tti_callback=function(){e.markTimeToInteractive()});null!=this.context.time_to_interactive||this.context.tti_at_dom_interactive||(this.logEvent(l.WebTimerEvent.MARK_TIME_TO_INTERACTIVE),C()?this.reportTTI():this.TTICallback=this.reportTTIAfterPaint())},i.prototype.reportTTI=function(){var t=this;null==this.context.time_to_interactive&&(window._timingData&&null!=window._timingData.tti?this.context.time_to_interactive=window._timingData.tti.getTime():this.context.time_to_interactive=p.WebTimingUtil.getNow(),console.timeStamp&&console.timeStamp("TTI"),window.ensemble&&window.ensemble.snapshotTimingProfile&&(this.context.timing_results=window.ensemble.snapshotTimingProfile()||null),window.RUNNING_IN_EDISON?new Promise((function(t,n){e(["modules/clean/edison/edison"],t,n)})).then(n.__importStar).then((function(e){for(var i=e.Edison.getPrefetchCounts(),r={},o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];r[s]=i[s].toString()}t.context.subtypes=n.__assign(n.__assign({},r),t.context.subtypes),t.logEvent(l.WebTimerEvent.TIME_TO_INTERACTIVE,t.context.time_to_interactive),X()})):(this.logEvent(l.WebTimerEvent.TIME_TO_INTERACTIVE,this.context.time_to_interactive),X()))},i.prototype.end=function(e){this.isUsable()&&void 0===this.context.end_time&&(this.context.end_time=p.WebTimingUtil.getNow(),this.logEvent(l.WebTimerEvent.LOAD_END),this.context.tti_at_dom_interactive&&X())},i.prototype.waitForTTI=function(e){var t=this;return new Promise((function(n,i){if(window.ensemble){if(window.ensemble.ttiMarked)return void n()}else if(null!=t.context.time_to_interactive)return void n();var r,o=function(e){window.removeEventListener("TTI",o),clearTimeout(r),n()};window.addEventListener("TTI",o),e&&void 0!==e.timeoutMS&&(r=setTimeout(o,e.timeoutMS))}))},i.prototype.isUsable=function(){return this.timerState===x.NEW||this.timerState===x.RUNNING},i})(B),q={};function F(e,t){for(var n={},i=0,r=O;i<r.length;i++){(u=t[c=r[i]])&&(n[c]=String(u))}for(var o=e,a=0,s=k;a<s.length;a++){var c,u;(u=o[c=s[a]])&&(n[c]=String(u))}return{correlation_id:e.correlation_id,request_id:t.request_id,annotations:n}}function V(e,t){if(t.annotations)for(var n in t.annotations)if(t.annotations.hasOwnProperty(n)){var i=t.annotations[n];i&&e.addAnnotation(n,String(i))}t.correlation_id&&e.addAnnotation(d.ReservedAnnotationKey.CORRELATION_ID.id,t.correlation_id),t.request_id&&e.addAnnotation(d.ReservedAnnotationKey.REQUEST_ID.id,t.request_id),t.url&&e.addAnnotation(d.ReservedAnnotationKey.URL.id,t.url)}function z(e){return e?(function(e){var t=e;return q[t]||(q[t]=new W(p.WebTimingUtil.newContext(!0,e))),q[t]})(e):(P||H(),P)}function J(e){void 0===e&&(e={}),z().initialize({requireTTV:!!e.log_time_to_view,requireTTI:!!e.log_time_to_interactive,is_pagelet:e.is_pagelet,is_dws:e.is_dws,is_dws2:e.is_dws2,is_early_ensemble:e.is_early_ensemble,ttv_at_dom_interactive:e.ttv_at_dom_interactive,tti_at_dom_interactive:e.tti_at_dom_interactive,source_type:e.source_type,subtypes:e.subtypes,tti_exclusion_flow:e.tti_exclusion_flow,url:e.url})}function H(){P=new U(p.WebTimingUtil.newContext(!1,"default_timer"))}function G(e,t){e.recordEntries(t.map((function(e){return{type:0!==e.startTime?h.TimingDataType.Span:h.TimingDataType.Trace,name:e.name,startTime:e.startTime,endTime:e.endTime,annotations:e.annotations}}))),e.logData()}H(),t.get_timer=z,t.delete_timer=function(e){delete q[e]},t.time_to_view=function(){return z().timeToView()},t.time_to_interactive=function(){return z().timeToInteractive()},t.initialize_module=J,t.initialize=function(e,t){var i,r=t.dwsOpts;switch(t.sourceType){case T.web_timing_logger.WebTimingLoggerServerContext.SourceType.UNKNOWN:i="unknown";break;case T.web_timing_logger.WebTimingLoggerServerContext.SourceType.MOBILE_WEB:i="mobile";break;case T.web_timing_logger.WebTimingLoggerServerContext.SourceType.DESKTOP_WEB:i="web"}var o={is_pagelet:t.isDws,is_dws:t.isDws,is_dws2:null!=r&&r.isDws2,is_early_ensemble:null!=r&&r.isEarlyEnsemble,subtypes:n.__assign(n.__assign({},t.subtypes),{js_preloading:null!=r&&r.jsPreloading?"true":"false"}),source_type:i,url:t.url};J(n.__assign(n.__assign({},o),e))},t.reset=H,t.start_time=function(){return z().startTime()},t.time_since_start=function(){return z().timeSinceStart()},t.set_tti_exclusion_flow=function(e){z().excludeFromTTI(e)};var K=["ensemble_init","dws_ensemble_init","dws_embedded-app_require_config_callback","dws-processChunk-embedded-app-require_config-1"],$=new RegExp("dws-processChunk-embedded-app-const_module.*");function Y(e){var t=b.performance();if(t&&t.getEntriesByName){for(var n=[],i=0,r=s.get_module_times();i<r.length;i++){var o=r[i],a=o.url;if(void 0===a&&o.name&&-1===o.name.indexOf("!"))S.reportStack("Module "+o.name+" with invalid map object fetched by requirejs",{severity:S.SEVERITY.NONCRITICAL,tags:["log_js_module_timing"]});else{var c=[];if(a&&(c=t.getEntriesByName(a,"resource")),0!==c.length)o.start_time=c[0].startTime+c[0].duration;else{if(!("callback_duration"in o))continue;o.start_time=0}n.push(o)}}e.js_module_times=JSON.stringify(n)}}function X(e){if(window.ensemble&&window.ensemble.markTTI)window.ensemble.markTTI();else{var t=document.createEvent("Event");null!=e?t.initEvent("TTI."+e,!0,!0):t.initEvent("TTI",!0,!0),window.dispatchEvent(t)}}t.mark_time_to_view=function(){z().markTimeToView()},t.mark_time_to_interactive=function(e){void 0===e&&(e={});var t=z();t.setExtraColumns(e),t.markTimeToInteractive()},t.waitForTTI=function(e){return z().waitForTTI(e)},t.log_js_modules_application_code_start=function(){z().applicationStart()},t.log_js_modules_fetched_data_required_for_tti=function(){z().fetchedDataRequiredForTTI()}})),define("modules/clean/window_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onPageRestore=t.onBeforeUnload=void 0,t.onBeforeUnload=function(e){window.addEventListener("beforeunload",(function t(){e(),window.removeEventListener("beforeunload",t)}))},t.onPageRestore=function(e){window.addEventListener("pageshow",(function t(n){n.persisted&&(e(),window.removeEventListener("pageshow",t))}))}})),define("modules/clean/js_basic_stopwatch",["require","exports","tslib","modules/core/exception"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStopwatch=t.NoopStopwatchInstance=t.JSBasicStopwatchImpl=t.TimingDataType=void 0;var r,o=!(!window.performance||!window.performance.now),a=0;(function(e){e[e.Span=1]="Span",e[e.AsyncSpan=2]="AsyncSpan",e[e.Trace=3]="Trace"})(r=t.TimingDataType||(t.TimingDataType={}));var s=(function(){function e(e,t,i,r,o){void 0===r&&(r=!1),this.name=e,this.strictAssert=t,this.activeSpans={},this.aggregateSpans={},this._annotations=n.__assign({},o),this.spanStack=[],this.stopwatchTags=i||[],this.detached=r}return e.prototype.reset=function(){this.activeSpans={},this.spanStack=[],this.aggregateSpans={},this._annotations={}},Object.defineProperty(e.prototype,"annotations",{get:function(){return this._annotations},enumerable:!1,configurable:!0}),e.prototype.addAnnotation=function(e,t){this._annotations[e]=t},e.prototype.removeAnnotation=function(e){delete this._annotations[e]},e.prototype.popResolvedSpans=function(){if(this.detached)return{};var e=this.aggregateSpans;return this.aggregateSpans={},e},e.prototype.peekResolvedSpans=function(){return this.detached?{}:this.aggregateSpans},e.newSpanID=function(){var e=String(a);return a++,e},e.resolveTime=function(e){return void 0===e&&(e=window.performance.now()),Math.round(e)},e.prototype._resolveParent=function(e){if(e.type===r.Span){var t=this.spanStack[this.spanStack.length-1];if(t)if(t!==e.name)this._report_sw_misuse("Closing "+t+" while the latest open span is "+e.name+".\n        You are either mixing sync and async spans or closing sync spans out of order.");else{this.spanStack.pop();for(var n="",i=0,o=this.spanStack;i<o.length;i++){n+=o[i]+"#"}e.parent=n}else this._report_sw_misuse(e.name+' isn\'t a synchronous span and has to be started with "async:true".')}else e.parent=""},e.prototype.recordTrace=function(t,i){void 0===i&&(i={});var o=e.resolveTime(i.traceTime),a=e.newSpanID(),s={name:t,span_id:a,start_time:0,end_time:o,annotations:n.__assign({},i.annotations),type:r.Trace,parent:""};return this.recordSpan(this.stopwatchTags,s),a},e.prototype.start=function(t,i){void 0===i&&(i={}),t||this._report_sw_misuse("Reporting a span without a name");var o=e.resolveTime(i.startTime);i.async||this.spanStack.push(t);var a=e.newSpanID(),s={name:t,span_id:a,start_time:o||0,annotations:n.__assign({},i.annotations),type:i.async?r.AsyncSpan:r.Span};return t in this.activeSpans||(this.activeSpans[t]=[]),this.activeSpans[t].push(s),a},e.prototype.end=function(t,n){void 0===n&&(n={});var i=this.findTimerDataIndex(t,n.spanId);if(-1!==i){var r=this.activeSpans[t],o=r[i];r.splice(i,1),this._resolveParent(o);var a=e.resolveTime(n.endTime);if(!(a<o.start_time))return o.end_time=a,this.recordSpan(this.stopwatchTags,o),o.span_id;this._report_sw_misuse("span "+t+" has set an endTime earlier than start_time")}},e.prototype.addSpanAnnotation=function(e,t,n,i){var r=this.findTimerDataIndex(e,i);-1!==r&&(this.activeSpans[e][r].annotations[t]=n)},e.prototype.attach=function(){this.detached=!1},e.prototype.findTimerDataIndex=function(e,t){if(!(e in this.activeSpans)||0===this.activeSpans[e].length)return this._report_sw_misuse("tried to find "+e+" but that span doesn't exist"),-1;var n=-1,i=this.activeSpans[e];if(void 0===t)n=0;else for(var r=0;r<i.length;r++)if(i[r].span_id===t){n=r;break}return-1===n&&this._report_sw_misuse("tried to find "+e+" with id "+t+" but that span doesn't exist"),n},e.prototype._report_sw_misuse=function(e){e="JSBasicStopwatch "+this.name+": "+e,this.strictAssert?i.assert(!1,e):i.reportStack(e,{severity:i.SEVERITY.NONCRITICAL,tags:["log_js_stopwatch"]})},e.prototype.recordSpan=function(e,t){var n=""+t.parent+t.name;n in this.aggregateSpans||(this.aggregateSpans[n]={name:t.name,start_time:t.start_time,total_time:0,num_calls:0,annotations:Object.keys(t.annotations).length>0?t.annotations:void 0,parent:t.parent||"",stopwatch_tags:e.length>0?e:void 0,type:t.type});var i=this.aggregateSpans[n];if(void 0!==t.end_time){if(i.type===r.Trace?(i.total_time=t.end_time-t.start_time,i.num_calls=1):(i.total_time+=t.end_time-t.start_time,i.num_calls+=1),Object.keys(t.annotations).length>0)if(i.annotations)for(var o in t.annotations)t.annotations.hasOwnProperty(o)&&(i.annotations[o]=t.annotations[o]);else i.annotations=t.annotations}else this._report_sw_misuse("Span "+n+" reported with undefined end_time")},e})();t.JSBasicStopwatchImpl=s;var c=(function(){function e(){this.name="",this.annotations={}}return e.prototype.reset=function(){},e.prototype.attach=function(){},e.prototype.addAnnotation=function(e,t){},e.prototype.removeAnnotation=function(e){},e.prototype.popResolvedSpans=function(){return{}},e.prototype.peekResolvedSpans=function(){return{}},e.prototype.start=function(e,t){},e.prototype.end=function(e,t){},e.prototype.recordTrace=function(e,t){},e.prototype.addSpanAnnotation=function(e,t,n,i){},e})();t.NoopStopwatchInstance=new c,t.createStopwatch=function(e,n,i,r,a){return void 0===r&&(r=!1),o?new s(e,n,i,r,a):t.NoopStopwatchInstance}})),define("modules/clean/js_client_stopwatch",["require","exports","tslib","modules/core/xhr","modules/clean/js_basic_stopwatch","modules/constants/request","modules/core/browser","modules/core/exception"],(function(e,t,n,i,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSStopwatch=t.ReservedAnnotationKey=void 0,o=n.__importStar(o),a=n.__importStar(a);var c=(function(){function e(e){this.id=e}return e.REQUEST_ID=new e("dropbox.js_client_stopwatch.request_id"),e.CORRELATION_ID=new e("dropbox.js_client_stopwatch.correlation_id"),e.URL=new e("dropbox.js_client_stopwatch.url"),e})();t.ReservedAnnotationKey=c;var u=(function(){function e(){this.GLOBAL_SW_NAME="GLOBAL_STOPWATCH",this.flush_interval=6e4,this.debugEnabled=!0,this.strictAssert=!1,this.intervalId=null,this.clientStopwatchCounter=1,this.reset()}return e.prototype.reset=function(){this.globalStopwatches={},this.clientStopwatches={},this.clientStopwatchCounter=1,this.sentInitialData=!1,this.create_stopwatch(this.GLOBAL_SW_NAME),this.intervalId&&clearInterval(this.intervalId),this.intervalId=null},e.prototype.reset_individual_stopwatch=function(e){this.stopwatch_exists(e)?this.globalStopwatches[e].reset():this._report_sw_misuse("tried to reset the stopwatch "+e+" but it does not exist")},e.prototype.stopwatch_exists=function(e){return e in this.globalStopwatches},e.prototype.create_stopwatch=function(e,t){this.stopwatch_exists(e)?this._report_sw_misuse("tried to create a new stopwatch "+e+" but it already exists"):this.globalStopwatches[e]=r.createStopwatch(e,this.strictAssert,t)},e.prototype.createDetachedStopwatch=function(e,t){void 0===t&&(t={});var n=r.createStopwatch(e,this.strictAssert,t.tags,!0,t.annotations),i=new l(this.clientStopwatchCounter++,e,n,t.request_id,t.correlation_id,t.url);return this.clientStopwatches[i.id]=i,i},e.prototype.deleteStopwatch=function(e){delete this.clientStopwatches[e.id]},e.prototype.create_stopwatch_if_not_exist=function(e,t){this.stopwatch_exists(e)||this.create_stopwatch(e,t)},e.prototype.getStopwatch=function(e){return this.stopwatch_exists(e)?this.globalStopwatches[e]:(this._report_sw_misuse(e+" doesn't exist"),null)},e.prototype.recordTrace=function(e,t){void 0===t&&(t={});var n=this.getStopwatch(t.stopwatchName||this.GLOBAL_SW_NAME);if(null!=n){var i={traceTime:t.traceTime};return n.recordTrace(e,i)}},e.prototype.startSpan=function(e,t){void 0===t&&(t={});var n=this.getStopwatch(t.stopwatchName||this.GLOBAL_SW_NAME);if(null!=n){var i={startTime:t.startTime,async:t.async};return n.start(e,i)}},e.prototype.endSpan=function(e,t){void 0===t&&(t={});var n=this.getStopwatch(t.stopwatchName||this.GLOBAL_SW_NAME);if(null!=n)return n.end(e,{spanId:t.spanId,endTime:t.endTime})},e.prototype.addSpanAnnotation=function(e,t,n,i){void 0===i&&(i={});var r=this.getStopwatch(i.stopwatchName||this.GLOBAL_SW_NAME);null!=r&&r.addSpanAnnotation(e,t,n,i.spanId)},e.prototype.log_stored_results=function(){this.sentInitialData?this._report_sw_misuse("ClientStopwatch tried to log stored results, but the stopwatch is set to log immediately"):(this.flush_current_data(),this.sentInitialData=!0,this.intervalId=setInterval(this.flush_current_data.bind(this),this.flush_interval))},e.prototype._report_sw_misuse=function(e){e="ClientStopwatch: "+e,this.strictAssert?s.assert(!1,e):s.reportStack(e,{severity:s.SEVERITY.NONCRITICAL,tags:["log_js_stopwatch"]})},e.prototype.flush_current_data=function(){for(var t in this.globalStopwatches)this.globalStopwatches.hasOwnProperty(t)&&e.logStopwatchData(this.globalStopwatches[t]);for(var t in this.clientStopwatches)this.clientStopwatches.hasOwnProperty(t)&&e.logStopwatchData(this.clientStopwatches[t].stopwatch)},e.logStopwatchData=function(t){var n=t.popResolvedSpans(),i=t.name,r={};if(Object.keys(n).length>e.MAXSPANS){var o=0;for(var a in r[i]={},n)n.hasOwnProperty(a)&&(r[i][a]=n[a],o===e.MAXSPANS&&(r[i].annotations=t.annotations,e.send_spans(r),o=0,r[i]={}),o++)}else r[i]=n;0!==Object.keys(r[i]).length&&(r[i].annotations=t.annotations,e.send_spans(r))},e.send_spans=function(e){var t=JSON.stringify(e),n={request_id:o.REQUEST_ID,url:a.get_href().replace("/dws2",""),aggregated_sw_data:t};i.sendXhr("/log_js_sw_data",n)},e.prototype.print_stopwatches_debug=function(){var e=this.get_debug_data();console.table&&console.groupCollapsed&&console.groupEnd&&e&&e.length>0&&(console.groupCollapsed("Request timeline"),console.table(e),console.groupEnd())},e.prototype.get_debug_data=function(){var e=[];for(var t in this.globalStopwatches)if(this.globalStopwatches.hasOwnProperty(t)){var n=this.globalStopwatches[t].peekResolvedSpans();for(var i in n)if(n.hasOwnProperty(i)){var o=n[i],a={stopwatchName:t,spanName:o.name,time:o.start_time+o.total_time};o.type!==r.TimingDataType.AsyncSpan&&o.type!==r.TimingDataType.Span||(a.startTime=o.start_time),o.type===r.TimingDataType.Span&&(a.info="Total time: "+o.total_time+"ms"),e.push(a)}}return e.sort((function(e,t){return e.time-t.time})),e},e.MAXSPANS=2e3,e})();t.JSStopwatch=new u;var l=(function(){function e(e,t,n,i,r,o){this.sentInitialData=!1,this.strictAssert=!1,this.id=e,this.stopwatch=n,this._request_id=i,this._correlation_id=r,this._url=o,this._request_id&&this.stopwatch.addAnnotation(c.REQUEST_ID.id,this._request_id),this._correlation_id&&this.stopwatch.addAnnotation(c.CORRELATION_ID.id,this._correlation_id),this._url&&this.stopwatch.addAnnotation(c.URL.id,this._url)}return Object.defineProperty(e.prototype,"request_id",{set:function(e){this._request_id=e,this._request_id?this.stopwatch.addAnnotation(c.REQUEST_ID.id,this._request_id):this.stopwatch.removeAnnotation(c.REQUEST_ID.id)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"correlation_id",{set:function(e){this._correlation_id=e,this._correlation_id?this.stopwatch.addAnnotation(c.CORRELATION_ID.id,this._correlation_id):this.stopwatch.removeAnnotation(c.CORRELATION_ID.id)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{set:function(e){this._url=e,this._url?this.stopwatch.addAnnotation(c.URL.id,this._url):this.stopwatch.removeAnnotation(c.URL.id)},enumerable:!1,configurable:!0}),e.prototype.startSpan=function(e,t){return this.stopwatch.start(e,t)},e.prototype.endSpan=function(e,t){return this.stopwatch.end(e,t)},e.prototype.addSpanAnnotation=function(e,t,n,i){this.stopwatch.addSpanAnnotation(e,t,n,i)},e.prototype.recordTrace=function(e,t,n){this.stopwatch.recordTrace(e,{traceTime:t,annotations:n})},e.prototype.recordEntries=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];if(i.type===r.TimingDataType.Trace)this.recordTrace(i.name,i.endTime,i.annotations);else{var o=i.startTime||0,a=this.startSpan(i.name,{startTime:Math.min(o,i.endTime),async:i.type===r.TimingDataType.AsyncSpan,annotations:i.annotations});i.endTime<o&&this.addSpanAnnotation(i.name,"negativeSpanLength",(i.endTime-o).toString(),a),this.endSpan(i.name,{spanId:a,endTime:Math.max(o,i.endTime)})}}},e.prototype.logData=function(){this.sentInitialData?this.reportMisuse("ClientStopwatch tried to log stored results, but the stopwatch is set to log immediately"):(this.stopwatch.attach(),this.sentInitialData=!0,setTimeout((function(){t.JSStopwatch.flush_current_data()}),0))},e.prototype.addAnnotation=function(e,t){this.stopwatch.addAnnotation(e,t)},e.prototype.removeAnnotation=function(e){this.stopwatch.removeAnnotation(e)},e.prototype.reportMisuse=function(e){e="ClientStopwatch: "+e,this.strictAssert?s.assert(!1,e):s.reportStack(e,{severity:s.SEVERITY.NONCRITICAL,tags:["log_js_stopwatch"]})},e})()})),define("apex-metrics/index",["require","exports","tslib","apex-metrics/clock","apex-metrics/executor","apex-metrics/internal","apex-metrics/metrics","apex-metrics/metrics_reporter","apex-metrics/no_op","apex-metrics/types","apex-metrics/validate"],(function(e,t,n,i,r,o,a,s,c,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(i,t),n.__exportStar(r,t),n.__exportStar(o,t),n.__exportStar(a,t),n.__exportStar(s,t),n.__exportStar(c,t),n.__exportStar(u,t),n.__exportStar(l,t)})),define("apex-metrics/clock",["require","exports","apex-metrics/types"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserPerformanceClock=void 0;var i=(function(){function e(){}return e.prototype.now=function(){return{value:performance.now(),unit:n.TimeUnit.MILLISECONDS}},e})();t.BrowserPerformanceClock=i})),define("apex-metrics/executor",["require","exports","apex-metrics/types"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetTimeoutExecutor=void 0;var i=(function(){function e(e){this.jitterStrategy=e}return e.prototype.executeEvery=function(e,t){var i=this,r=n.Instant.toMilliseconds(e),o=n.Instant.toMilliseconds(this.jitterStrategy());setTimeout((function(){t()&&i.executeEvery(e,t)}),r+o)},e})();t.SetTimeoutExecutor=i})),define("apex-metrics/internal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("apex-metrics/metrics",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("apex-metrics/metrics_reporter",["require","exports","apex-metrics/types","apex-metrics/validate"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsReporterImpl=void 0;var r=(function(){function e(e,t,n){void 0===n&&(n={}),this.sink=e,this.clock=t,this.tags=n}return e.root=function(t,n){return new e(t,n)},e.prototype.child=function(t){return new e(this.sink,this.clock,Object.assign(Object.assign({},this.tags),i.validateTags(t)))},e.prototype.createStats=function(e,t){return void 0===t&&(t={}),new o(i.validateMetric(e),Object.assign(Object.assign({},this.tags),i.validateTags(t)),this.sink)},e.prototype.createCounter=function(e,t){return void 0===t&&(t={}),new a(i.validateMetric(e),Object.assign(Object.assign({},this.tags),i.validateTags(t)),this.sink)},e.prototype.createTimer=function(e,t){return void 0===t&&(t={}),new s(i.validateMetric(e),Object.assign(Object.assign({},this.tags),i.validateTags(t)),this.sink,this.clock)},e})();t.MetricsReporterImpl=r;var o=(function(){function e(e,t,n){this.metric=e,this.tags=t,this.sink=n}return e.prototype.record=function(e){c(e,this.metric,this.tags,this.sink)},e.prototype.recordDuration=function(e,t){c(n.Instant.toMilliseconds({value:e,unit:t}),this.metric,this.tags,this.sink)},e})(),a=(function(){function e(e,t,n,i){void 0===i&&(i=0),this.metric=e,this.tags=t,this.sink=n,this.value=i}return e.prototype.decrement=function(e){void 0===e&&(e=1),this.value-=e},e.prototype.increment=function(e){void 0===e&&(e=1),this.value+=e},e.prototype.reset=function(e){void 0===e&&(e=0),this.value=e},e.prototype.record=function(){c(this.value,this.metric,this.tags,this.sink),this.reset()},e})(),s=(function(){function e(e,t,i,r,o){void 0===o&&(o=0),this.metric=e,this.tags=t,this.sink=i,this.clock=r,this.value=o,this.value=n.Instant.toMilliseconds(this.clock.now())}return e.prototype.record=function(){c(n.Instant.toMilliseconds(this.clock.now())-this.value,this.metric,this.tags,this.sink),this.reset()},e.prototype.reset=function(){this.value=n.Instant.toMilliseconds(this.clock.now())},e})();function c(e,t,n,i){i.recordSpan({namespace:t.ns,metricName:t.name,tags:n,samples:[e]})}})),define("apex-metrics/no_op",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoOpExecutor=t.NoOpSink=void 0;var n=(function(){function e(){}return e.prototype.recordSpan=function(){},e})();t.NoOpSink=n;var i=(function(){function e(){}return e.prototype.executeEvery=function(){},e})();t.NoOpExecutor=i})),define("apex-metrics/types",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Instant=t.TimeUnit=void 0,(n=t.TimeUnit||(t.TimeUnit={}))[n.NANOSECONDS=0]="NANOSECONDS",n[n.MILLISECONDS=1]="MILLISECONDS",n[n.SECONDS=2]="SECONDS",n[n.MINUTES=3]="MINUTES",n[n.HOURS=4]="HOURS",n[n.DAYS=5]="DAYS";var i=(function(){function e(){}return e.toMilliseconds=function(e){switch(e.unit){case t.TimeUnit.NANOSECONDS:return e.value/1e6;case t.TimeUnit.MILLISECONDS:return e.value;case t.TimeUnit.SECONDS:return 1e3*e.value;case t.TimeUnit.MINUTES:return 6e4*e.value;case t.TimeUnit.HOURS:return 36e5*e.value;case t.TimeUnit.DAYS:return 24*e.value*36e5}},e})();t.Instant=i})),define("apex-metrics/validate",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateMetricName=t.validateNamespace=t.validateTags=t.validateMetric=void 0;var n=new RegExp("^[^0-9a-zA-Z]+"),i=new RegExp("[^0-9a-zA-Z._-]","g"),r=i,o=new RegExp("[^0-9a-zA-Z/._-]","g"),a=i;function s(e){return u(e,"namespace",256,n,r)}function c(e){return u(e,"metric name",256,n,o)}function u(e,t,n,i,r){var o=[];if("string"!=typeof e&&o.push("identifier is not a string"),i&&i.test(e)&&o.push("invalid prefix"),r&&r.test(e)&&o.push("invalid characters"),e.length>n&&o.push("exceeds "+n+" characters"),0===e.length&&o.push("is empty"),0!==o.length)throw new Error(t+" identifier '"+e+"' is invalid: "+o);return e}t.validateMetric=function(e){return{ns:s(e.ns),name:c(e.name)}},t.validateTags=function(e){var t={};for(var i in e){if(e.hasOwnProperty(i))t[u(i,"tag name",256,n,a)]=u(e[i],"tag value",256)}return t},t.validateNamespace=s,t.validateMetricName=c})),define("google/protobuf/any",["require","exports","tslib","protobufjs/minimal"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.google=void 0;var r,o,a=(i=n.__importStar(i)).Reader,s=i.Writer,c=i.util,u=i.roots.default||(i.roots.default={});t.default=u,t.google=u.google=((r=u.google||{}).protobuf=((o=r.protobuf||{}).Any=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.typeUrl="",e.prototype.value=c.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.typeUrl&&Object.hasOwnProperty.call(e,"typeUrl")&&t.uint32(10).string(e.typeUrl),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new u.google.protobuf.Any;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.typeUrl=e.string();break;case 2:i.value=e.bytes();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.Any"},e})(o.Any||{}),o),r)})),define("google/protobuf/empty",["require","exports","tslib","protobufjs/minimal"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.google=void 0;var r,o,a=(i=n.__importStar(i)).Reader,s=i.Writer,c=(i.util,i.roots.default||(i.roots.default={}));t.default=c,t.google=c.google=((r=c.google||{}).protobuf=((o=r.protobuf||{}).Empty=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.google.protobuf.Empty;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.Empty"},e})(o.Empty||{}),o),r)})),define("google/protobuf/timestamp",["require","exports","tslib","protobufjs/minimal"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.google=void 0;var r,o,a=(i=n.__importStar(i)).Reader,s=i.Writer,c=(i.util,i.roots.default||(i.roots.default={}));t.default=c,t.google=c.google=((r=c.google||{}).protobuf=((o=r.protobuf||{}).Timestamp=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seconds=0,e.prototype.nanos=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.seconds&&Object.hasOwnProperty.call(e,"seconds")&&t.uint32(8).int64(e.seconds),null!=e.nanos&&Object.hasOwnProperty.call(e,"nanos")&&t.uint32(16).int32(e.nanos),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.google.protobuf.Timestamp;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.seconds=e.int64();break;case 2:i.nanos=e.int32();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.Timestamp"},e})(o.Timestamp||{}),o),r)})),define("proto_utils/unpack",["require","exports","google/protobuf/any"],(function(e,t,n){"use strict";function i(e){return e.constructor.encode(e).finish()}Object.defineProperty(t,"__esModule",{value:!0}),t.unpackProto=t.packProto=t.wrapInProtoAny=void 0,t.wrapInProtoAny=function(e,t){var r={value:i(e)};return null!=t&&(r.typeUrl=t),n.google.protobuf.Any.create(r)},t.packProto=function(e){for(var t=i(e),n="",r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return btoa(n)},t.unpackProto=function(e,t){for(var i=atob(e),r=i.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=i.charCodeAt(a);var s,c=function(e){try{return t.decode(e)}catch(e){throw new Error("Invalid data while trying to unpack encoded proto: "+e)}};try{s=n.google.protobuf.Any.decode(o)}catch(e){}return s&&s.typeUrl&&s.typeUrl.startsWith("type.googleapis.com/")&&s.value?c(s.value):c(o)}})),define("dropbox/proto/js_init_data/web_timing_logger/web_timing_logger",["require","exports","tslib","protobufjs/minimal"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.web_timing_logger=void 0;var r,o=(i=n.__importStar(i)).Reader,a=i.Writer,s=i.util,c=i.roots.default||(i.roots.default={});t.default=c,t.web_timing_logger=c.web_timing_logger=((r=c.web_timing_logger||{}).WebTimingLoggerServerContext=(function(e){function e(e){if(this.subtypes={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t,n;return e.prototype.isDws=!1,e.prototype.dwsOpts=null,e.prototype.sourceType=0,e.prototype.subtypes=s.emptyObject,e.prototype.url="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.isDws&&Object.hasOwnProperty.call(e,"isDws")&&t.uint32(8).bool(e.isDws),null!=e.dwsOpts&&Object.hasOwnProperty.call(e,"dwsOpts")&&c.web_timing_logger.WebTimingLoggerServerContext.DWSOptions.encode(e.dwsOpts,t.uint32(18).fork()).ldelim(),null!=e.sourceType&&Object.hasOwnProperty.call(e,"sourceType")&&t.uint32(24).int32(e.sourceType),null!=e.subtypes&&Object.hasOwnProperty.call(e,"subtypes"))for(var n=Object.keys(e.subtypes),i=0;i<n.length;++i)t.uint32(34).fork().uint32(10).string(n[i]).uint32(18).string(e.subtypes[n[i]]).ldelim();return null!=e.url&&Object.hasOwnProperty.call(e,"url")&&t.uint32(42).string(e.url),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n,i,r=void 0===t?e.len:e.pos+t,a=new c.web_timing_logger.WebTimingLoggerServerContext;e.pos<r;){var u=e.uint32();switch(u>>>3){case 1:a.isDws=e.bool();break;case 2:a.dwsOpts=c.web_timing_logger.WebTimingLoggerServerContext.DWSOptions.decode(e,e.uint32());break;case 3:a.sourceType=e.int32();break;case 4:a.subtypes===s.emptyObject&&(a.subtypes={});var l=e.uint32()+e.pos;for(n="",i="";e.pos<l;){var p=e.uint32();switch(p>>>3){case 1:n=e.string();break;case 2:i=e.string();break;default:e.skipType(7&p)}}a.subtypes[n]=i;break;case 5:a.url=e.string();break;default:e.skipType(7&u)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/web_timing_logger.WebTimingLoggerServerContext"},e.DWSOptions=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.isDws2=!1,e.prototype.isEarlyEnsemble=!1,e.prototype.jsPreloading=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.isDws2&&Object.hasOwnProperty.call(e,"isDws2")&&t.uint32(8).bool(e.isDws2),null!=e.isEarlyEnsemble&&Object.hasOwnProperty.call(e,"isEarlyEnsemble")&&t.uint32(16).bool(e.isEarlyEnsemble),null!=e.jsPreloading&&Object.hasOwnProperty.call(e,"jsPreloading")&&t.uint32(24).bool(e.jsPreloading),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.web_timing_logger.WebTimingLoggerServerContext.DWSOptions;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.isDws2=e.bool();break;case 2:i.isEarlyEnsemble=e.bool();break;case 3:i.jsPreloading=e.bool();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/web_timing_logger.WebTimingLoggerServerContext.DWSOptions"},e})(e.DWSOptions||{}),e.SourceType=(t={},(n=Object.create(t))[t[0]="UNKNOWN"]=0,n[t[1]="DESKTOP_WEB"]=1,n[t[2]="MOBILE_WEB"]=2,n),e})(r.WebTimingLoggerServerContext||{}),r)})),define("dropbox/proto/apex_metrics_web/apex_metrics_web",["require","exports","tslib","protobufjs/minimal","google/protobuf/empty","google/protobuf/timestamp"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.apex_metrics_web=void 0;var r,o=(i=n.__importStar(i)).Reader,a=i.Writer,s=i.util,c=i.roots.default||(i.roots.default={});t.default=c,t.apex_metrics_web=c.apex_metrics_web=((r=c.apex_metrics_web||{}).RecordNamespace=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.RecordNamespace;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.RecordNamespace"},e.MetricReportingConfigV2=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.metricNamespace="",e.prototype.maxTimeUntilRefreshSeconds=0,e.prototype.stopPublicationForSeconds=0,e.prototype.dropSamples=null,e.prototype.dropPeriods=null,e.prototype.dropFractionOfHostsPerMetric=0,e.prototype.aggregationIntervalSeconds=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.metricNamespace&&Object.hasOwnProperty.call(e,"metricNamespace")&&t.uint32(10).string(e.metricNamespace),null!=e.maxTimeUntilRefreshSeconds&&Object.hasOwnProperty.call(e,"maxTimeUntilRefreshSeconds")&&t.uint32(16).uint32(e.maxTimeUntilRefreshSeconds),null!=e.stopPublicationForSeconds&&Object.hasOwnProperty.call(e,"stopPublicationForSeconds")&&t.uint32(24).uint32(e.stopPublicationForSeconds),null!=e.dropSamples&&Object.hasOwnProperty.call(e,"dropSamples")&&c.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2.encode(e.dropSamples,t.uint32(34).fork()).ldelim(),null!=e.dropPeriods&&Object.hasOwnProperty.call(e,"dropPeriods")&&c.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2.encode(e.dropPeriods,t.uint32(42).fork()).ldelim(),null!=e.dropFractionOfHostsPerMetric&&Object.hasOwnProperty.call(e,"dropFractionOfHostsPerMetric")&&t.uint32(49).double(e.dropFractionOfHostsPerMetric),null!=e.aggregationIntervalSeconds&&Object.hasOwnProperty.call(e,"aggregationIntervalSeconds")&&t.uint32(56).uint32(e.aggregationIntervalSeconds),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.RecordNamespace.MetricReportingConfigV2;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.metricNamespace=e.string();break;case 2:i.maxTimeUntilRefreshSeconds=e.uint32();break;case 3:i.stopPublicationForSeconds=e.uint32();break;case 4:i.dropSamples=c.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2.decode(e,e.uint32());break;case 5:i.dropPeriods=c.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2.decode(e,e.uint32());break;case 6:i.dropFractionOfHostsPerMetric=e.double();break;case 7:i.aggregationIntervalSeconds=e.uint32();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.RecordNamespace.MetricReportingConfigV2"},e})(e.MetricReportingConfigV2||{}),e.StickyBiasedCoinV2=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.fraction=0,e.prototype.stickiness=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.fraction&&Object.hasOwnProperty.call(e,"fraction")&&t.uint32(9).double(e.fraction),null!=e.stickiness&&Object.hasOwnProperty.call(e,"stickiness")&&c.apex_metrics_web.RecordNamespace.StickinessV2.encode(e.stickiness,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.RecordNamespace.StickyBiasedCoinV2;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.fraction=e.double();break;case 2:i.stickiness=c.apex_metrics_web.RecordNamespace.StickinessV2.decode(e,e.uint32());break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.RecordNamespace.StickyBiasedCoinV2"},e})(e.StickyBiasedCoinV2||{}),e.StickinessV2=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.independent=null,e.prototype.permanent=null,e.prototype.nResults=0,e.prototype.nSeconds=0,Object.defineProperty(e.prototype,"limit",{get:s.oneOfGetter(t=["independent","permanent","nResults","nSeconds"]),set:s.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.independent&&Object.hasOwnProperty.call(e,"independent")&&c.google.protobuf.Empty.encode(e.independent,t.uint32(10).fork()).ldelim(),null!=e.permanent&&Object.hasOwnProperty.call(e,"permanent")&&c.google.protobuf.Empty.encode(e.permanent,t.uint32(18).fork()).ldelim(),null!=e.nResults&&Object.hasOwnProperty.call(e,"nResults")&&t.uint32(24).uint32(e.nResults),null!=e.nSeconds&&Object.hasOwnProperty.call(e,"nSeconds")&&t.uint32(37).float(e.nSeconds),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.RecordNamespace.StickinessV2;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.independent=c.google.protobuf.Empty.decode(e,e.uint32());break;case 2:i.permanent=c.google.protobuf.Empty.decode(e,e.uint32());break;case 3:i.nResults=e.uint32();break;case 4:i.nSeconds=e.float();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.RecordNamespace.StickinessV2"},e})(e.StickinessV2||{}),e.RecordResponse=(function(e){function e(e){if(this.reportingConfigs=[],this.debugInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.reportingConfigs=s.emptyArray,e.prototype.publicationIntervalSeconds=0,e.prototype.maxScopesPerRequest=0,e.prototype.stopPublicationForSeconds=0,e.prototype.debugInfos=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.reportingConfigs&&e.reportingConfigs.length)for(var n=0;n<e.reportingConfigs.length;++n)c.apex_metrics_web.RecordNamespace.MetricReportingConfigV2.encode(e.reportingConfigs[n],t.uint32(10).fork()).ldelim();if(null!=e.publicationIntervalSeconds&&Object.hasOwnProperty.call(e,"publicationIntervalSeconds")&&t.uint32(24).uint32(e.publicationIntervalSeconds),null!=e.maxScopesPerRequest&&Object.hasOwnProperty.call(e,"maxScopesPerRequest")&&t.uint32(32).uint32(e.maxScopesPerRequest),null!=e.stopPublicationForSeconds&&Object.hasOwnProperty.call(e,"stopPublicationForSeconds")&&t.uint32(40).uint32(e.stopPublicationForSeconds),null!=e.debugInfos&&e.debugInfos.length)for(n=0;n<e.debugInfos.length;++n)t.uint32(50).string(e.debugInfos[n]);return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.RecordNamespace.RecordResponse;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.reportingConfigs&&i.reportingConfigs.length||(i.reportingConfigs=[]),i.reportingConfigs.push(c.apex_metrics_web.RecordNamespace.MetricReportingConfigV2.decode(e,e.uint32()));break;case 3:i.publicationIntervalSeconds=e.uint32();break;case 4:i.maxScopesPerRequest=e.uint32();break;case 5:i.stopPublicationForSeconds=e.uint32();break;case 6:i.debugInfos&&i.debugInfos.length||(i.debugInfos=[]),i.debugInfos.push(e.string());break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.RecordNamespace.RecordResponse"},e})(e.RecordResponse||{}),e})(r.RecordNamespace||{}),r.ApexMetricsCacheData=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.config=null,e.prototype.timeStored=null,e.prototype.state=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.config&&Object.hasOwnProperty.call(e,"config")&&c.apex_metrics_web.RecordNamespace.RecordResponse.encode(e.config,t.uint32(10).fork()).ldelim(),null!=e.timeStored&&Object.hasOwnProperty.call(e,"timeStored")&&c.google.protobuf.Timestamp.encode(e.timeStored,t.uint32(18).fork()).ldelim(),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&c.apex_metrics_web.ApexMetricsCacheData.FilterState.encode(e.state,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.ApexMetricsCacheData;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.config=c.apex_metrics_web.RecordNamespace.RecordResponse.decode(e,e.uint32());break;case 2:i.timeStored=c.google.protobuf.Timestamp.decode(e,e.uint32());break;case 3:i.state=c.apex_metrics_web.ApexMetricsCacheData.FilterState.decode(e,e.uint32());break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.ApexMetricsCacheData"},e.CoinState=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.lastFlipTime=null,e.prototype.lastResult=!1,e.prototype.numTimesChecked=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.lastFlipTime&&Object.hasOwnProperty.call(e,"lastFlipTime")&&c.google.protobuf.Timestamp.encode(e.lastFlipTime,t.uint32(10).fork()).ldelim(),null!=e.lastResult&&Object.hasOwnProperty.call(e,"lastResult")&&t.uint32(16).bool(e.lastResult),null!=e.numTimesChecked&&Object.hasOwnProperty.call(e,"numTimesChecked")&&t.uint32(24).uint32(e.numTimesChecked),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.ApexMetricsCacheData.CoinState;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.lastFlipTime=c.google.protobuf.Timestamp.decode(e,e.uint32());break;case 2:i.lastResult=e.bool();break;case 3:i.numTimesChecked=e.uint32();break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.ApexMetricsCacheData.CoinState"},e})(e.CoinState||{}),e.NamespaceCoinState=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dropPeriodCoin=null,e.prototype.dropSamplesCoin=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.dropPeriodCoin&&Object.hasOwnProperty.call(e,"dropPeriodCoin")&&c.apex_metrics_web.ApexMetricsCacheData.CoinState.encode(e.dropPeriodCoin,t.uint32(10).fork()).ldelim(),null!=e.dropSamplesCoin&&Object.hasOwnProperty.call(e,"dropSamplesCoin")&&c.apex_metrics_web.ApexMetricsCacheData.CoinState.encode(e.dropSamplesCoin,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new c.apex_metrics_web.ApexMetricsCacheData.NamespaceCoinState;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.dropPeriodCoin=c.apex_metrics_web.ApexMetricsCacheData.CoinState.decode(e,e.uint32());break;case 2:i.dropSamplesCoin=c.apex_metrics_web.ApexMetricsCacheData.CoinState.decode(e,e.uint32());break;default:e.skipType(7&r)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.ApexMetricsCacheData.NamespaceCoinState"},e})(e.NamespaceCoinState||{}),e.FilterState=(function(e){function e(e){if(this.namespaceCoinState={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.filterID=0,e.prototype.namespaceCoinState=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.filterID&&Object.hasOwnProperty.call(e,"filterID")&&t.uint32(8).uint32(e.filterID),null!=e.namespaceCoinState&&Object.hasOwnProperty.call(e,"namespaceCoinState"))for(var n=Object.keys(e.namespaceCoinState),i=0;i<n.length;++i)t.uint32(18).fork().uint32(10).string(n[i]),c.apex_metrics_web.ApexMetricsCacheData.NamespaceCoinState.encode(e.namespaceCoinState[n[i]],t.uint32(18).fork()).ldelim().ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n,i,r=void 0===t?e.len:e.pos+t,a=new c.apex_metrics_web.ApexMetricsCacheData.FilterState;e.pos<r;){var u=e.uint32();switch(u>>>3){case 1:a.filterID=e.uint32();break;case 2:a.namespaceCoinState===s.emptyObject&&(a.namespaceCoinState={});var l=e.uint32()+e.pos;for(n="",i=null;e.pos<l;){var p=e.uint32();switch(p>>>3){case 1:n=e.string();break;case 2:i=c.apex_metrics_web.ApexMetricsCacheData.NamespaceCoinState.decode(e,e.uint32());break;default:e.skipType(7&p)}}a.namespaceCoinState[n]=i;break;default:e.skipType(7&u)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/apex_metrics_web.ApexMetricsCacheData.FilterState"},e})(e.FilterState||{}),e})(r.ApexMetricsCacheData||{}),r)})),define("prod_assets_web_modules/protobufjs/minimal",["../common/_commonjsHelpers"],(function(_commonjsHelpers){"use strict";var aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),i=0,r=2,o=!0;r<arguments.length;)n[i++]=arguments[r++];return new Promise((function(r,a){n[i]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];r.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}var base64_1=_commonjsHelpers.createCommonjsModule((function(e,t){var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),r=new Array(123),o=0;o<64;)r[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,n){for(var r,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=i[u>>2],r=(3&u)<<4,c=1;break;case 1:a[s++]=i[r|u>>4],r=(15&u)<<2,c=2;break;case 2:a[s++]=i[r|u>>6],a[s++]=i[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=i[r],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},n.decode=function(e,t,n){for(var i,o=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if(void 0===(c=r[c]))throw Error("invalid encoding");switch(a){case 0:i=c,a=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[n++]=(3&i)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?(function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3]}function o(e,i,r){t[0]=e,i[r]=n[3],i[r+1]=n[2],i[r+2]=n[1],i[r+3]=n[0]}function a(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function s(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?r:o,e.writeFloatBE=i?o:r,e.readFloatLE=i?a:s,e.readFloatBE=i?s:a})():(function(){function t(e,t,n,i){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var o=Math.floor(Math.log(t)/Math.LN2);e((r<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),r=2*(i>>31)+1,o=i>>>23&255,a=8388607&i;return 255===o?a?NaN:r*(1/0):0===o?1401298464324817e-60*r*a:r*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)})(),"undefined"!=typeof Float64Array?(function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3],i[r+4]=n[4],i[r+5]=n[5],i[r+6]=n[6],i[r+7]=n[7]}function o(e,i,r){t[0]=e,i[r]=n[7],i[r+1]=n[6],i[r+2]=n[5],i[r+3]=n[4],i[r+4]=n[3],i[r+5]=n[2],i[r+6]=n[1],i[r+7]=n[0]}function a(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function s(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?r:o,e.writeDoubleBE=i?o:r,e.readDoubleLE=i?a:s,e.readDoubleBE=i?s:a})():(function(){function t(e,t,n,i,r,o){var a=i<0?1:0;if(a&&(i=-i),0===i)e(0,r,o+t),e(1/i>0?0:2147483648,r,o+n);else if(isNaN(i))e(0,r,o+t),e(2146959360,r,o+n);else if(i>17976931348623157e292)e(0,r,o+t),e((a<<31|2146435072)>>>0,r,o+n);else{var s;if(i<22250738585072014e-324)e((s=i/5e-324)>>>0,r,o+t),e((a<<31|s/4294967296)>>>0,r,o+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=i*Math.pow(2,-c))>>>0,r,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,r,o+n)}}}function n(e,t,n,i,r){var o=e(i,r+t),a=e(i,r+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)})(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=_commonjsHelpers.createCommonjsModule((function(e,t){var n=t;n.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var i,r=null,o=[],a=0;t<n;)(i=e[t++])<128?o[a++]=i:i>191&&i<224?o[a++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(i>>10),o[a++]=56320+(1023&i)):o[a++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,o)),a=0);return r?(a&&r.push(String.fromCharCode.apply(String,o.slice(0,a))),r.join("")):String.fromCharCode.apply(String,o.slice(0,a))},n.write=function(e,t,n){for(var i,r,o=n,a=0;a<e.length;++a)(i=e.charCodeAt(a))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(r=e.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&r),++a,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-o}})),pool_1=pool;function pool(e,t,n){var i=n||8192,r=i>>>1,o=null,a=i;return function(n){if(n<1||n>r)return e(n);a+n>i&&(o=e(i),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var minimal=_commonjsHelpers.createCommonjsModule((function(e,t){var n=t;function i(e,t){this.lo=e>>>0,this.hi=t>>>0}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1;var r=i.zero=new i(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var n=e>>>0,o=(e-n)/4294967296>>>0;return t&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new i(n,o)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):r},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;function s(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;++r)void 0!==e[i[r]]&&n||(e[i[r]]=t[i[r]]);return e}function c(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&s(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.fromHash=function(e){return e===o?r:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10},n.LongBits=i,n.isNode=Boolean(void 0!==_commonjsHelpers.commonjsGlobal&&_commonjsHelpers.commonjsGlobal&&_commonjsHelpers.commonjsGlobal.process&&_commonjsHelpers.commonjsGlobal.process.versions&&_commonjsHelpers.commonjsGlobal.process.versions.node),n.global=n.isNode&&_commonjsHelpers.commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||_commonjsHelpers.commonjsGlobal,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},n.Buffer=(function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}})(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=c,n.ProtocolError=c("ProtocolError"),n.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},n.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create=function(){return minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer.create=create(),Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var n=Writer.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e,Writer.create=create(),BufferWriter._configure()};var writer_buffer=BufferWriter$1;function BufferWriter$1(){writer.call(this)}function writeStringBuffer(e,t,n){e.length<40?minimal.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1,BufferWriter$1._configure=function(){BufferWriter$1.alloc=minimal._Buffer_allocUnsafe,BufferWriter$1.writeBytesBuffer=minimal.Buffer&&minimal.Buffer.prototype instanceof Uint8Array&&"set"===minimal.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter$1.writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=minimal.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter$1._configure();var reader=Reader,BufferReader,LongBits$1=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},create$1=function(){return minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits$1(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$1(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create$1(),Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e,Reader.create=create$1(),BufferReader._configure();var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,BufferReader$1._configure=function(){minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice)},BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader$1._configure();var service=Service;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,i,r,o){if(!r)throw TypeError("request must be specified");var a=this;if(!o)return minimal.asPromise(e,a,t,n,i,r);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](r).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=_commonjsHelpers.createCommonjsModule((function(e,t){t.Service=service})),roots={},indexMinimal=_commonjsHelpers.createCommonjsModule((function(e,t){var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=writer,n.BufferWriter=writer_buffer,n.Reader=reader,n.BufferReader=reader_buffer,n.util=minimal,n.rpc=rpc_1,n.roots=roots,n.configure=i,i()})),minimal$1=indexMinimal;return minimal$1}));
//# sourceMappingURL=pkg-timing.min.js-vfle7BhN4.map