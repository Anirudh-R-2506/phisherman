define(["require","exports","tslib","modules/clean/ajax_as_promised","modules/clean/api_v2/default_user_client","modules/clean/auth/login/types","modules/clean/viewer","modules/core/exception","modules/core/i18n"],(function(e,r,t,n,a,o,i,s,c){"use strict";function u(){var e=i.Viewer.get_viewer().get_users()[0];return s.assert(null!=e,"Expect user is logged in when pairing"),new a.DefaultUserApiV2Client(e)}function l(e){var r;return(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r[".tag"])?{status:o.LoginResponseStatus.ERROR,html_response:!1,message:e.message}:{status:o.LoginResponseStatus.ERROR,html_response:!1,message:c.intl.formatMessage({id:"vuVMnM",defaultMessage:"Something went wrong."})}}function _(e){return t.__awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return t.__generator(this,(function(t){switch(t.label){case 0:r=e.login_email,n=e.encrypted_password,s.assert(null!=r&&null!=n,"Expect login email and password not null"),a=u(),o={login_email:r,encrypted_password:n,remember_me:e.remember_me},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.ns("team").rpc("account_pair_login",o,{})];case 2:return(i=t.sent()).two_factor_request?[2,i.two_factor_request]:[2,i];case 3:return[2,l(t.sent())];case 4:return[2]}}))}))}function m(e){return t.__awaiter(this,void 0,Promise,(function(){var r,n,a,o;return t.__generator(this,(function(t){switch(t.label){case 0:r=e.checkpoint_token,n=e.code,s.assert(null!=r&&null!=n,"Expect checkpoint token and code not null"),a=u(),o={checkpoint_token:r,code:n,remember_me:e.remember_me},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.ns("team").rpc("account_pair_two_factor_login",o,{})];case 2:return[2,t.sent()];case 3:return[2,l(t.sent())];case 4:return[2]}}))}))}Object.defineProperty(r,"__esModule",{value:!0}),r.logProfileServicesFailure=r.logProfileServicesSuccess=r.submitTwoFactorForm=r.retryU2fAuthentication=r.resendTwoFactorCode=r.submitCredentialsForm=r.accountPairTwoFactorLogin=r.accountPairLogin=r.checkSsoState=void 0,n=t.__importStar(n),r.checkSsoState=function(e){return new Promise((function(r){return n.WebRequest({url:"/sso_state",data:{email:e},success:function(e){return r(JSON.parse(e))}})}))},r.accountPairLogin=_,r.accountPairTwoFactorLogin=m,r.submitCredentialsForm=function(e,r){var t;switch(e){case"multi":t="/ajax_multi_login";break;case"pairing":t="/team/join/new_pair_login_ajax";break;case"cli_link":t="/cli_link";break;case"cli_link_nonce":t="/cli_link_nonce";break;case"bidirectional_pair":return _(r);default:t="/ajax_login"}return new Promise((function(e,a){return n.WebRequest({url:t,type:"POST",data:r,success:function(r){e(JSON.parse(r))},error:function(r,t,n){"{"!==n[0]&&-1===n.indexOf(":")?e({status:o.LoginResponseStatus.ERROR,html_response:!1,message:n}):a(JSON.parse(n))}})}))},r.resendTwoFactorCode=function(e,r){return new Promise((function(t,a){return n.WebRequest({url:"/twofactor_resend",data:{backup:e,mobile_push:r},success:t,error:a})}))},r.retryU2fAuthentication=function(){return new Promise((function(e,r){return n.WebRequest({url:"/account/twofactor/u2f_start_authentication",success:e,error:r})}))},r.submitTwoFactorForm=function(e,r){var t;switch(e){case"multi":t="/ajax_multi_verify_code";break;case"pairing":t="/team/join/new_pair_login_ajax";break;case"cli_link":case"cli_link_nonce":t="/cli_link_twofactor";break;case"admin":t="/admin/login/twofactor";break;case"bidirectional_pair":return m(r);default:t="/ajax_verify_code"}return new Promise((function(e,a){return n.WebRequest({url:t,type:"POST",data:r,success:function(r){return e(JSON.parse(r))},error:function(e,r,t){return a(JSON.parse(t))}})}))},r.logProfileServicesSuccess=function(){return n.SilentBackgroundRequest({url:"/profile_services/log",data:{event_name:"login_callback_success"}})},r.logProfileServicesFailure=function(){return n.SilentBackgroundRequest({url:"/profile_services/log",data:{event_name:"login_callback_error"}})}}));
//# sourceMappingURL=api.min.js-vflgp8UV7.map